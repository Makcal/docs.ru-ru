---
title: Пустые переменные — руководство по языку C#
description: В этой статье приведены сведения о поддержке в C# пустых переменных (переменных, которым не присваиваются значения) и описаны способы их использования.
ms.technology: csharp-fundamentals
ms.date: 09/22/2020
ms.openlocfilehash: 7562da880ff3136dfc04ce4061bafa8ed55f5a23
ms.sourcegitcommit: 38999dc0ec4f7c4404de5ce0951b64c55997d9ab
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/02/2021
ms.locfileid: "99426922"
---
# <a name="discards---c-guide"></a><span data-ttu-id="9e684-103">Пустые переменные — руководство по языку C#</span><span class="sxs-lookup"><span data-stu-id="9e684-103">Discards - C# Guide</span></span>

<span data-ttu-id="9e684-104">Начиная с версии 7.0 язык C# поддерживает пустые переменные. Это переменные-заполнители, которые намеренно не используются в коде приложения.</span><span class="sxs-lookup"><span data-stu-id="9e684-104">Starting with C# 7.0, C# supports discards, which are placeholder variables that are intentionally unused in application code.</span></span> <span data-ttu-id="9e684-105">Пустые переменные эквивалентны переменным, которым не присвоены значения; пустые переменные не имеют значений.</span><span class="sxs-lookup"><span data-stu-id="9e684-105">Discards are equivalent to unassigned variables; they don't have a value.</span></span> <span data-ttu-id="9e684-106">Пустые переменные объявляют свое намерение компилятору и другим разработчикам, которые читают ваш код. Вы намерены игнорировать результат выражения.</span><span class="sxs-lookup"><span data-stu-id="9e684-106">A discard communicates intent to the compiler and others that read your code: You intended to ignore the result of an expression.</span></span> <span data-ttu-id="9e684-107">Может потребоваться игнорировать результат выражения, один или несколько элементов кортежного выражения, параметр `out` метода или целевой объект выражения сопоставления шаблонов.</span><span class="sxs-lookup"><span data-stu-id="9e684-107">You may want to ignore the result of an expression, one or more members of a tuple expression, an `out` parameter to a method, or the target of a pattern matching expression.</span></span>

<span data-ttu-id="9e684-108">Так как пустая переменная по сути всего одна, этой переменной может даже не выделяться память.</span><span class="sxs-lookup"><span data-stu-id="9e684-108">Because there's only a single discard variable, that variable may not even be allocated storage.</span></span> <span data-ttu-id="9e684-109">Пустые переменные помогают расходовать память более экономно.</span><span class="sxs-lookup"><span data-stu-id="9e684-109">Discards can reduce memory allocations.</span></span> <span data-ttu-id="9e684-110">Пустые переменные делают намерение кода более явным.</span><span class="sxs-lookup"><span data-stu-id="9e684-110">Discards make the intent of your code clear.</span></span> <span data-ttu-id="9e684-111">Они улучшают его удобочитаемость и обслуживаемость.</span><span class="sxs-lookup"><span data-stu-id="9e684-111">They enhance its readability and maintainability.</span></span>

<span data-ttu-id="9e684-112">Чтобы использовать пустую переменную, назначьте ей в качестве имени символ подчеркивания (`_`).</span><span class="sxs-lookup"><span data-stu-id="9e684-112">You indicate that a variable is a discard by assigning it the underscore (`_`) as its name.</span></span> <span data-ttu-id="9e684-113">Например, следующий вызов метода возвращает кортеж, где первое и второе значения представляют собой пустые переменные.</span><span class="sxs-lookup"><span data-stu-id="9e684-113">For example, the following method call returns a tuple in which the first and second values are discards.</span></span> <span data-ttu-id="9e684-114">`area` — это ранее объявленная переменная, установленная для третьего компонента, возвращаемого `GetCityInformation`:</span><span class="sxs-lookup"><span data-stu-id="9e684-114">`area` is a previously declared variable set to the third component returned by `GetCityInformation`:</span></span>

```csharp
(_, _, area) = city.GetCityInformation(cityName);
```

<span data-ttu-id="9e684-115">Начиная с C# 9.0, можно использовать пустые переменные для указания неиспользуемых входных параметров лямбда-выражения.</span><span class="sxs-lookup"><span data-stu-id="9e684-115">Beginning with C# 9.0, you can use discards to specify unused input parameters of a lambda expression.</span></span> <span data-ttu-id="9e684-116">Дополнительные сведения см. в разделе [Входные параметры лямбда-выражения](language-reference/operators/lambda-expressions.md#input-parameters-of-a-lambda-expression) статьи о [лямбда-выражениях](language-reference/operators/lambda-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="9e684-116">For more information, see the [Input parameters of a lambda expression](language-reference/operators/lambda-expressions.md#input-parameters-of-a-lambda-expression) section of the [Lambda expressions](language-reference/operators/lambda-expressions.md) article.</span></span>

<span data-ttu-id="9e684-117">Если `_` является допустимой пустой переменной, при попытке получить ее значение или использовать ее в операции присваивания компилятор выдаст ошибку CS0301: "The name '\_' doesn't exist in the current context" (Имя "_" не существует в текущем контексте).</span><span class="sxs-lookup"><span data-stu-id="9e684-117">When `_` is a valid discard, attempting to retrieve its value or use it in an assignment operation generates compiler error CS0301, "The name '\_' doesn't exist in the current context".</span></span> <span data-ttu-id="9e684-118">Это вызвано тем, что переменной `_` не присвоено значение и, возможно, даже не выделена память.</span><span class="sxs-lookup"><span data-stu-id="9e684-118">This error is because `_` isn't assigned a value, and may not even be assigned a storage location.</span></span> <span data-ttu-id="9e684-119">Если бы это была настоящая переменная, вам бы не удалось отменить более одного значения, как в предыдущем примере.</span><span class="sxs-lookup"><span data-stu-id="9e684-119">If it were an actual variable, you couldn't discard more than one value, as the previous example did.</span></span>

## <a name="tuple-and-object-deconstruction"></a><span data-ttu-id="9e684-120">Деконструкция кортежей и объектов</span><span class="sxs-lookup"><span data-stu-id="9e684-120">Tuple and object deconstruction</span></span>

<span data-ttu-id="9e684-121">Пустые переменные удобны при работе с кортежами, когда в коде вашего приложения используются одни элементы кортежа и игнорируются другие.</span><span class="sxs-lookup"><span data-stu-id="9e684-121">Discards are useful in working with tuples when your application code uses some tuple elements but ignores others.</span></span> <span data-ttu-id="9e684-122">Например, следующий метод `QueryCityDataForYears` возвращает кортеж со следующими данными: название города, его площадь, год, численность населения города в этом году, другой год и численность населения города в том году.</span><span class="sxs-lookup"><span data-stu-id="9e684-122">For example, the following `QueryCityDataForYears` method returns a tuple with the name of a city, its area, a year, the city's population for that year, a second year, and the city's population for that second year.</span></span> <span data-ttu-id="9e684-123">В примере показано изменение численности населения за эти два года.</span><span class="sxs-lookup"><span data-stu-id="9e684-123">The example shows the change in population between those two years.</span></span> <span data-ttu-id="9e684-124">Из доступных в кортеже данных нас не интересует площадь города, а название города и две даты известны нам уже на этапе разработки.</span><span class="sxs-lookup"><span data-stu-id="9e684-124">Of the data available from the tuple, we're unconcerned with the city area, and we know the city name and the two dates at design-time.</span></span> <span data-ttu-id="9e684-125">Следовательно, нас интересуют только два значения численности населения, которые хранятся в кортеже. Остальные значения можно обработать как пустые переменные.</span><span class="sxs-lookup"><span data-stu-id="9e684-125">As a result, we're only interested in the two population values stored in the tuple, and can handle its remaining values as discards.</span></span>  

:::code language="csharp" source="snippets/discards/discard-tuple.cs" ID="DiscardTupleMember" :::

<span data-ttu-id="9e684-126">Подробнее о деконструкции кортежей с помощью пустых переменных: [Деконструкция кортежей и других типов](deconstruct.md#deconstructing-tuple-elements-with-discards).</span><span class="sxs-lookup"><span data-stu-id="9e684-126">For more information on deconstructing tuples with discards, see [Deconstructing tuples and other types](deconstruct.md#deconstructing-tuple-elements-with-discards).</span></span>

<span data-ttu-id="9e684-127">Метод `Deconstruct` класса, структуры или интерфейса также позволяет извлекать и деконструировать определенный набор данных из объекта.</span><span class="sxs-lookup"><span data-stu-id="9e684-127">The `Deconstruct` method of a class, structure, or interface also allows you to retrieve and deconstruct a specific set of data from an object.</span></span> <span data-ttu-id="9e684-128">Пустые переменные можно использовать, когда вы хотите работать только с набором деконструируемых значений.</span><span class="sxs-lookup"><span data-stu-id="9e684-128">You can use discards when you're interested in working with only a subset of the deconstructed values.</span></span> <span data-ttu-id="9e684-129">В следующем примере показана деконструкция объекта `Person` на четыре строки (имя, фамилия, город и область), но для фамилии и области используются пустые переменные.</span><span class="sxs-lookup"><span data-stu-id="9e684-129">The following example deconstructs a `Person` object into four strings (the first and last names, the city, and the state), but discards the last name and the state.</span></span>

:::code language="csharp" source="snippets/discards/discard-class.cs" :::

<span data-ttu-id="9e684-130">Подробнее о деконструкции пользовательских типов с помощью пустых переменных: [Деконструкция кортежей и других типов](deconstruct.md#deconstructing-a-user-defined-type-with-discards).</span><span class="sxs-lookup"><span data-stu-id="9e684-130">For more information on deconstructing user-defined types with discards, see [Deconstructing tuples and other types](deconstruct.md#deconstructing-a-user-defined-type-with-discards).</span></span>

## <a name="pattern-matching-with-switch"></a><span data-ttu-id="9e684-131">Сопоставление шаблонов с помощью switch</span><span class="sxs-lookup"><span data-stu-id="9e684-131">Pattern matching with \`switch</span></span>

<span data-ttu-id="9e684-132">*Шаблон пустой переменной* можно использовать при сопоставлении шаблонов с ключевым словом [switch](language-reference/keywords/switch.md).</span><span class="sxs-lookup"><span data-stu-id="9e684-132">The *discard pattern* can be used in pattern matching with the [switch](language-reference/keywords/switch.md) keyword.</span></span> <span data-ttu-id="9e684-133">Каждое выражение всегда соответствует шаблону пустой переменной.</span><span class="sxs-lookup"><span data-stu-id="9e684-133">Every expression always matches the discard pattern.</span></span> <span data-ttu-id="9e684-134">(Его можно использовать с выражениями [is](language-reference/keywords/is.md).</span><span class="sxs-lookup"><span data-stu-id="9e684-134">(It can be used with [is](language-reference/keywords/is.md) expressions.</span></span> <span data-ttu-id="9e684-135">Но это случается редко, так как пустую переменную можно удалить без изменения ее значения.)</span><span class="sxs-lookup"><span data-stu-id="9e684-135">However, that use is rare because the discard can be removed without changing its meaning).</span></span>

<span data-ttu-id="9e684-136">В следующем примере определяется метод `ProvidesFormatInfo`, который использует операторы [is](language-reference/keywords/is.md), чтобы узнать, предоставляет ли объект реализацию <xref:System.IFormatProvider> и не является ли он `null`.</span><span class="sxs-lookup"><span data-stu-id="9e684-136">The following example defines a `ProvidesFormatInfo` method that uses [is](language-reference/keywords/is.md) statements to determine whether an object provides an <xref:System.IFormatProvider> implementation and tests whether the object is `null`.</span></span> <span data-ttu-id="9e684-137">В примере также используется шаблон пустой переменной для обработки объектов любого другого типа с определенным значением.</span><span class="sxs-lookup"><span data-stu-id="9e684-137">It also uses the discard pattern to handle non-null objects of any other type.</span></span>

:::code language="csharp" source="snippets/discards/discard-pattern2.cs" ID="DiscardSwitchExample" :::

## <a name="calls-to-methods-with-out-parameters"></a><span data-ttu-id="9e684-138">Вызовы методов с параметрами `out`</span><span class="sxs-lookup"><span data-stu-id="9e684-138">Calls to methods with `out` parameters</span></span>

<span data-ttu-id="9e684-139">При вызове метода `Deconstruct` для деконструкции пользовательского типа (экземпляра класса, структуры или интерфейса) вы можете сделать пустыми значения отдельных аргументов `out`.</span><span class="sxs-lookup"><span data-stu-id="9e684-139">When calling the `Deconstruct` method to deconstruct a user-defined type (an instance of a class, structure, or interface), you can discard the values of individual `out` arguments.</span></span> <span data-ttu-id="9e684-140">Но при вызове метода с параметром `out` вы также можете сделать пустыми значения аргументов `out`.</span><span class="sxs-lookup"><span data-stu-id="9e684-140">But you can also discard the value of `out` arguments when calling any method with an `out` parameter.</span></span>

<span data-ttu-id="9e684-141">В следующем примере вызывается метод [DateTime.TryParse(String, out DateTime)](<xref:System.DateTime.TryParse(System.String,System.DateTime@)>), который определяет, является ли строковое представление даты допустимым для текущего языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="9e684-141">The following example calls the [DateTime.TryParse(String, out DateTime)](<xref:System.DateTime.TryParse(System.String,System.DateTime@)>) method to determine whether the string representation of a date is valid in the current culture.</span></span> <span data-ttu-id="9e684-142">Так как этот пример связан только с проверкой строки даты и не включает анализ этой строки для получения самой даты, аргумент `out` метода является пустым.</span><span class="sxs-lookup"><span data-stu-id="9e684-142">Because the example is concerned only with validating the date string and not with parsing it to extract the date, the `out` argument to the method is a discard.</span></span>

:::code language="csharp" source="snippets/discards/discard-out1.cs" ID="DiscardOutParameter" :::

## <a name="a-standalone-discard"></a><span data-ttu-id="9e684-143">Отдельная пустая переменная</span><span class="sxs-lookup"><span data-stu-id="9e684-143">A standalone discard</span></span>

<span data-ttu-id="9e684-144">Вы можете использовать отдельную пустую переменную, чтобы указать, что переменную необходимо игнорировать.</span><span class="sxs-lookup"><span data-stu-id="9e684-144">You can use a standalone discard to indicate any variable that you choose to ignore.</span></span> <span data-ttu-id="9e684-145">Одним из типичных вариантов использования является присваивание, гарантирующее, что аргумент не имеет значение NULL.</span><span class="sxs-lookup"><span data-stu-id="9e684-145">One typical use is to use an assignment to ensure that an argument isn't null.</span></span> <span data-ttu-id="9e684-146">В следующем коде для принудительного назначения используется пустая переменная.</span><span class="sxs-lookup"><span data-stu-id="9e684-146">The following code uses a discard to force an assignment.</span></span> <span data-ttu-id="9e684-147">В правой части назначения используется [оператор объединения со значением NULL](language-reference/operators/null-coalescing-operator.md) для вызова <xref:System.ArgumentNullException?displayProperty=nameWithType>, когда аргумент имеет значение `null`.</span><span class="sxs-lookup"><span data-stu-id="9e684-147">The right side of the assignment uses the [null coalescing operator](language-reference/operators/null-coalescing-operator.md) to throw an <xref:System.ArgumentNullException?displayProperty=nameWithType> when the argument is `null`.</span></span> <span data-ttu-id="9e684-148">Коду не требуется результат присваивания, поэтому используется пустая переменная.</span><span class="sxs-lookup"><span data-stu-id="9e684-148">The code doesn't need the result of the assignment, so it's discarded.</span></span> <span data-ttu-id="9e684-149">Выражение вызывает проверку значения NULL.</span><span class="sxs-lookup"><span data-stu-id="9e684-149">The expression forces a null check.</span></span> <span data-ttu-id="9e684-150">Пустая переменная уточняет намерение: результат назначения не требуется или используется.</span><span class="sxs-lookup"><span data-stu-id="9e684-150">The discard clarifies your intent: the result of the assignment isn't needed or used.</span></span>

:::code language="csharp" source="snippets/discards/standalone-discard1.cs" ID="ArgNullCheck" :::

<span data-ttu-id="9e684-151">В следующем примере отдельная пустая переменная используется, чтобы игнорировать объект <xref:System.Threading.Tasks.Task>, возвращаемый асинхронной операцией.</span><span class="sxs-lookup"><span data-stu-id="9e684-151">The following example uses a standalone discard to ignore the <xref:System.Threading.Tasks.Task> object returned by an asynchronous operation.</span></span> <span data-ttu-id="9e684-152">Назначение задачи приводит к подавлению исключения, созданного операцией перед завершением.</span><span class="sxs-lookup"><span data-stu-id="9e684-152">Assigning the task has the effect of suppressing the exception that the operation throws as it is about to complete.</span></span> <span data-ttu-id="9e684-153">Это делает ваше намерение явным: Вам нужно назначить `Task` пустой переменной и пропустить все ошибки, созданные в этой асинхронной операции.</span><span class="sxs-lookup"><span data-stu-id="9e684-153">It makes your intent clear: You want to discard the `Task`, and ignore any errors generated from that asynchronous operation.</span></span>

:::code language="csharp" source="snippets/discards/standalone-discard1.cs" ID="SnippetDiscardTask" :::

<span data-ttu-id="9e684-154">Если задача не назначена пустой переменной, следующий код создает предупреждение компилятора:</span><span class="sxs-lookup"><span data-stu-id="9e684-154">Without assigning the task to a discard, the following code generates a compiler warning:</span></span>

:::code language="csharp" source="snippets/discards/standalone-discard1.cs" ID="SnippetNoDiscardTask" :::

> [!NOTE]
> <span data-ttu-id="9e684-155">При запуске любого из предыдущих двух примеров с помощью отладчика программа будет остановлена при возникновении исключения.</span><span class="sxs-lookup"><span data-stu-id="9e684-155">If you run either of the preceding two samples using a debugger, the debugger will stop the program when the exception is thrown.</span></span> <span data-ttu-id="9e684-156">Если отладчик не присоединен, в обоих случаях исключение пропускается без предупреждения.</span><span class="sxs-lookup"><span data-stu-id="9e684-156">Without a debugger attached, the exception is silently ignored in both cases.</span></span>

<span data-ttu-id="9e684-157">`_` также является допустимым идентификатором.</span><span class="sxs-lookup"><span data-stu-id="9e684-157">`_` is also a valid identifier.</span></span> <span data-ttu-id="9e684-158">При использовании вне поддерживаемого контекста `_` считается не пустой, а действительной переменной.</span><span class="sxs-lookup"><span data-stu-id="9e684-158">When used outside of a supported context, `_` is treated not as a discard but as a valid variable.</span></span> <span data-ttu-id="9e684-159">Если в области уже есть идентификатор с именем `_`, использование `_` в качестве отдельной пустой переменной может привести к следующим результатам:</span><span class="sxs-lookup"><span data-stu-id="9e684-159">If an identifier named `_` is already in scope, the use of `_` as a standalone discard can result in:</span></span>

- <span data-ttu-id="9e684-160">Случайное изменение значения переменной `_` в области из-за присвоения ей значения пустой переменной.</span><span class="sxs-lookup"><span data-stu-id="9e684-160">Accidental modification of the value of the in-scope `_` variable by assigning it the value of the intended discard.</span></span> <span data-ttu-id="9e684-161">Пример:</span><span class="sxs-lookup"><span data-stu-id="9e684-161">For example:</span></span>
   :::code language="csharp" source="snippets/discards/standalone-discard2.cs" ID="VariableIdentifier" :::
- <span data-ttu-id="9e684-162">Ошибка компилятора из-за нарушения безопасности типов.</span><span class="sxs-lookup"><span data-stu-id="9e684-162">A compiler error for violating type safety.</span></span> <span data-ttu-id="9e684-163">Пример:</span><span class="sxs-lookup"><span data-stu-id="9e684-163">For example:</span></span>
   :::code language="csharp" source="snippets/discards/standalone-discard2.cs" ID="VariableTypeInference" :::
- <span data-ttu-id="9e684-164">Ошибка компилятора CS0136 "Невозможно объявить локальную переменную или параметр с именем \_ в этой области, так как это имя используется для определения локальной переменной или параметра во включающей локальной области".</span><span class="sxs-lookup"><span data-stu-id="9e684-164">Compiler error CS0136, "A local or parameter named '\_' cannot be declared in this scope because that name is used in an enclosing local scope to define a local or parameter."</span></span> <span data-ttu-id="9e684-165">Пример:</span><span class="sxs-lookup"><span data-stu-id="9e684-165">For example:</span></span>
   :::code language="csharp" source="snippets/discards/standalone-discard2.cs" ID="CannotRedeclare" :::

## <a name="see-also"></a><span data-ttu-id="9e684-166">См. также раздел</span><span class="sxs-lookup"><span data-stu-id="9e684-166">See also</span></span>

- [<span data-ttu-id="9e684-167">Деконструкция кортежей и других типов</span><span class="sxs-lookup"><span data-stu-id="9e684-167">Deconstructing tuples and other types</span></span>](deconstruct.md)
- [<span data-ttu-id="9e684-168">Ключевое слово `is`</span><span class="sxs-lookup"><span data-stu-id="9e684-168">`is` keyword</span></span>](language-reference/keywords/is.md)
- [<span data-ttu-id="9e684-169">Ключевое слово `switch`</span><span class="sxs-lookup"><span data-stu-id="9e684-169">`switch` keyword</span></span>](language-reference/keywords/switch.md)
