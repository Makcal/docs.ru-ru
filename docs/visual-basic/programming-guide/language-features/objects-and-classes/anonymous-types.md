---
description: 'Дополнительные сведения: анонимные типы (Visual Basic)'
title: Анонимные типы
ms.date: 07/20/2015
f1_keywords:
- vb.AnonymousType
helpviewer_keywords:
- anonymous types [Visual Basic], about anonymous types
- anonymous types [Visual Basic]
- types [Visual Basic], anonymous
ms.assetid: 7b87532c-4b3e-4398-8503-6ea9d67574a4
ms.openlocfilehash: 447ca914726d4b426ad4ba2ec370a4bbe9589b81
ms.sourcegitcommit: 10e719780594efc781b15295e499c66f316068b8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/14/2021
ms.locfileid: "100425624"
---
# <a name="anonymous-types-visual-basic"></a><span data-ttu-id="bd941-103">Анонимные типы (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="bd941-103">Anonymous Types (Visual Basic)</span></span>

<span data-ttu-id="bd941-104">Visual Basic поддерживает анонимные типы, которые позволяют создавать объекты без написания определения класса для типа данных.</span><span class="sxs-lookup"><span data-stu-id="bd941-104">Visual Basic supports anonymous types, which enable you to create objects without writing a class definition for the data type.</span></span> <span data-ttu-id="bd941-105">Вместо этого компилятор создает класс для вас.</span><span class="sxs-lookup"><span data-stu-id="bd941-105">Instead, the compiler generates a class for you.</span></span> <span data-ttu-id="bd941-106">Класс не имеет пригодного для использования имени, наследуется непосредственно от <xref:System.Object> и содержит свойства, указанные при объявлении объекта.</span><span class="sxs-lookup"><span data-stu-id="bd941-106">The class has no usable name, inherits directly from <xref:System.Object>, and contains the properties you specify in declaring the object.</span></span> <span data-ttu-id="bd941-107">Так как имя типа данных не указано, оно называется *анонимным типом*.</span><span class="sxs-lookup"><span data-stu-id="bd941-107">Because the name of the data type is not specified, it is referred to as an *anonymous type*.</span></span>  
  
 <span data-ttu-id="bd941-108">В следующем примере объявляется и создается переменная `product` в качестве экземпляра анонимного типа, который имеет два свойства: `Name` и `Price` .</span><span class="sxs-lookup"><span data-stu-id="bd941-108">The following example declares and creates variable `product` as an instance of an anonymous type that has two properties, `Name` and `Price`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#1)]  
  
 <span data-ttu-id="bd941-109">*Выражение запроса* использует анонимные типы для объединения столбцов данных, выбранных запросом.</span><span class="sxs-lookup"><span data-stu-id="bd941-109">A *query expression* uses anonymous types to combine columns of data selected by a query.</span></span> <span data-ttu-id="bd941-110">Невозможно определить тип результата заранее, так как нельзя предсказать столбцы, которые может выбрать конкретный запрос.</span><span class="sxs-lookup"><span data-stu-id="bd941-110">You cannot define the type of the result in advance, because you cannot predict the columns a particular query might select.</span></span> <span data-ttu-id="bd941-111">Анонимные типы позволяют написать запрос, выбирающий любое количество столбцов в любом порядке.</span><span class="sxs-lookup"><span data-stu-id="bd941-111">Anonymous types enable you to write a query that selects any number of columns, in any order.</span></span> <span data-ttu-id="bd941-112">Компилятор создает тип данных, соответствующий указанным свойствам, и заданный порядок.</span><span class="sxs-lookup"><span data-stu-id="bd941-112">The compiler creates a data type that matches the specified properties and the specified order.</span></span>  
  
 <span data-ttu-id="bd941-113">В следующих примерах `products` — это список объектов Product, каждый из которых имеет много свойств.</span><span class="sxs-lookup"><span data-stu-id="bd941-113">In the following examples, `products` is a list of product objects, each of which has many properties.</span></span> <span data-ttu-id="bd941-114">Переменная `namePriceQuery` содержит определение запроса, при выполнении которого возвращается коллекция экземпляров анонимного типа, имеющих два свойства: `Name` и `Price` .</span><span class="sxs-lookup"><span data-stu-id="bd941-114">Variable `namePriceQuery` holds the definition of a query that, when it is executed, returns a collection of instances of an anonymous type that has two properties, `Name` and `Price`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#2)]  
  
 <span data-ttu-id="bd941-115">Переменная `nameQuantityQuery` содержит определение запроса, при выполнении которого возвращается коллекция экземпляров анонимного типа, имеющих два свойства: `Name` и `OnHand` .</span><span class="sxs-lookup"><span data-stu-id="bd941-115">Variable `nameQuantityQuery` holds the definition of a query that, when it is executed, returns a collection of instances of an anonymous type that has two properties, `Name` and `OnHand`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#3)]  
  
 <span data-ttu-id="bd941-116">Дополнительные сведения о коде, созданном компилятором для анонимного типа, см. в разделе [Определение анонимного типа](anonymous-type-definition.md).</span><span class="sxs-lookup"><span data-stu-id="bd941-116">For more information about the code created by the compiler for an anonymous type, see [Anonymous Type Definition](anonymous-type-definition.md).</span></span>  
  
> [!CAUTION]
> <span data-ttu-id="bd941-117">Имя анонимного типа создается компилятором и может отличаться от компиляции к компиляции.</span><span class="sxs-lookup"><span data-stu-id="bd941-117">The name of the anonymous type is compiler generated and may vary from compilation to compilation.</span></span> <span data-ttu-id="bd941-118">Код не должен использовать имя анонимного типа или полагаться на него, так как имя может измениться при повторной компиляции проекта.</span><span class="sxs-lookup"><span data-stu-id="bd941-118">Your code should not use or rely on the name of an anonymous type because the name might change when a project is recompiled.</span></span>  
  
## <a name="declaring-an-anonymous-type"></a><span data-ttu-id="bd941-119">Объявление анонимного типа</span><span class="sxs-lookup"><span data-stu-id="bd941-119">Declaring an Anonymous Type</span></span>  

 <span data-ttu-id="bd941-120">Объявление экземпляра анонимного типа использует список инициализаторов для указания свойств типа.</span><span class="sxs-lookup"><span data-stu-id="bd941-120">The declaration of an instance of an anonymous type uses an initializer list to specify the properties of the type.</span></span> <span data-ttu-id="bd941-121">При объявлении анонимного типа можно указать только свойства, а не другие элементы класса, такие как методы или события.</span><span class="sxs-lookup"><span data-stu-id="bd941-121">You can specify only properties when you declare an anonymous type, not other class elements such as methods or events.</span></span> <span data-ttu-id="bd941-122">В следующем примере `product1` является экземпляром анонимного типа, который имеет два свойства: `Name` и `Price` .</span><span class="sxs-lookup"><span data-stu-id="bd941-122">In the following example, `product1` is an instance of an anonymous type that has two properties: `Name` and `Price`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#4)]  
  
 <span data-ttu-id="bd941-123">Если вы назначаете свойства ключевыми свойствами, их можно использовать для сравнения двух экземпляров анонимного типа на равенство.</span><span class="sxs-lookup"><span data-stu-id="bd941-123">If you designate properties as key properties, you can use them to compare two anonymous type instances for equality.</span></span> <span data-ttu-id="bd941-124">Однако значения ключевых свойств нельзя изменить.</span><span class="sxs-lookup"><span data-stu-id="bd941-124">However, the values of key properties cannot be changed.</span></span> <span data-ttu-id="bd941-125">Дополнительные сведения см. в разделе Ключевые свойства далее в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="bd941-125">See the Key Properties section later in this topic for more information.</span></span>  
  
 <span data-ttu-id="bd941-126">Обратите внимание, что объявление экземпляра анонимного типа аналогично объявлению экземпляра именованного типа с помощью инициализатора объекта:</span><span class="sxs-lookup"><span data-stu-id="bd941-126">Notice that declaring an instance of an anonymous type is like declaring an instance of a named type by using an object initializer:</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#5)]  
  
 <span data-ttu-id="bd941-127">Дополнительные сведения о других способах указания свойств анонимного типа см. [в разделе как вывести имена и типы свойств в объявлениях анонимного типа](how-to-infer-property-names-and-types-in-anonymous-type-declarations.md).</span><span class="sxs-lookup"><span data-stu-id="bd941-127">For more information about other ways to specify anonymous type properties, see [How to: Infer Property Names and Types in Anonymous Type Declarations](how-to-infer-property-names-and-types-in-anonymous-type-declarations.md).</span></span>  
  
## <a name="key-properties"></a><span data-ttu-id="bd941-128">Ключевые свойства</span><span class="sxs-lookup"><span data-stu-id="bd941-128">Key Properties</span></span>  

 <span data-ttu-id="bd941-129">Ключевые свойства отличаются от неключевых свойств несколькими фундаментальными способами:</span><span class="sxs-lookup"><span data-stu-id="bd941-129">Key properties differ from non-key properties in several fundamental ways:</span></span>  
  
- <span data-ttu-id="bd941-130">Для определения того, равны ли два экземпляра, сравниваются только значения ключевых свойств.</span><span class="sxs-lookup"><span data-stu-id="bd941-130">Only the values of key properties are compared in order to determine whether two instances are equal.</span></span>  
  
- <span data-ttu-id="bd941-131">Значения ключевых свойств доступны только для чтения и не могут быть изменены.</span><span class="sxs-lookup"><span data-stu-id="bd941-131">The values of key properties are read-only and cannot be changed.</span></span>  
  
- <span data-ttu-id="bd941-132">В созданный компилятором алгоритм хэш-кода для анонимного типа включаются только значения ключевых свойств.</span><span class="sxs-lookup"><span data-stu-id="bd941-132">Only key property values are included in the compiler-generated hash code algorithm for an anonymous type.</span></span>  
  
### <a name="equality"></a><span data-ttu-id="bd941-133">Равенство</span><span class="sxs-lookup"><span data-stu-id="bd941-133">Equality</span></span>  

 <span data-ttu-id="bd941-134">Экземпляры анонимных типов могут быть равны, только если они являются экземплярами одного и того же анонимного типа.</span><span class="sxs-lookup"><span data-stu-id="bd941-134">Instances of anonymous types can be equal only if they are instances of the same anonymous type.</span></span> <span data-ttu-id="bd941-135">Компилятор обрабатывает два экземпляра как экземпляры одного типа, если они отвечают следующим условиям:</span><span class="sxs-lookup"><span data-stu-id="bd941-135">The compiler treats two instances as instances of the same type if they meet the following conditions:</span></span>  
  
- <span data-ttu-id="bd941-136">Они объявляются в одной сборке.</span><span class="sxs-lookup"><span data-stu-id="bd941-136">They are declared in the same assembly.</span></span>  
  
- <span data-ttu-id="bd941-137">Их свойства имеют одинаковые имена, одни и те же выводимые типы и объявляются в том же порядке.</span><span class="sxs-lookup"><span data-stu-id="bd941-137">Their properties have the same names, the same inferred types, and are declared in the same order.</span></span> <span data-ttu-id="bd941-138">При сравнении имен регистр не учитывается.</span><span class="sxs-lookup"><span data-stu-id="bd941-138">Name comparisons are not case-sensitive.</span></span>  
  
- <span data-ttu-id="bd941-139">Те же свойства в каждой из них помечаются как ключевые свойства.</span><span class="sxs-lookup"><span data-stu-id="bd941-139">The same properties in each are marked as key properties.</span></span>  
  
- <span data-ttu-id="bd941-140">По крайней мере одно свойство в каждом объявлении является ключевым свойством.</span><span class="sxs-lookup"><span data-stu-id="bd941-140">At least one property in each declaration is a key property.</span></span>  
  
 <span data-ttu-id="bd941-141">Экземпляр анонимных типов, у которых нет ключевых свойств, равен только самому себе.</span><span class="sxs-lookup"><span data-stu-id="bd941-141">An instance of an anonymous types that has no key properties is equal only to itself.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#6)]  
  
 <span data-ttu-id="bd941-142">Два экземпляра одного и того же анонимного типа равны, если значения их ключевых свойств равны.</span><span class="sxs-lookup"><span data-stu-id="bd941-142">Two instances of the same anonymous type are equal if the values of their key properties are equal.</span></span> <span data-ttu-id="bd941-143">В следующих примерах показано, как проверяется равенство.</span><span class="sxs-lookup"><span data-stu-id="bd941-143">The following examples illustrate how equality is tested.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#7)]  
  
### <a name="read-only-values"></a><span data-ttu-id="bd941-144">Значения Read-Only</span><span class="sxs-lookup"><span data-stu-id="bd941-144">Read-Only Values</span></span>  

 <span data-ttu-id="bd941-145">Значения ключевых свойств нельзя изменить.</span><span class="sxs-lookup"><span data-stu-id="bd941-145">The values of key properties cannot be changed.</span></span> <span data-ttu-id="bd941-146">Например, в `prod8` в предыдущем примере `Name` `Price` поля и имеют значение `read-only` , но `OnHand` могут быть изменены.</span><span class="sxs-lookup"><span data-stu-id="bd941-146">For example, in `prod8` in the previous example, the `Name` and `Price` fields are `read-only`, but `OnHand` can be changed.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#8)]  
  
## <a name="anonymous-types-from-query-expressions"></a><span data-ttu-id="bd941-147">Анонимные типы из выражений запросов</span><span class="sxs-lookup"><span data-stu-id="bd941-147">Anonymous Types from Query Expressions</span></span>  

 <span data-ttu-id="bd941-148">Выражениям запросов не всегда требуется создавать анонимные типы.</span><span class="sxs-lookup"><span data-stu-id="bd941-148">Query expressions do not always require the creation of anonymous types.</span></span> <span data-ttu-id="bd941-149">По возможности они используют существующий тип для хранения данных столбца.</span><span class="sxs-lookup"><span data-stu-id="bd941-149">When possible, they use an existing type to hold the column data.</span></span> <span data-ttu-id="bd941-150">Это происходит, когда запрос возвращает либо целые записи из источника данных, либо только одно поле из каждой записи.</span><span class="sxs-lookup"><span data-stu-id="bd941-150">This occurs when the query returns either whole records from the data source, or only one field from each record.</span></span> <span data-ttu-id="bd941-151">В следующих примерах кода `customers` — это коллекция объектов `Customer` класса.</span><span class="sxs-lookup"><span data-stu-id="bd941-151">In the following code examples, `customers` is a collection of objects of a `Customer` class.</span></span> <span data-ttu-id="bd941-152">Класс имеет много свойств, и вы можете включить один или несколько из них в результат запроса в любом порядке.</span><span class="sxs-lookup"><span data-stu-id="bd941-152">The class has many properties, and you can include one or more of them in the query result, in any order.</span></span> <span data-ttu-id="bd941-153">В первых двух примерах анонимные типы не требуются, поскольку запросы выбирают элементы именованных типов:</span><span class="sxs-lookup"><span data-stu-id="bd941-153">In the first two examples, no anonymous types are required because the queries select elements of named types:</span></span>  
  
- <span data-ttu-id="bd941-154">`custs1` содержит коллекцию строк, поскольку `cust.Name` является строкой.</span><span class="sxs-lookup"><span data-stu-id="bd941-154">`custs1` contains a collection of strings, because `cust.Name` is a string.</span></span>  
  
     [!code-vb[VbVbalrAnonymousTypes#30](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#30)]  
  
- <span data-ttu-id="bd941-155">`custs2` содержит коллекцию `Customer` объектов, поскольку каждый элемент объекта `customers` является `Customer` объектом, а весь элемент выбирается запросом.</span><span class="sxs-lookup"><span data-stu-id="bd941-155">`custs2` contains a collection of `Customer` objects, because each element of `customers` is a `Customer` object, and the whole element is selected by the query.</span></span>  
  
     [!code-vb[VbVbalrAnonymousTypes#31](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#31)]  
  
 <span data-ttu-id="bd941-156">Однако соответствующие именованные типы доступны не всегда.</span><span class="sxs-lookup"><span data-stu-id="bd941-156">However, appropriate named types are not always available.</span></span> <span data-ttu-id="bd941-157">Вам может потребоваться выбрать имена клиентов и адреса для одной цели, ИДЕНТИФИКАТОРы клиентов и местоположения для другого, а также имена клиентов, адреса и журналы заказов для третьего.</span><span class="sxs-lookup"><span data-stu-id="bd941-157">You might want to select customer names and addresses for one purpose, customer ID numbers and locations for another, and customer names, addresses, and order histories for a third.</span></span> <span data-ttu-id="bd941-158">Анонимные типы позволяют выбирать любое сочетание свойств в любом порядке без предварительного объявления нового именованного типа для хранения результата.</span><span class="sxs-lookup"><span data-stu-id="bd941-158">Anonymous types enable you to select any combination of properties, in any order, without first declaring a new named type to hold the result.</span></span> <span data-ttu-id="bd941-159">Вместо этого компилятор создает анонимный тип для каждой компиляции свойств.</span><span class="sxs-lookup"><span data-stu-id="bd941-159">Instead, the compiler creates an anonymous type for each compilation of properties.</span></span> <span data-ttu-id="bd941-160">Следующий запрос выбирает только имя клиента и ИДЕНТИФИКАЦИОНный номер из каждого `Customer` объекта в `customers` .</span><span class="sxs-lookup"><span data-stu-id="bd941-160">The following query selects only the customer's name and ID number from each `Customer` object in `customers`.</span></span> <span data-ttu-id="bd941-161">Поэтому компилятор создает анонимный тип, который содержит только эти два свойства.</span><span class="sxs-lookup"><span data-stu-id="bd941-161">Therefore, the compiler creates an anonymous type that contains only those two properties.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTYpes#32](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#32)]  
  
 <span data-ttu-id="bd941-162">Имена и типы данных свойств в анонимном типе берутся из аргументов в `Select` , `cust.Name` и `cust.ID` .</span><span class="sxs-lookup"><span data-stu-id="bd941-162">Both the names and the data types of the properties in the anonymous type are taken from the arguments to `Select`, `cust.Name` and `cust.ID`.</span></span> <span data-ttu-id="bd941-163">Свойства в анонимном типе, создаваемом запросом, всегда являются ключевыми свойствами.</span><span class="sxs-lookup"><span data-stu-id="bd941-163">The properties in an anonymous type that is created by a query are always key properties.</span></span> <span data-ttu-id="bd941-164">Когда `custs3` выполняется в следующем `For Each` цикле, результатом является коллекция экземпляров анонимного типа с двумя ключевыми свойствами `Name` и `ID` .</span><span class="sxs-lookup"><span data-stu-id="bd941-164">When `custs3` is executed in the following `For Each` loop, the result is a collection of instances of an anonymous type with two key properties, `Name` and `ID`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#33](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#33)]  
  
 <span data-ttu-id="bd941-165">Элементы в коллекции, представленные, `custs3` являются строго типизированными, и можно использовать IntelliSense для навигации по доступным свойствам и для проверки их типов.</span><span class="sxs-lookup"><span data-stu-id="bd941-165">The elements in the collection represented by `custs3` are strongly typed, and you can use IntelliSense to navigate through the available properties and to verify their types.</span></span>  
  
 <span data-ttu-id="bd941-166">Дополнительные сведения см. в статье [Знакомство с LINQ в Visual Basic](../linq/introduction-to-linq.md).</span><span class="sxs-lookup"><span data-stu-id="bd941-166">For more information, see [Introduction to LINQ in Visual Basic](../linq/introduction-to-linq.md).</span></span>  
  
## <a name="deciding-whether-to-use-anonymous-types"></a><span data-ttu-id="bd941-167">Принятие решения о необходимости использования анонимных типов</span><span class="sxs-lookup"><span data-stu-id="bd941-167">Deciding Whether to Use Anonymous Types</span></span>  

 <span data-ttu-id="bd941-168">Перед созданием объекта в качестве экземпляра анонимного класса следует подумать, является ли это лучшим вариантом.</span><span class="sxs-lookup"><span data-stu-id="bd941-168">Before you create an object as an instance of an anonymous class, consider whether that is the best option.</span></span> <span data-ttu-id="bd941-169">Например, если требуется создать временный объект, содержащий связанные данные, и нет необходимости в других полях и методах, которые могут содержаться в полном классе, анонимный тип является хорошим решением.</span><span class="sxs-lookup"><span data-stu-id="bd941-169">For example, if you want to create a temporary object to contain related data, and you have no need for other fields and methods that a complete class might contain, an anonymous type is a good solution.</span></span> <span data-ttu-id="bd941-170">Анонимные типы также удобно использовать, если требуется выбрать другие свойства для каждого объявления или изменить порядок свойств.</span><span class="sxs-lookup"><span data-stu-id="bd941-170">Anonymous types are also convenient if you want a different selection of properties for each declaration, or if you want to change the order of the properties.</span></span> <span data-ttu-id="bd941-171">Однако если проект содержит несколько объектов с одинаковыми свойствами, то их можно объявить в фиксированном порядке, используя именованный тип с конструктором класса.</span><span class="sxs-lookup"><span data-stu-id="bd941-171">However, if your project includes several objects that have the same properties, in a fixed order, you can declare them more easily by using a named type with a class constructor.</span></span> <span data-ttu-id="bd941-172">Например, с помощью соответствующего конструктора проще объявить несколько экземпляров `Product` класса, чем объявить несколько экземпляров анонимного типа.</span><span class="sxs-lookup"><span data-stu-id="bd941-172">For example, with an appropriate constructor, it is easier to declare several instances of a `Product` class than it is to declare several instances of an anonymous type.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#9](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#9)]  
  
 <span data-ttu-id="bd941-173">Другое преимущество именованных типов заключается в том, что компилятор может перехватить случайную невозможность ввода имени свойства.</span><span class="sxs-lookup"><span data-stu-id="bd941-173">Another advantage of named types is that the compiler can catch an accidental mistyping of a property name.</span></span> <span data-ttu-id="bd941-174">В предыдущих примерах, `firstProd2` , `secondProd2` и должны `thirdProd2` быть экземплярами одного и того же анонимного типа.</span><span class="sxs-lookup"><span data-stu-id="bd941-174">In the previous examples, `firstProd2`, `secondProd2`, and `thirdProd2` are intended to be instances of the same anonymous type.</span></span> <span data-ttu-id="bd941-175">Однако, если вы случайно объявили `thirdProd2` один из следующих способов, его тип будет отличаться от типа `firstProd2` и `secondProd2` .</span><span class="sxs-lookup"><span data-stu-id="bd941-175">However, if you were to accidentally declare `thirdProd2` in one of the following ways, its type would be different from that of `firstProd2` and `secondProd2`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#10](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#10)]  
  
 <span data-ttu-id="bd941-176">Что более важно, существуют ограничения на использование анонимных типов, которые не применяются к экземплярам именованных типов.</span><span class="sxs-lookup"><span data-stu-id="bd941-176">More importantly, there are limitations on the use of anonymous types that do not apply to instances of named types.</span></span> <span data-ttu-id="bd941-177">`firstProd2`, `secondProd2` и `thirdProd2` являются экземплярами одного и того же анонимного типа.</span><span class="sxs-lookup"><span data-stu-id="bd941-177">`firstProd2`, `secondProd2`, and `thirdProd2` are instances of the same anonymous type.</span></span> <span data-ttu-id="bd941-178">Однако имя общего анонимного типа недоступно и не может использоваться, если в коде ожидается имя типа.</span><span class="sxs-lookup"><span data-stu-id="bd941-178">However, the name for the shared anonymous type is not available and cannot appear where a type name is expected in your code.</span></span> <span data-ttu-id="bd941-179">Например, анонимный тип нельзя использовать для определения сигнатуры метода, для объявления другой переменной или поля или в любом объявлении типа.</span><span class="sxs-lookup"><span data-stu-id="bd941-179">For example, an anonymous type cannot be used to define a method signature, to declare another variable or field, or in any type declaration.</span></span> <span data-ttu-id="bd941-180">В результате анонимные типы не подходят, если необходимо обмениваться информацией между методами.</span><span class="sxs-lookup"><span data-stu-id="bd941-180">As a result, anonymous types are not appropriate when you have to share information across methods.</span></span>  
  
## <a name="an-anonymous-type-definition"></a><span data-ttu-id="bd941-181">Определение анонимного типа</span><span class="sxs-lookup"><span data-stu-id="bd941-181">An Anonymous Type Definition</span></span>  

 <span data-ttu-id="bd941-182">В ответ на объявление экземпляра анонимного типа компилятор создает новое определение класса, которое содержит указанные свойства.</span><span class="sxs-lookup"><span data-stu-id="bd941-182">In response to the declaration of an instance of an anonymous type, the compiler creates a new class definition that contains the specified properties.</span></span>  
  
 <span data-ttu-id="bd941-183">Если анонимный тип содержит по крайней мере одно ключевое свойство, определение переопределяет три члена, наследуемые от <xref:System.Object> : <xref:System.Object.Equals%2A> , <xref:System.Object.GetHashCode%2A> и <xref:System.Object.ToString%2A> .</span><span class="sxs-lookup"><span data-stu-id="bd941-183">If the anonymous type contains at least one key property, the definition overrides three members inherited from <xref:System.Object>: <xref:System.Object.Equals%2A>, <xref:System.Object.GetHashCode%2A>, and <xref:System.Object.ToString%2A>.</span></span> <span data-ttu-id="bd941-184">Код, созданный для проверки равенства и определения значения хэш-кода, рассматривает только ключевые свойства.</span><span class="sxs-lookup"><span data-stu-id="bd941-184">The code produced for testing equality and determining the hash code value considers only the key properties.</span></span> <span data-ttu-id="bd941-185">Если анонимный тип не содержит свойств ключа, <xref:System.Object.ToString%2A> переопределяется только.</span><span class="sxs-lookup"><span data-stu-id="bd941-185">If the anonymous type contains no key properties, only <xref:System.Object.ToString%2A> is overridden.</span></span> <span data-ttu-id="bd941-186">Явно именованные свойства анонимного типа не могут конфликтовать с этими созданными методами.</span><span class="sxs-lookup"><span data-stu-id="bd941-186">Explicitly named properties of an anonymous type cannot conflict with these generated methods.</span></span> <span data-ttu-id="bd941-187">То есть нельзя использовать `.Equals` , `.GetHashCode` или `.ToString` для именования свойства.</span><span class="sxs-lookup"><span data-stu-id="bd941-187">That is, you cannot use `.Equals`, `.GetHashCode`, or `.ToString` to name a property.</span></span>  
  
 <span data-ttu-id="bd941-188">Определения анонимных типов, имеющие по крайней мере одно ключевое свойство, также реализуют <xref:System.IEquatable%601?displayProperty=nameWithType> интерфейс, где `T` — это тип анонимного типа.</span><span class="sxs-lookup"><span data-stu-id="bd941-188">Anonymous type definitions that have at least one key property also implement the <xref:System.IEquatable%601?displayProperty=nameWithType> interface, where `T` is the type of the anonymous type.</span></span>  
  
 <span data-ttu-id="bd941-189">Дополнительные сведения о коде, созданном компилятором, и функциональных возможностях переопределенных методов см. в разделе [Определение анонимного типа](anonymous-type-definition.md).</span><span class="sxs-lookup"><span data-stu-id="bd941-189">For more information about the code created by the compiler and the functionality of the overridden methods, see [Anonymous Type Definition](anonymous-type-definition.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="bd941-190">См. также раздел</span><span class="sxs-lookup"><span data-stu-id="bd941-190">See also</span></span>

- [<span data-ttu-id="bd941-191">Инициализаторы объектов: именованные и анонимные типы</span><span class="sxs-lookup"><span data-stu-id="bd941-191">Object Initializers: Named and Anonymous Types</span></span>](object-initializers-named-and-anonymous-types.md)
- [<span data-ttu-id="bd941-192">Вывод локального типа</span><span class="sxs-lookup"><span data-stu-id="bd941-192">Local Type Inference</span></span>](../variables/local-type-inference.md)
- <span data-ttu-id="bd941-193">[Introduction to LINQ in Visual Basic](../linq/introduction-to-linq.md) (Знакомство с LINQ в Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="bd941-193">[Introduction to LINQ in Visual Basic](../linq/introduction-to-linq.md)</span></span>
- [<span data-ttu-id="bd941-194">Практическое руководство. Выведение имен свойств и типов в объявлениях анонимных типов</span><span class="sxs-lookup"><span data-stu-id="bd941-194">How to: Infer Property Names and Types in Anonymous Type Declarations</span></span>](how-to-infer-property-names-and-types-in-anonymous-type-declarations.md)
- [<span data-ttu-id="bd941-195">Определение анонимного типа</span><span class="sxs-lookup"><span data-stu-id="bd941-195">Anonymous Type Definition</span></span>](anonymous-type-definition.md)
- [<span data-ttu-id="bd941-196">Ключ</span><span class="sxs-lookup"><span data-stu-id="bd941-196">Key</span></span>](../../../language-reference/modifiers/key.md)
