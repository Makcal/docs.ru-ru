---
title: 'CA1401: методы P-Invoke не должны быть видимыми (анализ кода)'
description: 'Дополнительные сведения о правиле анализа кода CA1401: P-Invokes не должно быть видимым'
ms.date: 11/04/2016
ms.topic: reference
f1_keywords:
- PInvokesShouldNotBeVisible
- CA1401
helpviewer_keywords:
- CA1401
- PInvokesShouldNotBeVisible
author: gewarren
ms.author: gewarren
dev_langs:
- CSharp
- VB
ms.openlocfilehash: d2326ea12fc6dade2f436d4b92ea79cecd20216b
ms.sourcegitcommit: 4df8e005c074ceb1f978f007b222fe253be2baf3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/04/2021
ms.locfileid: "99546417"
---
# <a name="ca1401-pinvokes-should-not-be-visible"></a><span data-ttu-id="e0910-103">CA1401: методы P/Invoke не должны быть видимыми</span><span class="sxs-lookup"><span data-stu-id="e0910-103">CA1401: P/Invokes should not be visible</span></span>

|                                     | <span data-ttu-id="e0910-104">Значение</span><span class="sxs-lookup"><span data-stu-id="e0910-104">Value</span></span>                      |
|-------------------------------------|----------------------------|
| <span data-ttu-id="e0910-105">**Идентификатор правила**</span><span class="sxs-lookup"><span data-stu-id="e0910-105">**Rule ID**</span></span>                          | <span data-ttu-id="e0910-106">CA1401</span><span class="sxs-lookup"><span data-stu-id="e0910-106">CA1401</span></span>                     |
| <span data-ttu-id="e0910-107">**Категория**</span><span class="sxs-lookup"><span data-stu-id="e0910-107">**Category**</span></span>                        | [<span data-ttu-id="e0910-108">Microsoft. взаимодействие</span><span class="sxs-lookup"><span data-stu-id="e0910-108">Microsoft.Interoperability</span></span>](interoperability-warnings.md) |
| <span data-ttu-id="e0910-109">**Исправление не критическое или не критическое**</span><span class="sxs-lookup"><span data-stu-id="e0910-109">**Fix is breaking or non-breaking**</span></span> | <span data-ttu-id="e0910-110">Критическое</span><span class="sxs-lookup"><span data-stu-id="e0910-110">Breaking</span></span>                   |

## <a name="cause"></a><span data-ttu-id="e0910-111">Причина</span><span class="sxs-lookup"><span data-stu-id="e0910-111">Cause</span></span>

<span data-ttu-id="e0910-112">Открытый или защищенный метод в открытом типе имеет <xref:System.Runtime.InteropServices.DllImportAttribute?displayProperty=fullName> атрибут (также реализуется `Declare` ключевым словом в Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="e0910-112">A public or protected method in a public type has the <xref:System.Runtime.InteropServices.DllImportAttribute?displayProperty=fullName> attribute (also implemented by the `Declare` keyword in Visual Basic).</span></span>

## <a name="rule-description"></a><span data-ttu-id="e0910-113">Описание правила</span><span class="sxs-lookup"><span data-stu-id="e0910-113">Rule description</span></span>

<span data-ttu-id="e0910-114">Методы, помеченные <xref:System.Runtime.InteropServices.DllImportAttribute> атрибутом (или методами, определенными с помощью `Declare` ключевого слова в Visual Basic), используют службы вызова платформы для доступа к неуправляемому коду.</span><span class="sxs-lookup"><span data-stu-id="e0910-114">Methods that are marked with the <xref:System.Runtime.InteropServices.DllImportAttribute> attribute (or methods that are defined by using the `Declare` keyword in Visual Basic) use Platform Invocation Services to access unmanaged code.</span></span> <span data-ttu-id="e0910-115">Такие методы не следует делать видимыми.</span><span class="sxs-lookup"><span data-stu-id="e0910-115">Such methods should not be exposed.</span></span> <span data-ttu-id="e0910-116">Сохранив эти методы как частные или внутренние, вы убедитесь, что библиотека не может быть использована для нарушения безопасности, разрешая вызывающим объектам доступ к неуправляемым API, которые им не удалось вызвать в противном случае.</span><span class="sxs-lookup"><span data-stu-id="e0910-116">By keeping these methods private or internal, you make sure that your library cannot be used to breach security by allowing callers access to unmanaged APIs that they could not call otherwise.</span></span>

## <a name="how-to-fix-violations"></a><span data-ttu-id="e0910-117">Устранение нарушений</span><span class="sxs-lookup"><span data-stu-id="e0910-117">How to fix violations</span></span>

<span data-ttu-id="e0910-118">Чтобы устранить нарушение этого правила, измените уровень доступа метода.</span><span class="sxs-lookup"><span data-stu-id="e0910-118">To fix a violation of this rule, change the access level of the method.</span></span>

## <a name="when-to-suppress-warnings"></a><span data-ttu-id="e0910-119">Когда следует подавлять предупреждения</span><span class="sxs-lookup"><span data-stu-id="e0910-119">When to suppress warnings</span></span>

<span data-ttu-id="e0910-120">Для этого правила отключать вывод предупреждений не следует.</span><span class="sxs-lookup"><span data-stu-id="e0910-120">Do not suppress a warning from this rule.</span></span>

## <a name="example"></a><span data-ttu-id="e0910-121">Пример</span><span class="sxs-lookup"><span data-stu-id="e0910-121">Example</span></span>

<span data-ttu-id="e0910-122">В следующем примере объявляется метод, нарушающий это правило.</span><span class="sxs-lookup"><span data-stu-id="e0910-122">The following example declares a method that violates this rule.</span></span>

:::code language="csharp" source="snippets/csharp/all-rules/ca1401.cs" id="snippet1":::

:::code language="vb" source="snippets/vb/all-rules/ca1401-p-invokes-should-not-be-visible_1.vb":::
