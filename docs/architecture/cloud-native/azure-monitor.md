---
title: Azure Monitor
description: Использование Azure Monitor, чтобы получить представление о работающей системе.
ms.date: 01/19/2021
ms.openlocfilehash: a93b71db642e05a830b20b80d8387c24d35ea8c1
ms.sourcegitcommit: f2ab02d9a780819ca2e5310bbcf5cfe5b7993041
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/03/2021
ms.locfileid: "99506179"
---
# <a name="azure-monitor"></a><span data-ttu-id="15af6-103">Azure Monitor</span><span class="sxs-lookup"><span data-stu-id="15af6-103">Azure Monitor</span></span>

<span data-ttu-id="15af6-104">Ни один другой поставщик облачных решений не является устаревшим решением для мониторинга облачных приложений, чем найдено в Azure.</span><span class="sxs-lookup"><span data-stu-id="15af6-104">No other cloud provider has as mature of a cloud application monitoring solution than that found in Azure.</span></span> <span data-ttu-id="15af6-105">Azure Monitor — это имя-пользователя для набора средств, предназначенных для обеспечения видимости состояния системы.</span><span class="sxs-lookup"><span data-stu-id="15af6-105">Azure Monitor is an umbrella name for a collection of tools designed to provide visibility into the state of your system.</span></span> <span data-ttu-id="15af6-106">Он помогает понять, как работают облачные службы и заранее выявляет проблемы, влияющие на них.</span><span class="sxs-lookup"><span data-stu-id="15af6-106">It helps you understand how your cloud-native services are performing and proactively identifies issues affecting them.</span></span> <span data-ttu-id="15af6-107">На рис. 7-12 представлен высокий уровень представления Azure Monitor.</span><span class="sxs-lookup"><span data-stu-id="15af6-107">Figure 7-12 presents a high level of view of Azure Monitor.</span></span>

<span data-ttu-id="15af6-108">![Высокоуровневое представление Azure Monitor. ](./media/azure-monitor.png)
 **Рис. 7-12**.</span><span class="sxs-lookup"><span data-stu-id="15af6-108">![High-level view of Azure Monitor.](./media/azure-monitor.png)
**Figure 7-12**.</span></span> <span data-ttu-id="15af6-109">Высокоуровневое представление Azure Monitor.</span><span class="sxs-lookup"><span data-stu-id="15af6-109">High-level view of Azure Monitor.</span></span>

## <a name="gathering-logs-and-metrics"></a><span data-ttu-id="15af6-110">Сбор журналов и метрик</span><span class="sxs-lookup"><span data-stu-id="15af6-110">Gathering logs and metrics</span></span>

<span data-ttu-id="15af6-111">Первым шагом в любом решении для мониторинга является сбор максимально возможного объема данных.</span><span class="sxs-lookup"><span data-stu-id="15af6-111">The first step in any monitoring solution is to gather as much data as possible.</span></span> <span data-ttu-id="15af6-112">Чем больше собранных данных, тем глубже ценная информация.</span><span class="sxs-lookup"><span data-stu-id="15af6-112">The more data gathered, the deeper the insights.</span></span> <span data-ttu-id="15af6-113">Работа с системными инструментами традиционно была сложной задачей.</span><span class="sxs-lookup"><span data-stu-id="15af6-113">Instrumenting systems has traditionally been difficult.</span></span> <span data-ttu-id="15af6-114">Протокол SNMP был стандартным протоколом для сбора информации на уровне компьютера, но он требовал значительных знаний и конфигурации.</span><span class="sxs-lookup"><span data-stu-id="15af6-114">Simple Network Management Protocol (SNMP) was the gold standard protocol for collecting machine level information, but it required a great deal of knowledge and configuration.</span></span> <span data-ttu-id="15af6-115">К счастью, большая часть этой жесткой работы была устранена, так как наиболее распространенные метрики автоматически собираются Azure Monitor.</span><span class="sxs-lookup"><span data-stu-id="15af6-115">Fortunately, much of this hard work has been eliminated as the most common metrics are gathered automatically by Azure Monitor.</span></span>

<span data-ttu-id="15af6-116">Метрики и события уровня приложения не могут быть инструментированы автоматически, поскольку они относятся к развертываемому приложению.</span><span class="sxs-lookup"><span data-stu-id="15af6-116">Application level metrics and events aren't possible to instrument automatically because they're specific to the application being deployed.</span></span> <span data-ttu-id="15af6-117">Для сбора этих метрик доступны [пакеты SDK и API](/azure/azure-monitor/app/api-custom-events-metrics) , которые позволяют напрямую сообщать такую информацию, например, когда клиент регистрируется или завершает заказ.</span><span class="sxs-lookup"><span data-stu-id="15af6-117">In order to gather these metrics, there are [SDKs and APIs available](/azure/azure-monitor/app/api-custom-events-metrics) to directly report such information, such as when a customer signs up or completes an order.</span></span> <span data-ttu-id="15af6-118">Исключения также могут быть перехвачены и возвращены в Azure Monitor с помощью Application Insights.</span><span class="sxs-lookup"><span data-stu-id="15af6-118">Exceptions can also be captured and reported back into Azure Monitor via Application Insights.</span></span> <span data-ttu-id="15af6-119">Пакеты SDK поддерживают большинство языков в собственных облачных приложениях, в том числе Go, Python, JavaScript и .NET.</span><span class="sxs-lookup"><span data-stu-id="15af6-119">The SDKs support most every language found in Cloud Native Applications including Go, Python, JavaScript, and the .NET languages.</span></span>

<span data-ttu-id="15af6-120">Основная цель сбора сведений о состоянии приложения — обеспечить хорошую работу конечных пользователей.</span><span class="sxs-lookup"><span data-stu-id="15af6-120">The ultimate goal of gathering information about the state of your application is to ensure that your end users have a good experience.</span></span> <span data-ttu-id="15af6-121">Какой лучший способ узнать, возникают ли проблемы у пользователей, чем [за пределами веб-тестов](/azure/azure-monitor/app/monitor-web-app-availability)?</span><span class="sxs-lookup"><span data-stu-id="15af6-121">What better way to tell if users are experiencing issues than doing [outside-in web tests](/azure/azure-monitor/app/monitor-web-app-availability)?</span></span> <span data-ttu-id="15af6-122">Эти тесты могут быть простыми при проверке связи с веб-сайтом из расположений по всему миру или в том случае, если агенты входят в систему на сайте и имитируют действия пользователя.</span><span class="sxs-lookup"><span data-stu-id="15af6-122">These tests can be as simple as pinging your website from locations around the world or as involved as having agents log into the site and simulate user actions.</span></span>

## <a name="reporting-data"></a><span data-ttu-id="15af6-123">Данные отчетов</span><span class="sxs-lookup"><span data-stu-id="15af6-123">Reporting data</span></span>

<span data-ttu-id="15af6-124">После сбора данных их можно обменять, суммировать и отображать на диаграммах, что позволяет пользователям мгновенно видеть, когда возникают проблемы.</span><span class="sxs-lookup"><span data-stu-id="15af6-124">Once the data is gathered, it can be manipulated, summarized, and plotted into charts, which allow users to instantly see when there are problems.</span></span> <span data-ttu-id="15af6-125">Эти диаграммы могут быть собраны на панели мониторинга или в книги, многостраничный отчет, предназначенный для описания некоторых аспектов системы.</span><span class="sxs-lookup"><span data-stu-id="15af6-125">These charts can be gathered into dashboards or into Workbooks, a multi-page report designed to tell a story about some aspect of the system.</span></span>

<span data-ttu-id="15af6-126">Ни одно современное приложение не было бы полным без искусственного интеллекта или машинного обучения.</span><span class="sxs-lookup"><span data-stu-id="15af6-126">No modern application would be complete without some artificial intelligence or machine learning.</span></span> <span data-ttu-id="15af6-127">Для этого данные [могут быть переданы](https://www.youtube.com/watch?v=Cuza-I1g9tw) различным средствам машинного обучения в Azure, что позволяет извлекать тенденции и информацию, которые в противном случае были бы скрыты.</span><span class="sxs-lookup"><span data-stu-id="15af6-127">To this end, data [can be passed](https://www.youtube.com/watch?v=Cuza-I1g9tw) to the various machine learning tools in Azure to allow you to extract trends and information that would otherwise be hidden.</span></span>

<span data-ttu-id="15af6-128">Application Insights предоставляет мощный (похожий на SQL) язык запросов, именуемый *Kusto* , который может запрашивать записи, суммировать их и даже строить диаграммы.</span><span class="sxs-lookup"><span data-stu-id="15af6-128">Application Insights provides a powerful (SQL-like) query language called *Kusto* that can query records, summarize them, and even plot charts.</span></span> <span data-ttu-id="15af6-129">Например, следующий запрос найдет все записи за 2007 ноября, сгруппировать их по штату и выстроить 10 лучших в виде круговой диаграммы.</span><span class="sxs-lookup"><span data-stu-id="15af6-129">For example, the following query will locate all records for the month of November 2007, group them by state, and plot the top 10 as a pie chart.</span></span>

```kusto
StormEvents
| where StartTime >= datetime(2007-11-01) and StartTime < datetime(2007-12-01)
| summarize count() by State
| top 10 by count_
| render piechart
```

<span data-ttu-id="15af6-130">На рис. 7-13 показаны результаты этого запроса Application Insights.</span><span class="sxs-lookup"><span data-stu-id="15af6-130">Figure 7-13 shows the results of this Application Insights Query.</span></span>

<span data-ttu-id="15af6-131">![Application Insights результаты запроса ](./media/application_insights_example.png)
 **рис. 7-13**.</span><span class="sxs-lookup"><span data-stu-id="15af6-131">![Application Insights query results](./media/application_insights_example.png)
**Figure 7-13**.</span></span> <span data-ttu-id="15af6-132">Application Insights результаты запроса.</span><span class="sxs-lookup"><span data-stu-id="15af6-132">Application Insights query results.</span></span>

<span data-ttu-id="15af6-133">Существует [Playground для экспериментов с запросами Kusto](https://dataexplorer.azure.com/clusters/help/databases/Samples) .</span><span class="sxs-lookup"><span data-stu-id="15af6-133">There is a [playground for experimenting with Kusto](https://dataexplorer.azure.com/clusters/help/databases/Samples) queries.</span></span> <span data-ttu-id="15af6-134">Для чтения [образцов запросов](/azure/kusto/query/samples) также можно использовать инструкции.</span><span class="sxs-lookup"><span data-stu-id="15af6-134">Reading [sample queries](/azure/kusto/query/samples) can also be instructive.</span></span>

## <a name="dashboards"></a><span data-ttu-id="15af6-135">Панели мониторинга</span><span class="sxs-lookup"><span data-stu-id="15af6-135">Dashboards</span></span>

<span data-ttu-id="15af6-136">Существует несколько различных технологий панели мониторинга, которые можно использовать для отображения информации от Azure Monitor.</span><span class="sxs-lookup"><span data-stu-id="15af6-136">There are several different dashboard technologies that may be used to surface the information from Azure Monitor.</span></span> <span data-ttu-id="15af6-137">Возможно, проще всего просто выполнить запросы в Application Insights и [отобразить данные в диаграмме](/azure/azure-monitor/learn/tutorial-app-dashboards).</span><span class="sxs-lookup"><span data-stu-id="15af6-137">Perhaps the simplest is to just run queries in Application Insights and [plot the data into a chart](/azure/azure-monitor/learn/tutorial-app-dashboards).</span></span>

<span data-ttu-id="15af6-138">![Пример Application Insights диаграмм, внедренных на главную панель мониторинга Azure ](./media/azure_dashboard.png)
 **рис. 7-14**.</span><span class="sxs-lookup"><span data-stu-id="15af6-138">![An example of Application Insights charts embedded in the main Azure Dashboard](./media/azure_dashboard.png)
**Figure 7-14**.</span></span> <span data-ttu-id="15af6-139">Пример Application Insights диаграмм, внедренных в основную панель мониторинга Azure.</span><span class="sxs-lookup"><span data-stu-id="15af6-139">An example of Application Insights charts embedded in the main Azure Dashboard.</span></span>

<span data-ttu-id="15af6-140">Эти диаграммы затем можно внедрить в портал Azure правильно с помощью функции панели мониторинга.</span><span class="sxs-lookup"><span data-stu-id="15af6-140">These charts can then be embedded in the Azure portal proper through use of the dashboard feature.</span></span> <span data-ttu-id="15af6-141">Для пользователей с более точными требованиями, например для детализации на нескольких уровнях данных, Azure Monitor данные доступны для [Power BI](https://powerbi.microsoft.com/).</span><span class="sxs-lookup"><span data-stu-id="15af6-141">For users with more exacting requirements, such as being able to drill down into several tiers of data, Azure Monitor data is available to [Power BI](https://powerbi.microsoft.com/).</span></span> <span data-ttu-id="15af6-142">Power BI является ведущим в отрасли, корпоративным классом, средством бизнес-аналитики, которое может выполнять статистическую обработку данных из множества различных источников данных.</span><span class="sxs-lookup"><span data-stu-id="15af6-142">Power BI is an industry-leading, enterprise class, business intelligence tool that can aggregate data from many different data sources.</span></span>

![Пример Power BI панели мониторинга](./media/powerbidashboard.png)

<span data-ttu-id="15af6-144">**Рис. 7-15**.</span><span class="sxs-lookup"><span data-stu-id="15af6-144">**Figure 7-15**.</span></span> <span data-ttu-id="15af6-145">Пример Power BI панели мониторинга.</span><span class="sxs-lookup"><span data-stu-id="15af6-145">An example Power BI dashboard.</span></span>

## <a name="alerts"></a><span data-ttu-id="15af6-146">видны узлы</span><span class="sxs-lookup"><span data-stu-id="15af6-146">Alerts</span></span>

<span data-ttu-id="15af6-147">Иногда нет достаточных панелей мониторинга данных.</span><span class="sxs-lookup"><span data-stu-id="15af6-147">Sometimes, having data dashboards is insufficient.</span></span> <span data-ttu-id="15af6-148">Если никто не находится в спящем режиме для просмотра панелей мониторинга, это может быть несколько часов, прежде чем проблема будет устранена или даже обнаружена.</span><span class="sxs-lookup"><span data-stu-id="15af6-148">If nobody is awake to watch the dashboards, then it can still be many hours before a problem is addressed, or even detected.</span></span> <span data-ttu-id="15af6-149">В конце концов, Azure Monitor также предоставляет решение для [оповещений](/azure/azure-monitor/platform/alerts-overview)с высшим делением.</span><span class="sxs-lookup"><span data-stu-id="15af6-149">To this end, Azure Monitor also provides a top notch [alerting solution](/azure/azure-monitor/platform/alerts-overview).</span></span> <span data-ttu-id="15af6-150">Оповещения могут инициироваться с помощью широкого диапазона условий, в том числе:</span><span class="sxs-lookup"><span data-stu-id="15af6-150">Alerts can be triggered by a wide range of conditions including:</span></span>

- <span data-ttu-id="15af6-151">Значения метрик</span><span class="sxs-lookup"><span data-stu-id="15af6-151">Metric values</span></span>
- <span data-ttu-id="15af6-152">Запросы поиска по журналам</span><span class="sxs-lookup"><span data-stu-id="15af6-152">Log search queries</span></span>
- <span data-ttu-id="15af6-153">События в журнале действий</span><span class="sxs-lookup"><span data-stu-id="15af6-153">Activity Log events</span></span>
- <span data-ttu-id="15af6-154">Работоспособность базовой платформы Azure</span><span class="sxs-lookup"><span data-stu-id="15af6-154">Health of the underlying Azure platform</span></span>
- <span data-ttu-id="15af6-155">Тесты на доступность веб-сайта</span><span class="sxs-lookup"><span data-stu-id="15af6-155">Tests for web site availability</span></span>

<span data-ttu-id="15af6-156">При активации оповещения могут выполнять разнообразные задачи.</span><span class="sxs-lookup"><span data-stu-id="15af6-156">When triggered, the alerts can perform a wide variety of tasks.</span></span> <span data-ttu-id="15af6-157">С простой стороны, оповещения могут просто отправить уведомление по электронной почте в список рассылки или текстовое сообщение отдельному пользователю.</span><span class="sxs-lookup"><span data-stu-id="15af6-157">On the simple side, the alerts may just send an e-mail notification to a mailing list or a text message to an individual.</span></span> <span data-ttu-id="15af6-158">Дополнительные вовлеченные предупреждения могут активировать рабочий процесс в средстве, например PagerDuty, что известно о том, кто находится в вызове конкретного приложения.</span><span class="sxs-lookup"><span data-stu-id="15af6-158">More involved alerts might trigger a workflow in a tool such as PagerDuty, which is aware of who is on call for a particular application.</span></span> <span data-ttu-id="15af6-159">Оповещения могут активировать действия в [Microsoft Flow](https://flow.microsoft.com/) разблокировки неограниченных возможностей для рабочих процессов.</span><span class="sxs-lookup"><span data-stu-id="15af6-159">Alerts can trigger actions in [Microsoft Flow](https://flow.microsoft.com/) unlocking near limitless possibilities for workflows.</span></span>

<span data-ttu-id="15af6-160">Как правило, оповещения могут быть расширены с помощью подробных сведений об основных причинах предупреждений и действиях, которые необходимо выполнить для их устранения.</span><span class="sxs-lookup"><span data-stu-id="15af6-160">As common causes of alerts are identified, the alerts can be enhanced with details about the common causes of the alerts and the steps to take to resolve them.</span></span> <span data-ttu-id="15af6-161">Самые преждевременные облачные развертывания приложений могут отказаться от самовосстанавливающих задач, которые выполняют такие действия, как удаление неисправных узлов из масштабируемого набора или активация действия автоматического масштабирования.</span><span class="sxs-lookup"><span data-stu-id="15af6-161">Highly mature cloud-native application deployments may opt to kick off self-healing tasks, which perform actions such as removing failing nodes from a scale set or triggering an autoscaling activity.</span></span> <span data-ttu-id="15af6-162">В итоге может больше не потребоваться пробудить сотрудника по телефону в 2AM, чтобы устранить проблему с активным сайтом, так как система сможет скорректировать себя, чтобы компенсировать или по крайней мере ковылять, пока кто-то не приступит к работе на следующий утром.</span><span class="sxs-lookup"><span data-stu-id="15af6-162">Eventually it may no longer be necessary to wake up on-call personnel at 2AM to resolve a live-site issue as the system will be able to adjust itself to compensate or at least limp along until somebody arrives at work the next morning.</span></span>

<span data-ttu-id="15af6-163">Azure Monitor автоматически использует машинное обучение, чтобы понять нормальные рабочие параметры развернутых приложений.</span><span class="sxs-lookup"><span data-stu-id="15af6-163">Azure Monitor automatically leverages machine learning to understand the normal operating parameters of deployed applications.</span></span> <span data-ttu-id="15af6-164">Такой подход позволяет ему обнаруживать службы, работающие за пределами их обычных параметров.</span><span class="sxs-lookup"><span data-stu-id="15af6-164">This approach enables it to detect services that are operating outside of their normal parameters.</span></span> <span data-ttu-id="15af6-165">Например, типичный трафик в будний день на сайте может составлять 10 000 запросов в минуту.</span><span class="sxs-lookup"><span data-stu-id="15af6-165">For instance, the typical weekday traffic on the site might be 10,000 requests per minute.</span></span> <span data-ttu-id="15af6-166">А затем, в течение данной недели, число запросов в минуту достигнет очень необычных 20 000 запросов.</span><span class="sxs-lookup"><span data-stu-id="15af6-166">And then, on a given week, suddenly the number of requests hits a highly unusual 20,000 requests per minute.</span></span> <span data-ttu-id="15af6-167">[Интеллектуальное обнаружение](/azure/azure-monitor/app/proactive-diagnostics) заметит это отклонение от нормы и выдаст предупреждение.</span><span class="sxs-lookup"><span data-stu-id="15af6-167">[Smart Detection](/azure/azure-monitor/app/proactive-diagnostics) will notice this deviation from the norm and trigger an alert.</span></span> <span data-ttu-id="15af6-168">В то же время анализ тенденций достаточно интеллектуально, чтобы избежать срабатывания ложных срабатываний при ожидаемой нагрузке трафика.</span><span class="sxs-lookup"><span data-stu-id="15af6-168">At the same time, the trend analysis is smart enough to avoid firing false positives when the traffic load is expected.</span></span>

## <a name="references"></a><span data-ttu-id="15af6-169">Ссылки</span><span class="sxs-lookup"><span data-stu-id="15af6-169">References</span></span>

- [<span data-ttu-id="15af6-170">Azure Monitor</span><span class="sxs-lookup"><span data-stu-id="15af6-170">Azure Monitor</span></span>](/azure/azure-monitor/overview)

>[!div class="step-by-step"]
><span data-ttu-id="15af6-171">[Назад](monitoring-azure-kubernetes.md)
>[Вперед](identity.md)</span><span class="sxs-lookup"><span data-stu-id="15af6-171">[Previous](monitoring-azure-kubernetes.md)
[Next](identity.md)</span></span>
