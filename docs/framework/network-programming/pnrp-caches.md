---
description: 'Узнайте подробнее о: Кэши PNRP'
title: Кэши PNRP
ms.date: 03/30/2017
ms.assetid: 270068d9-1b6b-4eb9-9e14-e02326bb88df
ms.openlocfilehash: a9e64cd647be2fe33863e014ee4c22d1752f56f8
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/06/2021
ms.locfileid: "99794914"
---
# <a name="pnrp-caches"></a><span data-ttu-id="c187a-103">Кэши PNRP</span><span class="sxs-lookup"><span data-stu-id="c187a-103">PNRP Caches</span></span>

<span data-ttu-id="c187a-104">Кэши протокола однорангового разрешения имен (PNRP) представляют собой локальные коллекции выбираемых по определенному алгоритму одноранговых конечных точек, которые хранятся на одноранговом узле.</span><span class="sxs-lookup"><span data-stu-id="c187a-104">Peer Name Resolution Protocol (PNRP) caches are local collections of algorithmically selected peer endpoints maintained on the peer.</span></span>  
  
## <a name="pnrp-cache-initialization"></a><span data-ttu-id="c187a-105">Инициализация кэша PNRP</span><span class="sxs-lookup"><span data-stu-id="c187a-105">PNRP Cache Initialization</span></span>  

 <span data-ttu-id="c187a-106">Чтобы инициализировать кэш PNRP или коллекцию записей имен одноранговых узлов при запуске однорангового узла, узел может использовать следующие методы:</span><span class="sxs-lookup"><span data-stu-id="c187a-106">To initialize the PNRP cache, or Peer Name Record Collection, when a peer node starts up, a node can use the following methods:</span></span>  
  
- <span data-ttu-id="c187a-107">Записи постоянного кэша, которые были сохранены на момент отключения узла или загружены с жесткого диска.</span><span class="sxs-lookup"><span data-stu-id="c187a-107">Persistent cache entries that were present when the node was shut down are loaded from hard disk storage.</span></span>  
  
- <span data-ttu-id="c187a-108">Если приложение использует инфраструктуру совместной работы P2P, сведения для совместной работы будут доступны в диспетчере контактов для соответствующего узла.</span><span class="sxs-lookup"><span data-stu-id="c187a-108">If an application uses the P2P collaboration infrastructure, collaboration information is available in the Contact Manager for that node.</span></span>  
  
## <a name="scaling-peer-name-resolution-with-a-multi-level-cache"></a><span data-ttu-id="c187a-109">Масштабирование однорангового разрешения имен с использованием многоуровневого кэша</span><span class="sxs-lookup"><span data-stu-id="c187a-109">Scaling Peer Name Resolution with a Multi-Level Cache</span></span>  

 <span data-ttu-id="c187a-110">Чтобы минимизировать размер кэшей PNRP, одноранговые узлы используют многоуровневый кэш, в котором на каждом уровне содержится максимальное количество записей.</span><span class="sxs-lookup"><span data-stu-id="c187a-110">To keep the sizes of the PNRP caches small, peer nodes use a multi-level cache, in which each level contains a maximum number of entries.</span></span> <span data-ttu-id="c187a-111">Каждый уровень кэша представляет в десять раз меньшую часть числового пространства идентификаторов PNRP (2<sup>256</sup>).</span><span class="sxs-lookup"><span data-stu-id="c187a-111">Each level in the cache represents a one tenth smaller portion of the PNRP ID number space (2<sup>256</sup>).</span></span> <span data-ttu-id="c187a-112">На самом нижнем уровне кэша находятся локально зарегистрированный идентификатор PNRP и другие близкие к нему по значению идентификаторы PNRP.</span><span class="sxs-lookup"><span data-stu-id="c187a-112">The lowest level in the cache contains a locally registered PNRP ID and other PNRP IDs that are numerically close to it.</span></span> <span data-ttu-id="c187a-113">После того как уровень кэша будет заполнен 20 записями, создается новый нижний уровень.</span><span class="sxs-lookup"><span data-stu-id="c187a-113">As a level of the cache is filled with a maximum of 20 entries, a new lower level is created.</span></span> <span data-ttu-id="c187a-114">Максимальное число уровней в кэше определяется как десятичный логарифм от общего числа идентификаторов PNRP в облаке.</span><span class="sxs-lookup"><span data-stu-id="c187a-114">The maximum number of levels in the cache is on the order of log10(Total number of PNRP IDs in the cloud).</span></span> <span data-ttu-id="c187a-115">Например, для глобального облака со 100 миллионами идентификаторов PNRP число уровней кэша (и, соответственно, число переходов при разрешении идентификатора PNRP) не превышает 8 (десятичный логарифм от 100 000 000).</span><span class="sxs-lookup"><span data-stu-id="c187a-115">For example, for a global cloud with 100 million PNRP IDs, there are no more than 8 (=log10(100,000,000)) levels in the cache and a similar number of hops to resolve a PNRP ID during name resolution.</span></span> <span data-ttu-id="c187a-116">Такой механизм обеспечивает реализацию распределенной хэш-таблицы, для которой произвольный идентификатор PNRP может быть разрешен путем перенаправления сообщений запроса PNRP на следующий ближайший одноранговый узел до тех пор, пока не будет найден соответствующий сертифицированный адрес однорангового узла.</span><span class="sxs-lookup"><span data-stu-id="c187a-116">This mechanism allows for a distributed hash table for which an arbitrary PNRP ID can be resolved by forwarding PNRP Request messages to the next-closest peer until the peer with the corresponding CPA is found.</span></span>  
  
 <span data-ttu-id="c187a-117">Чтобы гарантировать полное разрешение, каждый раз, как узел добавляет запись на самый нижний уровень своего кэша, копия этой записи распространяется на все узлы, находящиеся на последнем уровне кэша.</span><span class="sxs-lookup"><span data-stu-id="c187a-117">To ensure that resolution can complete, each time a node adds an entry to the lowest level of its cache, it floods a copy of the entry to all the nodes within the last level of the cache.</span></span>  
  
 <span data-ttu-id="c187a-118">Записи кэша периодически обновляются.</span><span class="sxs-lookup"><span data-stu-id="c187a-118">The cache entries are refreshed over time.</span></span> <span data-ttu-id="c187a-119">Устаревшие записи удаляются из кэша.</span><span class="sxs-lookup"><span data-stu-id="c187a-119">Cache entries that are stale are removed from the cache.</span></span> <span data-ttu-id="c187a-120">В результате этого получается распределенная хэш-таблица идентификаторов PNRP для активных конечных точек. В этом заключается отличие от службы DNS, записи адресов и протокол DNS которой не гарантируют, что узел, связанный с адресом, активен в сети.</span><span class="sxs-lookup"><span data-stu-id="c187a-120">The result is that the distributed hash table of PNRP IDs is based on active endpoints, unlike DNS in which address records and the DNS protocol provide no guarantee that the node associated with the address is actively on the network.</span></span>  
  
## <a name="other-pnrp-caches"></a><span data-ttu-id="c187a-121">Другие кэши PNRP</span><span class="sxs-lookup"><span data-stu-id="c187a-121">Other PNRP Caches</span></span>  

 <span data-ttu-id="c187a-122">Также для постоянного хранения данных используется локальный кэш.</span><span class="sxs-lookup"><span data-stu-id="c187a-122">Another persistent data store is the local cache.</span></span>  <span data-ttu-id="c187a-123">В дополнение к другим объектам, необходимым для реализации PNRP, он может содержать записи, связанные с сеансом совместной работы или облаком PNRP, которые безопасно публикуются и синхронизируются между всеми членами облака.</span><span class="sxs-lookup"><span data-stu-id="c187a-123">In addition to the other objects needed for PNRP activity, it may include the records associated with a PNRP cloud or collaboration session that is securely published and synchronized between all the members of the cloud.</span></span> <span data-ttu-id="c187a-124">Это реплицированное хранилище содержит представление данных группы, которые должны быть одинаковыми для всех ее членов.</span><span class="sxs-lookup"><span data-stu-id="c187a-124">This replicated store represents the view of the group data, which should be the same for all group members.</span></span> <span data-ttu-id="c187a-125">Технически эти объекты не являются записями, однако содержат сведения о присутствии приложений и данные объектов, предназначенные для локального кэша.</span><span class="sxs-lookup"><span data-stu-id="c187a-125">Technically, these objects are not records per se, but rather application, presence, and object data destined for a local cache.</span></span> <span data-ttu-id="c187a-126">Благодаря применению облака PNRP гарантируется распространение объектов на все узлы в сеансе совместной работы или облаке PNRP.</span><span class="sxs-lookup"><span data-stu-id="c187a-126">Use of the PNRP cloud ensures that objects are propagated to all nodes in the collaboration session or PNRP cloud.</span></span>  <span data-ttu-id="c187a-127">Чтобы обеспечить шифрование и целостность данных при репликации записей между членами облака, используется протокол SSL.</span><span class="sxs-lookup"><span data-stu-id="c187a-127">Record replication between cloud members uses SSL to provide encryption and data integrity.</span></span>  
  
 <span data-ttu-id="c187a-128">Одноранговый узел, который присоединяется к облаку, не будет автоматически получать данные локального кэша от ведущего однорангового узла, к которому он присоединяется. В этом случае оформляется подписка на ведущий одноранговый узел для получения обновлений сведений о присутствии приложений и данных объектов.</span><span class="sxs-lookup"><span data-stu-id="c187a-128">When a peer joins a cloud, they do not automatically receive local cache data from the host peer to which they attach; they have to subscribe to the host peer to receive updates in application, presence, and object data.</span></span> <span data-ttu-id="c187a-129">После первоначальной синхронизации одноранговые узлы периодически выполняют повторную синхронизацию реплицированных хранилищ, чтобы обеспечить согласованность представлений для каждого члена группы.</span><span class="sxs-lookup"><span data-stu-id="c187a-129">After the initial synchronization, peers periodically resynchronize their replicated stores to ensure that all group members consistently have the same view.</span></span>  <span data-ttu-id="c187a-130">Аналогичные функции могут выполняться посредством сеансов совместной работы или приложений в рамках таких сеансов.</span><span class="sxs-lookup"><span data-stu-id="c187a-130">The collaboration session or applications within the collaboration session may also perform the same function.</span></span>  
  
 <span data-ttu-id="c187a-131">После начала сеанса совместной работы для облака приложения могут регистрировать одноранговые узлы и начинают публикацию сведений о них, используя параметры безопасности, определенные для области облака.</span><span class="sxs-lookup"><span data-stu-id="c187a-131">After a collaboration session has begun for a cloud, applications can register peers and begin publishing their information using the security defined by the cloud scope.</span></span> <span data-ttu-id="c187a-132">Когда одноранговый узел присоединяется к облаку, к нему применяются механизмы безопасности облака, в результате чего определяется область, в которой он будет участвовать.</span><span class="sxs-lookup"><span data-stu-id="c187a-132">When a peer joins a cloud, the security mechanisms for the cloud are applied to the peer, giving it a scope in which to participate.</span></span>  <span data-ttu-id="c187a-133">После этого возможна публикация записей узла в области облака.</span><span class="sxs-lookup"><span data-stu-id="c187a-133">Its records can then be published securely within the scope of the cloud.</span></span> <span data-ttu-id="c187a-134">Обратите внимание, что области облака и приложения для совместной работы могут различаться.</span><span class="sxs-lookup"><span data-stu-id="c187a-134">Note that cloud scope may not be the same as collaboration application scope.</span></span>  
  
 <span data-ttu-id="c187a-135">Одноранговые узлы могут регистрировать намерение получать объекты от других таких узлов.</span><span class="sxs-lookup"><span data-stu-id="c187a-135">Peers can register interest in receiving objects from other peers.</span></span> <span data-ttu-id="c187a-136">При обновлении объекта приложение для совместной работы получает соответствующее уведомление, а новый объект передается всем подписчикам приложения.</span><span class="sxs-lookup"><span data-stu-id="c187a-136">When an object is updated, the collaboration application is notified and the new object is passed to all subscribers of the application.</span></span> <span data-ttu-id="c187a-137">Например, одноранговый узел в приложении группового чата может регистрировать намерение получать данные приложения (все записи чата).</span><span class="sxs-lookup"><span data-stu-id="c187a-137">For example, a peer in a group chat application can register interest in receiving application information, which will send it all chat records as application data.</span></span>  <span data-ttu-id="c187a-138">Такой механизм позволяет отслеживать использование чата в облаке.</span><span class="sxs-lookup"><span data-stu-id="c187a-138">This allows it to monitor chat activity within the cloud.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c187a-139">См. также раздел</span><span class="sxs-lookup"><span data-stu-id="c187a-139">See also</span></span>

- <xref:System.Net.PeerToPeer>
