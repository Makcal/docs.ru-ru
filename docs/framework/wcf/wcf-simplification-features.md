---
description: 'Дополнительные сведения: возможности упрощения WCF'
title: Возможности упрощения WCF
ms.date: 03/30/2017
ms.assetid: 4535a511-6064-4da0-b361-80262a891663
ms.openlocfilehash: cf89ff7775e2a162760c3c6c598a045ddccdf8d8
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/06/2021
ms.locfileid: "99703383"
---
# <a name="wcf-simplification-features"></a><span data-ttu-id="b948a-103">Возможности упрощения WCF</span><span class="sxs-lookup"><span data-stu-id="b948a-103">WCF Simplification Features</span></span>

<span data-ttu-id="b948a-104">В этом разделе описываются новые возможности, упрощающие написание приложений WCF.</span><span class="sxs-lookup"><span data-stu-id="b948a-104">This topic discusses new features that make writing WCF applications simpler.</span></span>

## <a name="simplified-generated-configuration-files"></a><span data-ttu-id="b948a-105">Упрощенные сформированные файлы конфигурации</span><span class="sxs-lookup"><span data-stu-id="b948a-105">Simplified Generated Configuration Files</span></span>

<span data-ttu-id="b948a-106">Клиентский файл конфигурации создается при добавлении ссылки на службу в Visual Studio или при использовании средства SvcUtil.exe.</span><span class="sxs-lookup"><span data-stu-id="b948a-106">When you add a service reference in Visual Studio or use the SvcUtil.exe tool a client configuration file is generated.</span></span> <span data-ttu-id="b948a-107">В предыдущих версиях WCF эти файлы конфигурации содержали значения каждого свойства привязки, даже если значение было значением по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="b948a-107">In previous versions of WCF these configuration files contained the value of every binding property even if its value is the default value.</span></span> <span data-ttu-id="b948a-108">В WCF 4.5 сформированные файлы конфигурации содержат только те свойства привязки, которым присвоено значение не по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="b948a-108">In WCF 4.5 the generated configuration files contain only those binding properties that are set to a non-default value.</span></span>

<span data-ttu-id="b948a-109">Далее приведен пример файла конфигурации, сформированного WCF 3.0.</span><span class="sxs-lookup"><span data-stu-id="b948a-109">The following is an example of a configuration file generated by WCF 3.0.</span></span>

```xml
<?xml version="1.0" encoding="utf-8"?>
<configuration>
    <system.serviceModel>
        <bindings>
            <basicHttpBinding>
                <binding name="BasicHttpBinding_IService1" closeTimeout="00:01:00"
                    openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
                    allowCookies="false" bypassProxyOnLocal="false"
                    hostNameComparisonMode="StrongWildcard" maxBufferSize="65536"
                    maxBufferPoolSize="524288" maxReceivedMessageSize="65536"
                    messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered"
                    useDefaultWebProxy="true">
                    <readerQuotas maxDepth="32" maxStringContentLength="8192"
                        maxArrayLength="16384" maxBytesPerRead="4096"
                        maxNameTableCharCount="16384" />
                    <security mode="None">
                        <transport clientCredentialType="None" proxyCredentialType="None"
                            realm="" />
                        <message clientCredentialType="UserName" algorithmSuite="Default" />
                    </security>
                </binding>
            </basicHttpBinding>
        </bindings>
        <client>
            <endpoint address="http://localhost:36906/Service1.svc" binding="basicHttpBinding"
                bindingConfiguration="BasicHttpBinding_IService1" contract="IService1"
                name="BasicHttpBinding_IService1" />
        </client>
    </system.serviceModel>
</configuration>
```

<span data-ttu-id="b948a-110">Далее приведен пример того же файла конфигурации, сформированного WCF 4.5.</span><span class="sxs-lookup"><span data-stu-id="b948a-110">The following is an example of the same configuration file generated by WCF 4.5.</span></span>

```xml
<?xml version="1.0" encoding="utf-8"?>
<configuration>
    <system.serviceModel>
        <bindings>
            <basicHttpBinding>
                <binding name="BasicHttpBinding_IService1" />
            </basicHttpBinding>
        </bindings>
        <client>
            <endpoint address="http://localhost:36906/Service1.svc" binding="basicHttpBinding"
                bindingConfiguration="BasicHttpBinding_IService1" contract="IService1"
                name="BasicHttpBinding_IService1" />
        </client>
    </system.serviceModel>
</configuration>
```

## <a name="contract-first-development"></a><span data-ttu-id="b948a-111">Разработка в соответствии с парадигмой «Сначала контракт»</span><span class="sxs-lookup"><span data-stu-id="b948a-111">Contract-First Development</span></span>

<span data-ttu-id="b948a-112">WCF теперь поддерживает разработку в соответствии с парадигмой «Сначала контракт».</span><span class="sxs-lookup"><span data-stu-id="b948a-112">WCF now has support for contract-first development.</span></span> <span data-ttu-id="b948a-113">Средство svcutil.exe имеет параметр/Сервицеконтракт, который позволяет создавать контракты служб и данных из документа WSDL.</span><span class="sxs-lookup"><span data-stu-id="b948a-113">The svcutil.exe tool has a /serviceContract switch which allows you to generate service and data contracts from a WSDL document.</span></span>

## <a name="add-service-reference-from-a-portable-subset-project"></a><span data-ttu-id="b948a-114">Добавление ссылки на службу из проекта переносимого подмножества</span><span class="sxs-lookup"><span data-stu-id="b948a-114">Add Service Reference From a Portable Subset Project</span></span>

<span data-ttu-id="b948a-115">Переносимые проекты подмножества позволяют программистам сборок .NET поддерживать единое дерево исходного кода и систему сборки, одновременно обеспечивая поддержку нескольких реализаций .NET (Desktop, Silverlight, Windows Phone и Xbox).</span><span class="sxs-lookup"><span data-stu-id="b948a-115">Portable subset projects enable .NET assembly programmers to maintain a single source tree and build system while still supporting multiple .NET implementations (desktop, Silverlight, Windows Phone, and Xbox).</span></span> <span data-ttu-id="b948a-116">Переносимые проекты подмножества ссылаются только на переносимые библиотеки .NET, которые являются сборками, которые могут использоваться в любой реализации .NET.</span><span class="sxs-lookup"><span data-stu-id="b948a-116">Portable subset projects only reference .NET portable libraries that are assemblies that can be used on any .NET implementation.</span></span> <span data-ttu-id="b948a-117">Процесс добавления такой же, как и при добавлении ссылки на службу в рамках любого другого клиентского приложения WCF.</span><span class="sxs-lookup"><span data-stu-id="b948a-117">The developer experience is the same as adding a service reference within any other WCF client application.</span></span> <span data-ttu-id="b948a-118">Дополнительные сведения см. [в разделе Добавление ссылки на службу в проекте переносимого подмножества](add-service-reference-in-a-portable-subset-project.md).</span><span class="sxs-lookup"><span data-stu-id="b948a-118">For more information, see [Add Service Reference in a Portable Subset Project](add-service-reference-in-a-portable-subset-project.md).</span></span>

## <a name="aspnet-compatibility-mode-default-changed"></a><span data-ttu-id="b948a-119">Изменились значения по умолчанию для режима совместимости с ASP.NET</span><span class="sxs-lookup"><span data-stu-id="b948a-119">ASP.NET Compatibility Mode Default Changed</span></span>

<span data-ttu-id="b948a-120">WCF предоставляет режим совместимости с ASP.NET, дающий разработчикам при создании служб WCF полный доступ к функциям HTTP-конвейера ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="b948a-120">WCF provides ASP.NET compatibility mode to grant developers full access to the features in the ASP.NET HTTP pipeline when writing WCF services.</span></span> <span data-ttu-id="b948a-121">Чтобы использовать этот режим, необходимо присвоить `aspNetCompatibilityEnabled` атрибуту значение true в [\<serviceHostingEnvironment>](../configure-apps/file-schema/wcf/servicehostingenvironment.md) разделе web.config. Кроме того, любой службе в этом appDomain необходимо, чтобы `RequirementsMode` свойство имело <xref:System.ServiceModel.Activation.AspNetCompatibilityRequirementsAttribute> значение <xref:System.ServiceModel.Activation.AspNetCompatibilityRequirementsMode.Allowed> или <xref:System.ServiceModel.Activation.AspNetCompatibilityRequirementsMode.Required> .</span><span class="sxs-lookup"><span data-stu-id="b948a-121">To use this mode, you must set the `aspNetCompatibilityEnabled` attribute to true in the [\<serviceHostingEnvironment>](../configure-apps/file-schema/wcf/servicehostingenvironment.md) section of web.config. Additionally, any service in this appDomain needs to have the `RequirementsMode` property on its <xref:System.ServiceModel.Activation.AspNetCompatibilityRequirementsAttribute> set to <xref:System.ServiceModel.Activation.AspNetCompatibilityRequirementsMode.Allowed> or <xref:System.ServiceModel.Activation.AspNetCompatibilityRequirementsMode.Required>.</span></span> <span data-ttu-id="b948a-122">По умолчанию <xref:System.ServiceModel.Activation.AspNetCompatibilityRequirementsAttribute> теперь имеет значение <xref:System.ServiceModel.Activation.AspNetCompatibilityRequirementsMode.Allowed> , а шаблон приложения службы WCF по умолчанию задает `aspNetCompatibilityEnabled` для атрибута значение `true` .</span><span class="sxs-lookup"><span data-stu-id="b948a-122">By default <xref:System.ServiceModel.Activation.AspNetCompatibilityRequirementsAttribute> is now set to <xref:System.ServiceModel.Activation.AspNetCompatibilityRequirementsMode.Allowed> and the default WCF service application template sets the `aspNetCompatibilityEnabled` attribute to `true`.</span></span> <span data-ttu-id="b948a-123">Дополнительные сведения см. [в статье новые возможности Windows Communication Foundation 4,5](whats-new.md) и [служб WCF и ASP.NET](./feature-details/wcf-services-and-aspnet.md).</span><span class="sxs-lookup"><span data-stu-id="b948a-123">For more information, see [What's New in Windows Communication Foundation 4.5](whats-new.md) and [WCF Services and ASP.NET](./feature-details/wcf-services-and-aspnet.md).</span></span>

## <a name="streaming-improvements"></a><span data-ttu-id="b948a-124">Улучшения в потоковой передаче данных</span><span class="sxs-lookup"><span data-stu-id="b948a-124">Streaming Improvements</span></span>

- <span data-ttu-id="b948a-125">В WCF была добавлена новая поддержка асинхронной потоковой передачи данных.</span><span class="sxs-lookup"><span data-stu-id="b948a-125">New support for asynchronous streaming has been added to WCF.</span></span> <span data-ttu-id="b948a-126">Чтобы включить поддержку асинхронной потоковой передачи данных, добавьте поведение конечной точки <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior> в основное приложение службы и установите свойству <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior.AsynchronousSendEnabled%2A> значение `true`.</span><span class="sxs-lookup"><span data-stu-id="b948a-126">To enable asynchronous streaming, add the  <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior> endpoint behavior to the service host and set its <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior.AsynchronousSendEnabled%2A> property to `true`.</span></span> <span data-ttu-id="b948a-127">Это может улучшить масштабируемость, когда служба отправляет потоковые сообщения нескольким клиентам, которые медленно считывают сообщения.</span><span class="sxs-lookup"><span data-stu-id="b948a-127">This can benefit scalability when a service is sending streamed messages to multiple clients which are reading slowly.</span></span> <span data-ttu-id="b948a-128">WCF больше не блокирует один поток для каждого клиента и освобождает поток для обслуживания другого клиента.</span><span class="sxs-lookup"><span data-stu-id="b948a-128">WCF does not block one thread per client anymore and will free up the thread to service another client.</span></span>

- <span data-ttu-id="b948a-129">Убраны ограничения для буферизации сообщений, возникающие, когда служба размещается в IIS.</span><span class="sxs-lookup"><span data-stu-id="b948a-129">Removed limitations around buffering of messages when a service is IIS hosted.</span></span> <span data-ttu-id="b948a-130">В предыдущих версиях WCF при получении сообщения для размещенной в IIS службы, использующей потоковую передачу, ASP.NET перед отправкой сообщения в WCF поместило бы его в буфер целиком.</span><span class="sxs-lookup"><span data-stu-id="b948a-130">In previous versions of WCF when receiving a message for an IIS-hosted service that used streaming message transfer, ASP.NET would buffer the entire message before sending it to WCF.</span></span> <span data-ttu-id="b948a-131">Это привело бы к использованию большого объема памяти.</span><span class="sxs-lookup"><span data-stu-id="b948a-131">This would cause large memory consumption.</span></span> <span data-ttu-id="b948a-132">Эта буферизация была удалена в платформа .NET Framework 4,5. Теперь службы WCF, размещенные в IIS, могут начать обработку входящего потока до получения всего сообщения, тем самым обеспечивая истинную потоковую передачу.</span><span class="sxs-lookup"><span data-stu-id="b948a-132">This buffering has been removed in .NET Framework 4.5 and now IIS-hosted WCF services can start processing the incoming stream before the entire message has been received, thereby enabling true streaming.</span></span> <span data-ttu-id="b948a-133">Это позволяет WCF-службам моментально реагировать на сообщения, улучшая производительность.</span><span class="sxs-lookup"><span data-stu-id="b948a-133">This allows WCF to respond immediately to messages and allows improved performance.</span></span> <span data-ttu-id="b948a-134">Кроме того, теперь вам больше не требуется указывать значение для `maxRequestLength`, ограничивающего размер входящих запросов в ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="b948a-134">In addition, you no longer have to specify a value for `maxRequestLength`, the ASP.NET size limit on incoming requests.</span></span> <span data-ttu-id="b948a-135">Если данное свойство установлено, то оно не учитывается.</span><span class="sxs-lookup"><span data-stu-id="b948a-135">If this property is set, it is ignored.</span></span> <span data-ttu-id="b948a-136">Дополнительные сведения `maxRequestLength` см. в разделе [ \<httpRuntime> элемент конфигурации](/previous-versions/dotnet/netframework-1.1/e1f13641(v=vs.71)).</span><span class="sxs-lookup"><span data-stu-id="b948a-136">For more information about `maxRequestLength` see [\<httpRuntime> configuration element](/previous-versions/dotnet/netframework-1.1/e1f13641(v=vs.71)).</span></span> <span data-ttu-id="b948a-137">Вам по-прежнему потребуется настроить maxAllowedContentLength. Дополнительные сведения см. в разделе [ограничения запросов IIS](/previous-versions/iis/settings-schema/ms689462(v=vs.90)).</span><span class="sxs-lookup"><span data-stu-id="b948a-137">You will still need to configure the maxAllowedContentLength, For more information, see [IIS Request Limits](/previous-versions/iis/settings-schema/ms689462(v=vs.90)).</span></span>

## <a name="new-transport-default-values"></a><span data-ttu-id="b948a-138">Новые значения по умолчанию для свойств транспорта</span><span class="sxs-lookup"><span data-stu-id="b948a-138">New Transport Default Values</span></span>

<span data-ttu-id="b948a-139">В следующей таблице описываются измененные настройки и разделы, в которых можно найти дополнительные сведения.</span><span class="sxs-lookup"><span data-stu-id="b948a-139">The following table describes the settings that have changed and where to find additional information.</span></span>

|<span data-ttu-id="b948a-140">Свойство</span><span class="sxs-lookup"><span data-stu-id="b948a-140">Property</span></span>|<span data-ttu-id="b948a-141">Включено</span><span class="sxs-lookup"><span data-stu-id="b948a-141">On</span></span>|<span data-ttu-id="b948a-142">Новое значение по умолчанию</span><span class="sxs-lookup"><span data-stu-id="b948a-142">New Default</span></span>|<span data-ttu-id="b948a-143">Дополнительные сведения</span><span class="sxs-lookup"><span data-stu-id="b948a-143">More Information</span></span>|
|--------------|--------|-----------------|----------------------|
|<span data-ttu-id="b948a-144">channelInitializationTimeout</span><span class="sxs-lookup"><span data-stu-id="b948a-144">channelInitializationTimeout</span></span>|<xref:System.ServiceModel.NetTcpBinding>|<span data-ttu-id="b948a-145">30 секунд</span><span class="sxs-lookup"><span data-stu-id="b948a-145">30 seconds</span></span>|<span data-ttu-id="b948a-146">Это свойство определяет, как долго TCP-соединение может пройти проверку подлинности с помощью протокола .NET Framing.</span><span class="sxs-lookup"><span data-stu-id="b948a-146">This property determines how long a TCP connection can take to authenticate itself using the .NET Framing protocol.</span></span> <span data-ttu-id="b948a-147">Клиенту необходимо отправить некоторые исходные данные, прежде чем сервер получит достаточно сведений для аутентификации.</span><span class="sxs-lookup"><span data-stu-id="b948a-147">A client needs to send some initial data before the server has enough information to perform authentication.</span></span> <span data-ttu-id="b948a-148">Это время ожидания специально сделано меньше значения параметра ReceiveTimeout (10 мин) для того, чтобы непроверенные вредоносные клиенты не сохраняли соединение с сервером в течение долгого времени.</span><span class="sxs-lookup"><span data-stu-id="b948a-148">This timeout is intentionally made smaller than the ReceiveTimeout (10 min) so that malicious unauthenticated clients do not keep the connections tied up to the server for long.</span></span> <span data-ttu-id="b948a-149">Значение по умолчанию - 30 секунды.</span><span class="sxs-lookup"><span data-stu-id="b948a-149">The default value is 30 seconds.</span></span> <span data-ttu-id="b948a-150">Дополнительные сведения о <xref:System.ServiceModel.Channels.ConnectionOrientedTransportBindingElement.ChannelInitializationTimeout%2A></span><span class="sxs-lookup"><span data-stu-id="b948a-150">For more information about <xref:System.ServiceModel.Channels.ConnectionOrientedTransportBindingElement.ChannelInitializationTimeout%2A></span></span>|
|<span data-ttu-id="b948a-151">listenBacklog</span><span class="sxs-lookup"><span data-stu-id="b948a-151">listenBacklog</span></span>|<xref:System.ServiceModel.NetTcpBinding>|<span data-ttu-id="b948a-152">16 \* число процессоров</span><span class="sxs-lookup"><span data-stu-id="b948a-152">16 \* number of processors</span></span>|<span data-ttu-id="b948a-153">Это свойство уровня сокетов, которое описывает количество допустимых, ожидающих подтверждения запросов в очереди.</span><span class="sxs-lookup"><span data-stu-id="b948a-153">This socket-level property describes the number of "pending accept" requests to be queued.</span></span> <span data-ttu-id="b948a-154">Если очередь по невыполненной работе по ожиданию передачи данных заполнится полностью, новые запросы будут отклоняться.</span><span class="sxs-lookup"><span data-stu-id="b948a-154">If the listen backlog queue fills up, new socket requests will be rejected.</span></span> <span data-ttu-id="b948a-155">Дополнительные сведения о <xref:System.ServiceModel.NetTcpBinding.ListenBacklog%2A></span><span class="sxs-lookup"><span data-stu-id="b948a-155">For more information about <xref:System.ServiceModel.NetTcpBinding.ListenBacklog%2A></span></span>|
|<span data-ttu-id="b948a-156">maxPendingAccepts</span><span class="sxs-lookup"><span data-stu-id="b948a-156">maxPendingAccepts</span></span>|<span data-ttu-id="b948a-157">ConnectionOrientedTransportBindingElement</span><span class="sxs-lookup"><span data-stu-id="b948a-157">ConnectionOrientedTransportBindingElement</span></span><br /><br /> <span data-ttu-id="b948a-158">SMSvcHost.exe</span><span class="sxs-lookup"><span data-stu-id="b948a-158">SMSvcHost.exe</span></span>|<span data-ttu-id="b948a-159">2 \* количество процессоров для транспорта</span><span class="sxs-lookup"><span data-stu-id="b948a-159">2 \* number of processors for transport</span></span><br /><br /> <span data-ttu-id="b948a-160">4 \* число процессоров для SMSvcHost.exe</span><span class="sxs-lookup"><span data-stu-id="b948a-160">4 \* number of processors for SMSvcHost.exe</span></span>|<span data-ttu-id="b948a-161">Это свойство ограничивает число каналов, которое может прослушиваться в режиме ожидания на сервере.</span><span class="sxs-lookup"><span data-stu-id="b948a-161">This property limits the number of channels that the server can have waiting on a listener.</span></span> <span data-ttu-id="b948a-162">Когда параметру MaxPendingAccepts задано слишком маленькое значение, возникает небольшой промежуток времени, в течение которого ожидающие каналы начнут обслуживать подключения, но новые каналы прослушиваться не будут.</span><span class="sxs-lookup"><span data-stu-id="b948a-162">When MaxPendingAccepts is too low, there will be a small interval of time in which all of the waiting channels have started servicing connections, but no new channels have begun listening.</span></span> <span data-ttu-id="b948a-163">Соединение может произойти именно в этот интервал, и оно не будет установлено, потому что на сервере нет ожидающих каналов.</span><span class="sxs-lookup"><span data-stu-id="b948a-163">A connection can arrive during this interval and will fail because nothing is waiting for it on the server.</span></span> <span data-ttu-id="b948a-164">Это свойство может быть сконфигурировано путем задания свойству <xref:System.ServiceModel.Channels.ConnectionOrientedTransportBindingElement.MaxPendingConnections%2A> большего значения.</span><span class="sxs-lookup"><span data-stu-id="b948a-164">This property can be configured by setting the <xref:System.ServiceModel.Channels.ConnectionOrientedTransportBindingElement.MaxPendingConnections%2A> property to a larger number.</span></span> <span data-ttu-id="b948a-165">Дополнительные сведения см <xref:System.ServiceModel.Channels.ConnectionOrientedTransportBindingElement.MaxPendingAccepts%2A> [. в статье Настройка службы совместного использования портов net. TCP.](./feature-details/configuring-the-net-tcp-port-sharing-service.md)</span><span class="sxs-lookup"><span data-stu-id="b948a-165">For more information, see <xref:System.ServiceModel.Channels.ConnectionOrientedTransportBindingElement.MaxPendingAccepts%2A> and [Configuring the Net.TCP Port Sharing Service](./feature-details/configuring-the-net-tcp-port-sharing-service.md)</span></span>|
|<span data-ttu-id="b948a-166">maxPendingConnections</span><span class="sxs-lookup"><span data-stu-id="b948a-166">maxPendingConnections</span></span>|<span data-ttu-id="b948a-167">ConnectionOrientedTransportBindingElement</span><span class="sxs-lookup"><span data-stu-id="b948a-167">ConnectionOrientedTransportBindingElement</span></span>|<span data-ttu-id="b948a-168">12 \* количество процессоров</span><span class="sxs-lookup"><span data-stu-id="b948a-168">12 \* number of processors</span></span>|<span data-ttu-id="b948a-169">Это свойство определяет количество соединений, которое может быть принято транспортом, но которое не было принято диспетчером ServiceModel.</span><span class="sxs-lookup"><span data-stu-id="b948a-169">This property controls how many connections a transport has accepted but have not been picked up by the ServiceModel Dispatcher.</span></span> <span data-ttu-id="b948a-170">Для настройки этого значения используйте свойство `MaxConnections` привязки или свойство `maxOutboundConnectionsPerEndpoint` элемента привязки.</span><span class="sxs-lookup"><span data-stu-id="b948a-170">To set this value, use `MaxConnections` on the binding or `maxOutboundConnectionsPerEndpoint` on the binding element.</span></span> <span data-ttu-id="b948a-171">Дополнительные сведения о <xref:System.ServiceModel.Channels.ConnectionOrientedTransportBindingElement.MaxPendingConnections%2A></span><span class="sxs-lookup"><span data-stu-id="b948a-171">For more information about <xref:System.ServiceModel.Channels.ConnectionOrientedTransportBindingElement.MaxPendingConnections%2A></span></span>|
|<span data-ttu-id="b948a-172">receiveTimeout</span><span class="sxs-lookup"><span data-stu-id="b948a-172">receiveTimeout</span></span>|<span data-ttu-id="b948a-173">SMSvcHost.exe</span><span class="sxs-lookup"><span data-stu-id="b948a-173">SMSvcHost.exe</span></span>|<span data-ttu-id="b948a-174">30 секунд</span><span class="sxs-lookup"><span data-stu-id="b948a-174">30 seconds</span></span>|<span data-ttu-id="b948a-175">Это свойство определяет время ожидания для чтения данных кадрирования TCP и проведения распределения подключений из базовых подключений.</span><span class="sxs-lookup"><span data-stu-id="b948a-175">This property specifies the timeout for reading the TCP framing data and performing connection dispatching from the underlying connections.</span></span> <span data-ttu-id="b948a-176">Это выполняется, чтобы ограничить время, которое служба SMSvcHost.exe тратит на считывание начальных данных из входящего соединения.</span><span class="sxs-lookup"><span data-stu-id="b948a-176">This exists to put a cap on the amount of time SMSvcHost.exe service is kept engaged to read the preamble data from an incoming connection.</span></span> <span data-ttu-id="b948a-177">Дополнительные сведения см. [в разделе Настройка службы совместного использования портов net. TCP](./feature-details/configuring-the-net-tcp-port-sharing-service.md).</span><span class="sxs-lookup"><span data-stu-id="b948a-177">For more information, see [Configuring the Net.TCP Port Sharing Service](./feature-details/configuring-the-net-tcp-port-sharing-service.md).</span></span>|

> [!NOTE]
> <span data-ttu-id="b948a-178">Эти новые значения по умолчанию используются только при развертывании службы WCF на компьютере с платформой .NET Framework 4.5.</span><span class="sxs-lookup"><span data-stu-id="b948a-178">These new defaults are used only if you deploy the WCF service on a machine with .NET Framework 4.5.</span></span> <span data-ttu-id="b948a-179">При развертывании той же службы на компьютере с платформой .NET Framework 4.0 используются значения по умолчанию платформы .NET 4.0.</span><span class="sxs-lookup"><span data-stu-id="b948a-179">If you deploy the same service on a machine with .NET Framework 4.0, then the .NET Framework 4.0 defaults are used.</span></span> <span data-ttu-id="b948a-180">В таких случаях рекомендуется настроить эти параметры явно.</span><span class="sxs-lookup"><span data-stu-id="b948a-180">In such cases it is recommended to configure these settings explicitly.</span></span>

## <a name="xmldictionaryreaderquotas"></a><span data-ttu-id="b948a-181">XmlDictionaryReaderQuotas</span><span class="sxs-lookup"><span data-stu-id="b948a-181">XmlDictionaryReaderQuotas</span></span>

<span data-ttu-id="b948a-182"><xref:System.Xml.XmlDictionaryReaderQuotas> содержит настраиваемые значения квот для средств чтения словаря XML, которые ограничивают объем памяти, используемый кодировщиком при создании сообщения.</span><span class="sxs-lookup"><span data-stu-id="b948a-182"><xref:System.Xml.XmlDictionaryReaderQuotas> contains configurable quota values for XML dictionary readers which limit the amount of memory utilized by an encoder while creating a message.</span></span> <span data-ttu-id="b948a-183">Хотя эти квоты и можно изменить, значения по умолчанию были изменены так, чтобы разработчикам редко приходилось их менять.</span><span class="sxs-lookup"><span data-stu-id="b948a-183">While these quotas are configurable, the default values have changed to lessen the possibility that a developer will need to set them explicitly.</span></span> <span data-ttu-id="b948a-184">Квота `MaxReceivedMessageSize` не была изменена, и с ее помощью можно по-прежнему ограничить потребление памяти, избегнув таким образом работы со сложными <xref:System.Xml.XmlDictionaryReaderQuotas>.</span><span class="sxs-lookup"><span data-stu-id="b948a-184">`MaxReceivedMessageSize` quota has not been changed so that it can still limit memory consumption preventing the need for you to deal with the complexity of the <xref:System.Xml.XmlDictionaryReaderQuotas>.</span></span> <span data-ttu-id="b948a-185">В следующей таблице приведены квоты, их новые значения по умолчанию и краткое описание, для чего используется каждая квота.</span><span class="sxs-lookup"><span data-stu-id="b948a-185">The following table shows the quotas, their new default values and a brief explanation of what each quota is used for.</span></span>

|<span data-ttu-id="b948a-186">Имя квоты</span><span class="sxs-lookup"><span data-stu-id="b948a-186">Quota Name</span></span>|<span data-ttu-id="b948a-187">Значение по умолчанию</span><span class="sxs-lookup"><span data-stu-id="b948a-187">Default Value</span></span>|<span data-ttu-id="b948a-188">Описание</span><span class="sxs-lookup"><span data-stu-id="b948a-188">Description</span></span>|
|----------------|-------------------|-----------------|
|<xref:System.Xml.XmlDictionaryReaderQuotas.MaxArrayLength%2A>|<span data-ttu-id="b948a-189">Int32.MaxValue</span><span class="sxs-lookup"><span data-stu-id="b948a-189">Int32.MaxValue</span></span>|<span data-ttu-id="b948a-190">Возвращает и задает максимально допустимую длину массива.</span><span class="sxs-lookup"><span data-stu-id="b948a-190">Gets and sets the maximum allowed array length.</span></span> <span data-ttu-id="b948a-191">Эта квота ограничивает максимальный размер массива примитивов, возвращаемых средством чтения XML, включая байтовые массивы.</span><span class="sxs-lookup"><span data-stu-id="b948a-191">This quota limits the maximum size of an array of primitives that the XML reader returns, including byte arrays.</span></span> <span data-ttu-id="b948a-192">Эта квота ограничивает потребление памяти не в самом средстве чтения XML, а в компоненте, использующем средство чтения.</span><span class="sxs-lookup"><span data-stu-id="b948a-192">This quota does not limit memory consumption in the XML reader itself, but in whatever component that is using the reader.</span></span> <span data-ttu-id="b948a-193">Например, когда <xref:System.Runtime.Serialization.DataContractSerializer> использует средство чтения, защищенное <xref:System.Xml.XmlDictionaryReaderQuotas.MaxArrayLength%2A>, оно не десериализует байтовые массивы, чей размер превышает указанное в этой квоте значение.</span><span class="sxs-lookup"><span data-stu-id="b948a-193">For example, when the <xref:System.Runtime.Serialization.DataContractSerializer> uses a reader secured with <xref:System.Xml.XmlDictionaryReaderQuotas.MaxArrayLength%2A>, it does not deserialize byte arrays larger than this quota.</span></span>|
|<xref:System.Xml.XmlDictionaryReaderQuotas.MaxBytesPerRead%2A>|<span data-ttu-id="b948a-194">Int32.MaxValue</span><span class="sxs-lookup"><span data-stu-id="b948a-194">Int32.MaxValue</span></span>|<span data-ttu-id="b948a-195">Возвращает и задает максимально допустимое число байтов, возвращаемых для каждой операции чтения.</span><span class="sxs-lookup"><span data-stu-id="b948a-195">Gets and sets the maximum allowed bytes returned for each read.</span></span> <span data-ttu-id="b948a-196">Эта квота ограничивает число байтов, которые считываются за одну операцию считывания при чтении открывающего тега элемента и его атрибутов.</span><span class="sxs-lookup"><span data-stu-id="b948a-196">This quota limits the number of bytes that are read in a single Read operation when reading the element start tag and its attributes.</span></span> <span data-ttu-id="b948a-197">(В случае непотоковой передачи данных само имя элемента не входит в квоту.)</span><span class="sxs-lookup"><span data-stu-id="b948a-197">(In non-streamed cases, the element name itself is not counted against the quota).</span></span> <span data-ttu-id="b948a-198">Наличие слишком большого числа атрибутов XML может привести к неоправданно большому времени обработки, поскольку требуется проверка уникальности имен атрибутов.</span><span class="sxs-lookup"><span data-stu-id="b948a-198">Having too many XML attributes may use up disproportionate processing time because attribute names have to be checked for uniqueness.</span></span> <span data-ttu-id="b948a-199"><xref:System.Xml.XmlDictionaryReaderQuotas.MaxBytesPerRead%2A> устраняет эту возможную проблему.</span><span class="sxs-lookup"><span data-stu-id="b948a-199"><xref:System.Xml.XmlDictionaryReaderQuotas.MaxBytesPerRead%2A> mitigates this threat.</span></span>|
|<xref:System.Xml.XmlDictionaryReaderQuotas.MaxDepth%2A>|<span data-ttu-id="b948a-200">Глубина в 128 узлов</span><span class="sxs-lookup"><span data-stu-id="b948a-200">128 nodes deep</span></span>|<span data-ttu-id="b948a-201">Эта квота ограничивает максимальную глубину вложенности XML-элементов.</span><span class="sxs-lookup"><span data-stu-id="b948a-201">This quota limits the maximum nesting depth of XML elements.</span></span> <span data-ttu-id="b948a-202"><xref:System.Xml.XmlDictionaryReaderQuotas.MaxDepth%2A> взаимодействует с <xref:System.Xml.XmlDictionaryReaderQuotas.MaxBytesPerRead%2A>: средство чтения всегда сохраняет в памяти данные по текущему элементу и всем его предкам, поэтому максимальный потребляемый средством чтения объем памяти пропорционален произведению этих двух параметров.</span><span class="sxs-lookup"><span data-stu-id="b948a-202"><xref:System.Xml.XmlDictionaryReaderQuotas.MaxDepth%2A> interacts with <xref:System.Xml.XmlDictionaryReaderQuotas.MaxBytesPerRead%2A>: the reader always keeps data in memory for the current element and all of its ancestors, so the maximum memory consumption of the reader is proportional to the product of these two settings.</span></span> <span data-ttu-id="b948a-203">При десериализации графа объекта с глубоким вложением десериализатор принудительно получает доступ ко всему стеку, и выдается неисправимое исключение <xref:System.StackOverflowException>.</span><span class="sxs-lookup"><span data-stu-id="b948a-203">When deserializing a deeply-nested object graph, the deserializer is forced to access the entire stack and throw an unrecoverable <xref:System.StackOverflowException>.</span></span> <span data-ttu-id="b948a-204">Между вложением XML и вложением объекта существует прямая связь как для <xref:System.Runtime.Serialization.DataContractSerializer> , так и для <xref:System.Xml.Serialization.XmlSerializer>.</span><span class="sxs-lookup"><span data-stu-id="b948a-204">A direct correlation exists between XML nesting and object nesting for both the <xref:System.Runtime.Serialization.DataContractSerializer> and the <xref:System.Xml.Serialization.XmlSerializer>.</span></span> <span data-ttu-id="b948a-205"><xref:System.Xml.XmlDictionaryReaderQuotas.MaxDepth%2A> используется для устранения этой проблемы.</span><span class="sxs-lookup"><span data-stu-id="b948a-205"><xref:System.Xml.XmlDictionaryReaderQuotas.MaxDepth%2A> is used to mitigate this threat.</span></span>|
|<xref:System.Xml.XmlDictionaryReaderQuotas.MaxNameTableCharCount%2A>|<span data-ttu-id="b948a-206">Int32.MaxValue</span><span class="sxs-lookup"><span data-stu-id="b948a-206">Int32.MaxValue</span></span>|<span data-ttu-id="b948a-207">Эта квота ограничивает максимальное количество символов, разрешенных в таблице имен.</span><span class="sxs-lookup"><span data-stu-id="b948a-207">This quota limits the maximum number of characters allowed in a nametable.</span></span> <span data-ttu-id="b948a-208">В таблице имен содержатся определенные строки (например пространства имен и префиксы), возникающие при обработке документа XML.</span><span class="sxs-lookup"><span data-stu-id="b948a-208">The nametable contains certain strings (such as namespaces and prefixes) that are encountered when processing an XML document.</span></span> <span data-ttu-id="b948a-209">Поскольку эти строки буферизуются в память, эта квота используется для предотвращения чрезмерной буферизации, если ожидается потоковая передача.</span><span class="sxs-lookup"><span data-stu-id="b948a-209">As these strings are buffered in memory, this quota is used to prevent excessive buffering when streaming is expected.</span></span>|
|<xref:System.Xml.XmlDictionaryReaderQuotas.MaxStringContentLength%2A>|<span data-ttu-id="b948a-210">Int32.MaxValue</span><span class="sxs-lookup"><span data-stu-id="b948a-210">Int32.MaxValue</span></span>|<span data-ttu-id="b948a-211">Эта квота ограничивает максимальный размер строки, возвращаемой средством чтения XML.</span><span class="sxs-lookup"><span data-stu-id="b948a-211">This quota limits the maximum string size that the XML reader returns.</span></span> <span data-ttu-id="b948a-212">Эта квота ограничивает потребление памяти не в самом средстве чтения XML, а в компоненте, использующем средство чтения.</span><span class="sxs-lookup"><span data-stu-id="b948a-212">This quota does not limit memory consumption in the XML reader itself, but in the component that is using the reader.</span></span> <span data-ttu-id="b948a-213">Например, когда <xref:System.Runtime.Serialization.DataContractSerializer> использует средство чтения, защищенное <xref:System.Xml.XmlDictionaryReaderQuotas.MaxStringContentLength%2A>, он не десериализует строки, чей размер превышает указанное в этой квоте значение.</span><span class="sxs-lookup"><span data-stu-id="b948a-213">For example, when the <xref:System.Runtime.Serialization.DataContractSerializer> uses a reader secured with <xref:System.Xml.XmlDictionaryReaderQuotas.MaxStringContentLength%2A>, it does not deserialize strings larger than this quota.</span></span>|

> [!IMPORTANT]
> <span data-ttu-id="b948a-214">Дополнительные сведения о защите данных см. в разделе "безопасная работа с XML" раздела [вопросы безопасности данных](./feature-details/security-considerations-for-data.md) .</span><span class="sxs-lookup"><span data-stu-id="b948a-214">Refer to "Using XML Safely" under [Security Considerations for Data](./feature-details/security-considerations-for-data.md) for more information about securing your data.</span></span>

> [!NOTE]
> <span data-ttu-id="b948a-215">Эти новые значения по умолчанию используются только при развертывании службы WCF на компьютере с платформой .NET Framework 4.5.</span><span class="sxs-lookup"><span data-stu-id="b948a-215">These new defaults are used only if you deploy the WCF service on a machine with .NET Framework 4.5.</span></span> <span data-ttu-id="b948a-216">При развертывании той же службы на компьютере с платформой .NET Framework 4.0 используются значения по умолчанию платформы .NET 4.0.</span><span class="sxs-lookup"><span data-stu-id="b948a-216">If you deploy the same service on a machine with .NET Framework 4.0, then the .NET Framework 4.0 defaults are used.</span></span> <span data-ttu-id="b948a-217">В таких случаях рекомендуется настроить эти параметры явно.</span><span class="sxs-lookup"><span data-stu-id="b948a-217">In such cases it is recommended to configure these settings explicitly.</span></span>

## <a name="wcf-configuration-validation"></a><span data-ttu-id="b948a-218">Проверка конфигурации WCF</span><span class="sxs-lookup"><span data-stu-id="b948a-218">WCF Configuration Validation</span></span>

<span data-ttu-id="b948a-219">Будучи частью процесса сборки в Visual Studio, файлы конфигурации WCF теперь проверяются.</span><span class="sxs-lookup"><span data-stu-id="b948a-219">As part of the build process within Visual Studio, WCF configuration files are now validated.</span></span> <span data-ttu-id="b948a-220">Если проверка завершается с ошибкой, то в Visual Studio отображается список ошибок и предупреждений.</span><span class="sxs-lookup"><span data-stu-id="b948a-220">A list of validation errors or warnings are displayed in Visual Studio if the validation fails.</span></span>

## <a name="xml-editor-tooltips"></a><span data-ttu-id="b948a-221">Подсказки в редакторе XML</span><span class="sxs-lookup"><span data-stu-id="b948a-221">XML Editor Tooltips</span></span>

<span data-ttu-id="b948a-222">В XML-редакторе Visual Studio отображаются подсказки для каждого элемента конфигурации (и его свойств), входящего в файл конфигурации службы. Это облегчает работу разработчиков по конфигурации WCF-служб.</span><span class="sxs-lookup"><span data-stu-id="b948a-222">In order to help new and existing WCF service developers to configure their services, the Visual Studio XML editor now provides tooltips for every configuration element and its properties that is part of the service configuration file.</span></span>

## <a name="basichttpbinding-improvements"></a><span data-ttu-id="b948a-223">Улучшения для BasicHttpBinding</span><span class="sxs-lookup"><span data-stu-id="b948a-223">BasicHttpBinding Improvements</span></span>

1. <span data-ttu-id="b948a-224">Позволяет одной конечной точке WCF отвечать на разные режимы проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="b948a-224">Enables a single WCF endpoint to respond to different authentication modes.</span></span>

2. <span data-ttu-id="b948a-225">Позволяет IIS контролировать настройки безопасности WCF-службы.</span><span class="sxs-lookup"><span data-stu-id="b948a-225">Enables a WCF service’s security settings to be controlled by IIS</span></span>
