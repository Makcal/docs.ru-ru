---
description: 'Дополнительные сведения: Указание поведения клиента Run-Time'
title: Задание поведения клиента во время выполнения
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- behaviors [WCF], system-provided client
ms.assetid: d16d3405-be70-4edb-8f62-b5f614ddeca5
ms.openlocfilehash: 66d7e33ae0e12cadb9532ad523fd806b35e2aa7e
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/06/2021
ms.locfileid: "99755672"
---
# <a name="specifying-client-run-time-behavior"></a><span data-ttu-id="87aa3-103">Задание поведения клиента во время выполнения</span><span class="sxs-lookup"><span data-stu-id="87aa3-103">Specifying Client Run-Time Behavior</span></span>

<span data-ttu-id="87aa3-104">Клиенты Windows Communication Foundation (WCF), такие как службы Windows Communication Foundation (WCF), могут быть настроены на изменение поведения во время выполнения в соответствии с клиентским приложением.</span><span class="sxs-lookup"><span data-stu-id="87aa3-104">Windows Communication Foundation (WCF) clients, like Windows Communication Foundation (WCF) services, can be configured to modify the run-time behavior to suit the client application.</span></span> <span data-ttu-id="87aa3-105">Для задания поведения среды выполнения клиента существует три атрибута.</span><span class="sxs-lookup"><span data-stu-id="87aa3-105">Three attributes are available for specifying client run-time behavior.</span></span> <span data-ttu-id="87aa3-106">Объекты обратного вызова дуплексного клиента могут использовать атрибуты <xref:System.ServiceModel.CallbackBehaviorAttribute> и <xref:System.ServiceModel.Description.CallbackDebugBehavior> для изменения своего поведения в среде выполнения.</span><span class="sxs-lookup"><span data-stu-id="87aa3-106">Duplex client callback objects can use the <xref:System.ServiceModel.CallbackBehaviorAttribute> and <xref:System.ServiceModel.Description.CallbackDebugBehavior> attributes to modify their run-time behavior.</span></span> <span data-ttu-id="87aa3-107">Атрибут <xref:System.ServiceModel.Description.ClientViaBehavior> можно использовать для разделения логического назначения и непосредственного назначения сети.</span><span class="sxs-lookup"><span data-stu-id="87aa3-107">The other attribute, <xref:System.ServiceModel.Description.ClientViaBehavior>, can be used to separate the logical destination from the immediate network destination.</span></span> <span data-ttu-id="87aa3-108">Более того, типы обратного вызова дуплексного клиента могут использовать некоторые поведения на стороне службы.</span><span class="sxs-lookup"><span data-stu-id="87aa3-108">In addition, duplex client callback types can use some of the service-side behaviors.</span></span> <span data-ttu-id="87aa3-109">Дополнительные сведения см. в разделе [Указание поведения службы Run-Time](specifying-service-run-time-behavior.md).</span><span class="sxs-lookup"><span data-stu-id="87aa3-109">For more information, see [Specifying Service Run-Time Behavior](specifying-service-run-time-behavior.md).</span></span>  
  
## <a name="using-the-callbackbehaviorattribute"></a><span data-ttu-id="87aa3-110">Использование атрибута CallbackBehaviorAttribute</span><span class="sxs-lookup"><span data-stu-id="87aa3-110">Using the CallbackBehaviorAttribute</span></span>  

 <span data-ttu-id="87aa3-111">Настроить или расширить поведение выполнения реализации контракта обратного вызова в клиентском приложении можно с помощью класса <xref:System.ServiceModel.CallbackBehaviorAttribute>.</span><span class="sxs-lookup"><span data-stu-id="87aa3-111">You can configure or extend the execution behavior of a callback contract implementation in a client application by using the <xref:System.ServiceModel.CallbackBehaviorAttribute> class.</span></span> <span data-ttu-id="87aa3-112">Функция, выполняемая этим атрибутом для класса обратного вызова, аналогична функции, выполняемой им для класса <xref:System.ServiceModel.ServiceBehaviorAttribute>, за исключением поведения при создании экземпляров и параметров транзакции.</span><span class="sxs-lookup"><span data-stu-id="87aa3-112">This attribute performs a similar function for the callback class as the <xref:System.ServiceModel.ServiceBehaviorAttribute> class, with the exception of instancing behavior and transaction settings.</span></span>  
  
 <span data-ttu-id="87aa3-113">Необходимо применить класс <xref:System.ServiceModel.CallbackBehaviorAttribute> к классу, реализующему контракт обратного вызова.</span><span class="sxs-lookup"><span data-stu-id="87aa3-113">The <xref:System.ServiceModel.CallbackBehaviorAttribute> class must be applied to the class that implements the callback contract.</span></span> <span data-ttu-id="87aa3-114">Если класс применяется к реализации недуплексного контракта, во время выполнения создается исключение <xref:System.InvalidOperationException>.</span><span class="sxs-lookup"><span data-stu-id="87aa3-114">If applied to a nonduplex contract implementation, an <xref:System.InvalidOperationException> exception is thrown at run time.</span></span> <span data-ttu-id="87aa3-115">В следующем примере кода показан класс <xref:System.ServiceModel.CallbackBehaviorAttribute> в объекте обратного вызова, в котором используются объект <xref:System.Threading.SynchronizationContext> для определения потока, в который требуется маршалировать, свойство <xref:System.ServiceModel.CallbackBehaviorAttribute.ValidateMustUnderstand%2A> для принудительной проверки сообщений и свойство <xref:System.ServiceModel.CallbackBehaviorAttribute.IncludeExceptionDetailInFaults%2A> для возврата исключений службе в виде объектов <xref:System.ServiceModel.FaultException> в целях отладки.</span><span class="sxs-lookup"><span data-stu-id="87aa3-115">The following code example shows a <xref:System.ServiceModel.CallbackBehaviorAttribute> class on a callback object that uses the <xref:System.Threading.SynchronizationContext> object to determine the thread to marshal to, the <xref:System.ServiceModel.CallbackBehaviorAttribute.ValidateMustUnderstand%2A> property to enforce message validation, and the <xref:System.ServiceModel.CallbackBehaviorAttribute.IncludeExceptionDetailInFaults%2A> property to return exceptions as <xref:System.ServiceModel.FaultException> objects to the service for debugging purposes.</span></span>  
  
 [!code-csharp[CallbackBehaviorAttribute#3](../../../samples/snippets/csharp/VS_Snippets_CFX/callbackbehaviorattribute/cs/client.cs#3)]
 [!code-vb[CallbackBehaviorAttribute#3](../../../samples/snippets/visualbasic/VS_Snippets_CFX/callbackbehaviorattribute/vb/client.vb#3)]  
  
## <a name="using-callbackdebugbehavior-to-enable-the-flow-of-managed-exception-information"></a><span data-ttu-id="87aa3-116">Использование поведения CallbackDebugBehavior для разрешения потока сведений об управляемых исключениях.</span><span class="sxs-lookup"><span data-stu-id="87aa3-116">Using CallbackDebugBehavior to Enable the Flow of Managed Exception Information</span></span>  

 <span data-ttu-id="87aa3-117">Чтобы разрешить поток сведений об управляемых исключениях в объекте обратного вызова клиента обратно к службе в целях отладки, необходимо задать свойству <xref:System.ServiceModel.Description.CallbackDebugBehavior.IncludeExceptionDetailInFaults%2A> значение `true` программно или из файла конфигурации приложения.</span><span class="sxs-lookup"><span data-stu-id="87aa3-117">You can enable the flow of managed exception information in a client callback object back to the service for debugging purposes by setting the <xref:System.ServiceModel.Description.CallbackDebugBehavior.IncludeExceptionDetailInFaults%2A> property to `true` either programmatically or from an application configuration file.</span></span>  
  
 <span data-ttu-id="87aa3-118">Возвращение службам сведений об управляемых исключениях может представлять угрозу безопасности, потому что данные об исключениях предоставляют информацию о внутренней реализации клиента, которой могут воспользоваться неавторизованные службы.</span><span class="sxs-lookup"><span data-stu-id="87aa3-118">Returning managed exception information to services can be a security risk because exception details expose information about the internal client implementation that  unauthorized services could use.</span></span> <span data-ttu-id="87aa3-119">Кроме того, хотя свойства <xref:System.ServiceModel.Description.CallbackDebugBehavior> также могут настраиваться программно, <xref:System.ServiceModel.Description.CallbackDebugBehavior.IncludeExceptionDetailInFaults%2A> легко забыть отключить при развертывании.</span><span class="sxs-lookup"><span data-stu-id="87aa3-119">In addition, although the <xref:System.ServiceModel.Description.CallbackDebugBehavior> properties can also be set programmatically, it can be easy to forget to disable <xref:System.ServiceModel.Description.CallbackDebugBehavior.IncludeExceptionDetailInFaults%2A> when deploying.</span></span>  
  
 <span data-ttu-id="87aa3-120">Вследствие указанных проблем с безопасностью настоятельно рекомендуется делать следующее.</span><span class="sxs-lookup"><span data-stu-id="87aa3-120">Because of the security issues involved, it is strongly recommended that:</span></span>  
  
- <span data-ttu-id="87aa3-121">Файл конфигурации приложения может использоваться для присвоения свойству <xref:System.ServiceModel.Description.CallbackDebugBehavior.IncludeExceptionDetailInFaults%2A> значения `true`.</span><span class="sxs-lookup"><span data-stu-id="87aa3-121">You use an application configuration file to set the value of the <xref:System.ServiceModel.Description.CallbackDebugBehavior.IncludeExceptionDetailInFaults%2A> property to `true`.</span></span>  
  
- <span data-ttu-id="87aa3-122">Это следует делать только в контролируемых сценариях отладки.</span><span class="sxs-lookup"><span data-stu-id="87aa3-122">You do so only in controlled debugging scenarios.</span></span>  
  
 <span data-ttu-id="87aa3-123">В следующем примере кода показан файл конфигурации клиента, который указывает WCF на возвращение сведений об управляемом исключении из объекта обратного вызова клиента в сообщениях SOAP.</span><span class="sxs-lookup"><span data-stu-id="87aa3-123">The following code example shows a client configuration file that instructs WCF to return managed exception information from a client callback object in SOAP messages.</span></span>  
  
 [!code-xml[SCA.CallbackContract#4](../../../samples/snippets/csharp/VS_Snippets_CFX/sca.callbackcontract/cs/client.exe.config#4)]  

## <a name="using-the-clientviabehavior-behavior"></a><span data-ttu-id="87aa3-124">Использование поведения ClientViaBehavior</span><span class="sxs-lookup"><span data-stu-id="87aa3-124">Using the ClientViaBehavior Behavior</span></span>  

 <span data-ttu-id="87aa3-125">Для задания универсального кода ресурса (URI), для которого должен быть создан транспортный канал, можно использовать поведение <xref:System.ServiceModel.Description.ClientViaBehavior>.</span><span class="sxs-lookup"><span data-stu-id="87aa3-125">You can use the <xref:System.ServiceModel.Description.ClientViaBehavior> behavior to specify the Uniform Resource Identifier for which the transport channel should be created.</span></span> <span data-ttu-id="87aa3-126">Используйте это поведение, если непосредственное назначение сети не является предназначенным средством обработки сообщения.</span><span class="sxs-lookup"><span data-stu-id="87aa3-126">Use this behavior when the immediate network destination is not the intended processor of the message.</span></span> <span data-ttu-id="87aa3-127">Благодаря этому возможны диалоги с несколькими участками передачи, если точно не известно, знает ли вызывающее приложение конечную точку назначения, или заголовок назначения `Via` не является адресом.</span><span class="sxs-lookup"><span data-stu-id="87aa3-127">This enables multiple-hop conversations when the calling application does not necessarily know the ultimate destination or when the destination `Via` header is not an address.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="87aa3-128">См. также</span><span class="sxs-lookup"><span data-stu-id="87aa3-128">See also</span></span>

- [<span data-ttu-id="87aa3-129">Указание поведения службы во время выполнения</span><span class="sxs-lookup"><span data-stu-id="87aa3-129">Specifying Service Run-Time Behavior</span></span>](specifying-service-run-time-behavior.md)
