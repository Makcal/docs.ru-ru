---
description: Дополнительные сведения см. в статье как экспортировать утверждения настраиваемой политики.
title: Практическое руководство. Экспорт проверочных утверждений пользовательской политики
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 99030386-43b0-4f7b-866d-17ea307f5cbd
ms.openlocfilehash: b49d5a88809039f59537d79f92e31711085e580a
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/06/2021
ms.locfileid: "99668934"
---
# <a name="how-to-export-custom-policy-assertions"></a><span data-ttu-id="928d0-103">Практическое руководство. Экспорт проверочных утверждений пользовательской политики</span><span class="sxs-lookup"><span data-stu-id="928d0-103">How to: Export Custom Policy Assertions</span></span>

<span data-ttu-id="928d0-104">В утверждениях политики описываются возможности и требования конечной точки службы.</span><span class="sxs-lookup"><span data-stu-id="928d0-104">Policy assertions describe the capabilities and requirements of a service endpoint.</span></span> <span data-ttu-id="928d0-105">Приложения-службы могут использовать проверочные утверждения пользовательской политики в метаданных службы для передачи конечной точки, привязки или информации о настройке контракта клиентскому приложению.</span><span class="sxs-lookup"><span data-stu-id="928d0-105">Service applications can use custom policy assertions in service metadata to communicate endpoint, binding or contract customization information to the client application.</span></span> <span data-ttu-id="928d0-106">Windows Communication Foundation (WCF) можно использовать для экспорта утверждений в выражениях политик, присоединенных в привязках WSDL, на конечных точках, операциях или сообщениях в зависимости от возможностей или требований, которые вы обмениваетесь.</span><span class="sxs-lookup"><span data-stu-id="928d0-106">You can use Windows Communication Foundation (WCF) to export assertions in policy expressions attached in WSDL bindings at the endpoint, operation, or message subjects, depending upon the capabilities or requirements you are communicating.</span></span>  
  
 <span data-ttu-id="928d0-107">Специальные проверочные утверждения политики экспортируются путем реализации интерфейса <xref:System.ServiceModel.Description.IPolicyExportExtension?displayProperty=nameWithType> на <xref:System.ServiceModel.Channels.BindingElement?displayProperty=nameWithType> и либо вставки элемента привязки непосредственно в привязку конечной точки службы, либо регистрации элемента привязки в файле конфигурации приложения.</span><span class="sxs-lookup"><span data-stu-id="928d0-107">Custom policy assertions are exported by implementing the <xref:System.ServiceModel.Description.IPolicyExportExtension?displayProperty=nameWithType> interface on a <xref:System.ServiceModel.Channels.BindingElement?displayProperty=nameWithType> and either inserting the binding element directly into the binding of the service endpoint or by registering the binding element in your application configuration file.</span></span> <span data-ttu-id="928d0-108">Реализация экспорта политики добавляет проверочное утверждение пользовательской политики как экземпляр <xref:System.Xml.XmlElement?displayProperty=nameWithType> в соответствующую коллекцию <xref:System.ServiceModel.Description.PolicyAssertionCollection?displayProperty=nameWithType> в контексте <xref:System.ServiceModel.Description.PolicyConversionContext?displayProperty=nameWithType>, переданный методу <xref:System.ServiceModel.Description.IPolicyExportExtension.ExportPolicy%2A>.</span><span class="sxs-lookup"><span data-stu-id="928d0-108">Your policy export implementation should add your custom policy assertion as a <xref:System.Xml.XmlElement?displayProperty=nameWithType> instance to the appropriate <xref:System.ServiceModel.Description.PolicyAssertionCollection?displayProperty=nameWithType> on the <xref:System.ServiceModel.Description.PolicyConversionContext?displayProperty=nameWithType> passed into the <xref:System.ServiceModel.Description.IPolicyExportExtension.ExportPolicy%2A> method.</span></span>  
  
 <span data-ttu-id="928d0-109">Кроме этого, необходимо проверить свойство <xref:System.ServiceModel.Description.MetadataExporter.PolicyVersion%2A> класса <xref:System.ServiceModel.Description.WsdlExporter> и экспортировать вложенные выражения и политики и атрибуты инфраструктуры политики в соответствующее пространство имен в зависимости от указанной версии политики.</span><span class="sxs-lookup"><span data-stu-id="928d0-109">In addition you must check the <xref:System.ServiceModel.Description.MetadataExporter.PolicyVersion%2A> property of the <xref:System.ServiceModel.Description.WsdlExporter> class and export nested policy expressions and policy framework attributes in the correct namespace based on the policy version specified.</span></span>  
  
 <span data-ttu-id="928d0-110">Сведения об импорте утверждений пользовательской политики см. в разделе <xref:System.ServiceModel.Description.IPolicyImportExtension?displayProperty=nameWithType> и [как импортировать утверждения пользовательской политики](how-to-import-custom-policy-assertions.md).</span><span class="sxs-lookup"><span data-stu-id="928d0-110">To import custom policy assertions, see <xref:System.ServiceModel.Description.IPolicyImportExtension?displayProperty=nameWithType> and [How to: Import Custom Policy Assertions](how-to-import-custom-policy-assertions.md).</span></span>  
  
### <a name="to-export-custom-policy-assertions"></a><span data-ttu-id="928d0-111">Экспорт проверочных утверждений пользовательской политики</span><span class="sxs-lookup"><span data-stu-id="928d0-111">To export custom policy assertions</span></span>  
  
1. <span data-ttu-id="928d0-112">Реализация интерфейса <xref:System.ServiceModel.Description.IPolicyExportExtension?displayProperty=nameWithType> в <xref:System.ServiceModel.Channels.BindingElement?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="928d0-112">Implement the <xref:System.ServiceModel.Description.IPolicyExportExtension?displayProperty=nameWithType> interface on a <xref:System.ServiceModel.Channels.BindingElement?displayProperty=nameWithType>.</span></span> <span data-ttu-id="928d0-113">В следующем коде показана реализация проверочного утверждения пользовательской политики на уровне привязки.</span><span class="sxs-lookup"><span data-stu-id="928d0-113">The following code example shows the implementation of a custom policy assertion at the binding level.</span></span>  
  
     [!code-csharp[CustomPolicySample#14](../../../../samples/snippets/csharp/VS_Snippets_CFX/custompolicysample/cs/policyexporter.cs#14)]
     [!code-vb[CustomPolicySample#14](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/custompolicysample/vb/policyexporter.vb#14)]  
  
2. <span data-ttu-id="928d0-114">Элемент привязки вставляется в привязку конечной точки либо программно, либо при помощи файла конфигурации приложения.</span><span class="sxs-lookup"><span data-stu-id="928d0-114">Insert the binding element into the endpoint binding either programmatically or using an application configuration file.</span></span> <span data-ttu-id="928d0-115">См. описанные ниже действия.</span><span class="sxs-lookup"><span data-stu-id="928d0-115">See the following procedures.</span></span>  
  
### <a name="to-insert-a-binding-element-using-an-application-configuration-file"></a><span data-ttu-id="928d0-116">Вставка элемента привязки при помощи файла конфигурации приложения</span><span class="sxs-lookup"><span data-stu-id="928d0-116">To insert a binding element using an application configuration file</span></span>  
  
1. <span data-ttu-id="928d0-117">Реализуйте <xref:System.ServiceModel.Configuration.BindingElementExtensionElement?displayProperty=nameWithType> для элемента привязки проверочного утверждения пользовательской политики.</span><span class="sxs-lookup"><span data-stu-id="928d0-117">Implement <xref:System.ServiceModel.Configuration.BindingElementExtensionElement?displayProperty=nameWithType> for your custom policy assertion binding element.</span></span>  
  
2. <span data-ttu-id="928d0-118">Добавьте расширение элемента привязки в файл конфигурации с помощью [\<bindingElementExtensions>](../../configure-apps/file-schema/wcf/bindingelementextensions.md) элемента.</span><span class="sxs-lookup"><span data-stu-id="928d0-118">Add the binding element extension to the configuration file using the [\<bindingElementExtensions>](../../configure-apps/file-schema/wcf/bindingelementextensions.md) element.</span></span>  
  
3. <span data-ttu-id="928d0-119">Создайте специальную привязку с помощью <xref:System.ServiceModel.Channels.CustomBinding?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="928d0-119">Build a custom binding using the <xref:System.ServiceModel.Channels.CustomBinding?displayProperty=nameWithType>.</span></span>  
  
### <a name="to-insert-a-binding-element-programmatically"></a><span data-ttu-id="928d0-120">Вставка элемента привязки программными средствами</span><span class="sxs-lookup"><span data-stu-id="928d0-120">To insert a binding element programmatically</span></span>  
  
1. <span data-ttu-id="928d0-121">Создайте новый элемент <xref:System.ServiceModel.Channels.BindingElement?displayProperty=nameWithType> и добавьте его в <xref:System.ServiceModel.Channels.CustomBinding?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="928d0-121">Create a new <xref:System.ServiceModel.Channels.BindingElement?displayProperty=nameWithType> and add it to a <xref:System.ServiceModel.Channels.CustomBinding?displayProperty=nameWithType>.</span></span>  
  
2. <span data-ttu-id="928d0-122">Добавьте пользовательскую привязку, описанную на шаге 1,</span><span class="sxs-lookup"><span data-stu-id="928d0-122">Add the custom binding from step 1.</span></span> <span data-ttu-id="928d0-123">в новую конечную точку и добавьте эту новую конечную точку службы в <xref:System.ServiceModel.ServiceHost?displayProperty=nameWithType>, вызвав метод <xref:System.ServiceModel.ServiceHost.AddServiceEndpoint%2A>.</span><span class="sxs-lookup"><span data-stu-id="928d0-123">to a new endpoint and add that new service endpoint to the <xref:System.ServiceModel.ServiceHost?displayProperty=nameWithType> by calling the <xref:System.ServiceModel.ServiceHost.AddServiceEndpoint%2A> method.</span></span>  
  
3. <span data-ttu-id="928d0-124">Откройте <xref:System.ServiceModel.ServiceHost>.</span><span class="sxs-lookup"><span data-stu-id="928d0-124">Open the <xref:System.ServiceModel.ServiceHost>.</span></span> <span data-ttu-id="928d0-125">В следующем коде показан пример создания специальной привязки и вставки элементов привязки программными средствами.</span><span class="sxs-lookup"><span data-stu-id="928d0-125">The following code example shows the creation of a custom binding and the programmatic insertion of binding elements.</span></span>  
  
     [!code-csharp[s_imperative#1](../../../../samples/snippets/csharp/VS_Snippets_CFX/s_imperative/cs/service.cs#1)]
     [!code-vb[s_imperative#1](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/s_imperative/vb/service.vb#1)]  
  
## <a name="see-also"></a><span data-ttu-id="928d0-126">См. также</span><span class="sxs-lookup"><span data-stu-id="928d0-126">See also</span></span>

- <xref:System.ServiceModel.Description.IPolicyImportExtension>
- <xref:System.ServiceModel.Description.IPolicyExportExtension>
- [<span data-ttu-id="928d0-127">Практическое руководство. Импорт проверочных утверждений пользовательской политики</span><span class="sxs-lookup"><span data-stu-id="928d0-127">How to: Import Custom Policy Assertions</span></span>](how-to-import-custom-policy-assertions.md)
