---
description: 'Подробнее: определение области определения действия и видимость'
title: Определение области и видимости действия
ms.date: 03/30/2017
ms.assetid: ccdffa07-9503-4eea-a61b-17f1564368b7
ms.openlocfilehash: ab779fe36473a8888ee0fb0c1b94f1ea6324f991
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/06/2021
ms.locfileid: "99787972"
---
# <a name="activity-definition-scoping-and-visibility"></a><span data-ttu-id="e89da-103">Определение области и видимости действия</span><span class="sxs-lookup"><span data-stu-id="e89da-103">Activity Definition Scoping and Visibility</span></span>

<span data-ttu-id="e89da-104">Определение области и видимость определения действия, как и область и видимость объекта, ― это возможность других объектов или действий работать с элементами этого действия.</span><span class="sxs-lookup"><span data-stu-id="e89da-104">Activity definition scoping and visibility, just like scoping and visibility of an object, is the ability of other objects or activities to access members of the activity.</span></span> <span data-ttu-id="e89da-105">Определение действия выполняется следующими реализациями.</span><span class="sxs-lookup"><span data-stu-id="e89da-105">Activity definition is performed by the following implementations:</span></span>  
  
1. <span data-ttu-id="e89da-106">Определение элементов (объектов <xref:System.Activities.Argument>, <xref:System.Activities.Variable> и <xref:System.Activities.ActivityDelegate>, а также дочерних действий), доступ к которым действие предоставляет для других пользователей.</span><span class="sxs-lookup"><span data-stu-id="e89da-106">Determining the members (<xref:System.Activities.Argument>, <xref:System.Activities.Variable>, and <xref:System.Activities.ActivityDelegate> objects, and child activities) an activity exposes to its users.</span></span>  
  
2. <span data-ttu-id="e89da-107">Реализация логики выполнения действия</span><span class="sxs-lookup"><span data-stu-id="e89da-107">Implementing the execution logic of the activity</span></span>  
  
 <span data-ttu-id="e89da-108">Эта реализация может включать элементы, доступ к которым не предоставляется получателями действия, но которые скорее являются деталями реализации.</span><span class="sxs-lookup"><span data-stu-id="e89da-108">The implementation may involve members that are not exposed to consumers of the activity, but are rather details of the implementation.</span></span>  <span data-ttu-id="e89da-109">Так же как и в определении типа, модель действия позволяет автору квалифицировать видимость элемента действия в отношении создаваемого определения действия.</span><span class="sxs-lookup"><span data-stu-id="e89da-109">Similar to type definition, the activity model allows an author to qualify the visibility of an activity member regarding the definition of the activity being defined.</span></span>  <span data-ttu-id="e89da-110">Эта видимость управляет аспектами использования элемента, например областями определения данных.</span><span class="sxs-lookup"><span data-stu-id="e89da-110">This visibility governs aspects of member usage, such as data scoping.</span></span>  
  
## <a name="scope"></a><span data-ttu-id="e89da-111">Область</span><span class="sxs-lookup"><span data-stu-id="e89da-111">Scope</span></span>  

 <span data-ttu-id="e89da-112">Помимо определения области данных, с помощью видимости модели действия можно ограничить доступ к другим аспектам действия, например проверке, отладке, отслеживанию или трассировке.</span><span class="sxs-lookup"><span data-stu-id="e89da-112">In addition to data scoping, activity model visibility can restrict access to other aspects of the activity, such as validation, debugging, tracking, or tracing.</span></span> <span data-ttu-id="e89da-113">С помощью видимости и определения области свойства выполнения ограничивают характеристики выполнения конкретной областью определения.</span><span class="sxs-lookup"><span data-stu-id="e89da-113">Execution properties use visibility and scoping for constraining execution characteristics to a particular scope of definition.</span></span> <span data-ttu-id="e89da-114">Вторичные корни используют видимость и определение области для ограничения состояния, записываемого действием <xref:System.Activities.Statements.CompensableActivity> областью определения, в которой применяются подлежащие компенсации действия.</span><span class="sxs-lookup"><span data-stu-id="e89da-114">Secondary roots use visibility and scoping to constrain the state captured by a <xref:System.Activities.Statements.CompensableActivity> to the scope of definition in which the compensable activities are used.</span></span>  
  
## <a name="definition-and-usage"></a><span data-ttu-id="e89da-115">Определение и использование</span><span class="sxs-lookup"><span data-stu-id="e89da-115">Definition and usage</span></span>  

 <span data-ttu-id="e89da-116">Рабочий процесс создается путем создания новых действий путем наследования от базовых классов действий, а также с помощью действий из [встроенной библиотеки действий](net-framework-4-5-built-in-activity-library.md).</span><span class="sxs-lookup"><span data-stu-id="e89da-116">A workflow is written by authoring new activities by inheriting from base activity classes, and by using activities from the [Built-In Activity Library](net-framework-4-5-built-in-activity-library.md).</span></span> <span data-ttu-id="e89da-117">Чтобы использовать действие, автор действия должен настроить видимость каждого компонента его определения.</span><span class="sxs-lookup"><span data-stu-id="e89da-117">In order to use an activity, the activity author must configure the visibility of each component of its definition.</span></span>  
  
### <a name="activity-members"></a><span data-ttu-id="e89da-118">Элементы действия</span><span class="sxs-lookup"><span data-stu-id="e89da-118">Activity Members</span></span>  

 <span data-ttu-id="e89da-119">Модель действия определяет аргументы, переменные, делегаты и дочерние действия, доступ к которым действие предоставляет получателям.</span><span class="sxs-lookup"><span data-stu-id="e89da-119">The activity model defines the arguments, variables, delegates, and child activities that the activity makes available to consumers.</span></span> <span data-ttu-id="e89da-120">Каждый из этих элементов может быть объявлен как `public` или `private`.</span><span class="sxs-lookup"><span data-stu-id="e89da-120">Each of these members can be declared as `public` or `private`.</span></span> <span data-ttu-id="e89da-121">Элементы public настраиваются объектом-получателем действия, а элементы `private` используют реализацию, назначенную действию автором.</span><span class="sxs-lookup"><span data-stu-id="e89da-121">Public members are configured by the consumer of the activity, whereas `private` members use an implementation fixed by the author of the activity.</span></span> <span data-ttu-id="e89da-122">Существуют следующие правила видимости для определения области данных.</span><span class="sxs-lookup"><span data-stu-id="e89da-122">The visibility rules for data scoping are as follows:</span></span>  
  
1. <span data-ttu-id="e89da-123">Открытые элементы и открытые элементы открытых дочерних действий могут ссылаться на открытые переменные.</span><span class="sxs-lookup"><span data-stu-id="e89da-123">Public members and the public members of public child activities can reference public variables.</span></span>  
  
2. <span data-ttu-id="e89da-124">Закрытые элементы и открытые элементы открытых дочерних действий могут ссылаться на аргументы и закрытые переменные.</span><span class="sxs-lookup"><span data-stu-id="e89da-124">Private members and the public members of public child activities can reference arguments and private variables.</span></span>  
  
 <span data-ttu-id="e89da-125">Элемент, который может задаваться объектом-получателем действия, нельзя делать закрытым.</span><span class="sxs-lookup"><span data-stu-id="e89da-125">A member that can be set by the consumer of an activity should never be made private.</span></span>  
  
### <a name="authoring-models"></a><span data-ttu-id="e89da-126">Режимы разработки</span><span class="sxs-lookup"><span data-stu-id="e89da-126">Authoring Models</span></span>  

 <span data-ttu-id="e89da-127">Настраиваемые действия определяются с помощью действия <xref:System.Activities.NativeActivity>, <xref:System.Activities.Activity>, <xref:System.Activities.CodeActivity> или <xref:System.Activities.AsyncCodeActivity>.</span><span class="sxs-lookup"><span data-stu-id="e89da-127">Custom activities are defined by using <xref:System.Activities.NativeActivity>, <xref:System.Activities.Activity>, <xref:System.Activities.CodeActivity>, or <xref:System.Activities.AsyncCodeActivity>.</span></span> <span data-ttu-id="e89da-128">Действия, которые наследуют от этих классов, могут предоставлять доступ к элементам разных типов с различной видимостью.</span><span class="sxs-lookup"><span data-stu-id="e89da-128">Activities that derive from these classes can expose different member types with different visibilities.</span></span>  
  
#### <a name="nativeactivity"></a><span data-ttu-id="e89da-129">NativeActivity</span><span class="sxs-lookup"><span data-stu-id="e89da-129">NativeActivity</span></span>  

 <span data-ttu-id="e89da-130">Действия, которые наследуют от действия <xref:System.Activities.NativeActivity>, имеют режим, написанный с помощью императивного кода, их также можно определять с помощью существующих действий.</span><span class="sxs-lookup"><span data-stu-id="e89da-130">Activities that derive from <xref:System.Activities.NativeActivity> have behavior that is written in imperative code, and can optionally be defined by using existing activities.</span></span> <span data-ttu-id="e89da-131">При создании действий на основе действия <xref:System.Activities.NativeActivity> предоставляется доступ ко всем возможностям среды выполнения.</span><span class="sxs-lookup"><span data-stu-id="e89da-131">Deriving activities from <xref:System.Activities.NativeActivity> grants access to all of the features exposed by the runtime.</span></span> <span data-ttu-id="e89da-132">Любой элемент такого действия можно определить с помощью открытой или закрытой видимости. Исключениями являются аргументы, которые можно объявлять только как `public`.</span><span class="sxs-lookup"><span data-stu-id="e89da-132">Any member of such an activity can be defined by using either public or private visibility, except arguments, which can only be declared as `public`.</span></span>  
  
 <span data-ttu-id="e89da-133">Элементы классов, которые наследуют от действия <xref:System.Activities.NativeActivity>, объявляются в среде выполнения с помощью структуры <xref:System.Activities.NativeActivityMetadata>, которая передается методу <xref:System.Activities.NativeActivity.CacheMetadata%2A>.</span><span class="sxs-lookup"><span data-stu-id="e89da-133">Members of classes derived from <xref:System.Activities.NativeActivity> are declared to the runtime using the <xref:System.Activities.NativeActivityMetadata> struct passed to the <xref:System.Activities.NativeActivity.CacheMetadata%2A> method.</span></span>  
  
#### <a name="activity"></a><span data-ttu-id="e89da-134">Действие</span><span class="sxs-lookup"><span data-stu-id="e89da-134">Activity</span></span>  

 <span data-ttu-id="e89da-135">Действия, создаваемые с помощью действия <xref:System.Activities.Activity>, имеют режим, который сконструирован исключительно путем составления других действий.</span><span class="sxs-lookup"><span data-stu-id="e89da-135">Activities created by using <xref:System.Activities.Activity> have behavior that is designed strictly through composing other activities.</span></span> <span data-ttu-id="e89da-136">Класс <xref:System.Activities.Activity> имеет одно дочернее действие реализации, получаемое средой выполнения с помощью реализации <xref:System.Activities.Activity.Implementation%2A>.</span><span class="sxs-lookup"><span data-stu-id="e89da-136">The <xref:System.Activities.Activity> class has one implementation child activity, obtained by the runtime using <xref:System.Activities.Activity.Implementation%2A>.</span></span> <span data-ttu-id="e89da-137">Действие, наследующее от действия <xref:System.Activities.Activity>, может определять открытые аргументы, открытые переменные, импортируемые ActivityDelegates и импортируемые Activities.</span><span class="sxs-lookup"><span data-stu-id="e89da-137">An activity deriving from <xref:System.Activities.Activity> can define public arguments, public variables, imported ActivityDelegates, and imported Activities.</span></span>  
  
 <span data-ttu-id="e89da-138">Импортируемые ActivityDelegates и Activities объявляются как открытые дочки действия, при этом действие не может планировать их напрямую.</span><span class="sxs-lookup"><span data-stu-id="e89da-138">Imported ActivityDelegates and Activities are declared as public children of the activity, but cannot be directly scheduled by the activity.</span></span> <span data-ttu-id="e89da-139">Эти данные используются во время проверки во избежание выполнения проверок с использованием родителя в тех местах, где действие никогда не будет выполняться.</span><span class="sxs-lookup"><span data-stu-id="e89da-139">This information is used during validation to avoid running parent-facing validations at locations where the activity will never execute.</span></span> <span data-ttu-id="e89da-140">Кроме того, импортируемые дочерние действия, как и открытые дочерние действия, могут указываться по ссылке и планироваться реализацией действия.</span><span class="sxs-lookup"><span data-stu-id="e89da-140">Also, imported children, just like public children, can be referenced and scheduled by the activity’s implementation.</span></span> <span data-ttu-id="e89da-141">Это означает, что действие, которое импортирует действие Activity1, может содержать в своей реализации <xref:System.Activities.Statements.Sequence>, которая планирует Activity1.</span><span class="sxs-lookup"><span data-stu-id="e89da-141">This means that an activity which imports an activity called Activity1 can contain a <xref:System.Activities.Statements.Sequence> in its implementation which schedules Activity1.</span></span>  
  
#### <a name="codeactivity-asynccodeactivity"></a><span data-ttu-id="e89da-142">CodeActivity/ AsyncCodeActivity</span><span class="sxs-lookup"><span data-stu-id="e89da-142">CodeActivity/ AsyncCodeActivity</span></span>  

 <span data-ttu-id="e89da-143">Этот базовый класс используется для создания режима на императивном коде.</span><span class="sxs-lookup"><span data-stu-id="e89da-143">This base class is used for authoring behavior in imperative code.</span></span> <span data-ttu-id="e89da-144">Действия, наследуемые от этого класса, имеют доступ только к предоставляемым ими аргументам.</span><span class="sxs-lookup"><span data-stu-id="e89da-144">Activities that derive from this class only have access to the arguments they expose.</span></span> <span data-ttu-id="e89da-145">Это означает, что эти действия могут предоставлять только открытые аргументы.</span><span class="sxs-lookup"><span data-stu-id="e89da-145">This means that the only members that these activities can expose are public arguments.</span></span> <span data-ttu-id="e89da-146">Другие элементы или видимости к этим действиям не применяются.</span><span class="sxs-lookup"><span data-stu-id="e89da-146">No other members or visibilities apply to these activities.</span></span>  
  
#### <a name="summary-of-visibilities"></a><span data-ttu-id="e89da-147">Сводка видимостей</span><span class="sxs-lookup"><span data-stu-id="e89da-147">Summary of visibilities</span></span>  

 <span data-ttu-id="e89da-148">В следующей таблице кратко суммированы данные, приведенные в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="e89da-148">The following table summarizes the information earlier in this section.</span></span>  
  
|<span data-ttu-id="e89da-149">Тип члена</span><span class="sxs-lookup"><span data-stu-id="e89da-149">Member Type</span></span>|<span data-ttu-id="e89da-150">NativeActivity</span><span class="sxs-lookup"><span data-stu-id="e89da-150">NativeActivity</span></span>|<span data-ttu-id="e89da-151">Действие</span><span class="sxs-lookup"><span data-stu-id="e89da-151">Activity</span></span>|<span data-ttu-id="e89da-152">CodeActivity/ AsyncCodeActivity</span><span class="sxs-lookup"><span data-stu-id="e89da-152">CodeActivity/ AsyncCodeActivity</span></span>|  
|-----------------|--------------------|--------------|--------------------------------------|  
|<span data-ttu-id="e89da-153">Аргументы</span><span class="sxs-lookup"><span data-stu-id="e89da-153">Arguments</span></span>|<span data-ttu-id="e89da-154">Открытый/закрытый</span><span class="sxs-lookup"><span data-stu-id="e89da-154">Public/ Private</span></span>|<span data-ttu-id="e89da-155">Открытый</span><span class="sxs-lookup"><span data-stu-id="e89da-155">Public</span></span>|<span data-ttu-id="e89da-156">Неприменимо</span><span class="sxs-lookup"><span data-stu-id="e89da-156">not applicable</span></span>|  
|<span data-ttu-id="e89da-157">Переменные</span><span class="sxs-lookup"><span data-stu-id="e89da-157">Variables</span></span>|<span data-ttu-id="e89da-158">Открытый/закрытый</span><span class="sxs-lookup"><span data-stu-id="e89da-158">Public/ Private</span></span>|<span data-ttu-id="e89da-159">Открытый</span><span class="sxs-lookup"><span data-stu-id="e89da-159">Public</span></span>|<span data-ttu-id="e89da-160">Неприменимо</span><span class="sxs-lookup"><span data-stu-id="e89da-160">not applicable</span></span>|  
|<span data-ttu-id="e89da-161">Дочерние действия</span><span class="sxs-lookup"><span data-stu-id="e89da-161">Child Activities</span></span>|<span data-ttu-id="e89da-162">Открытый/закрытый</span><span class="sxs-lookup"><span data-stu-id="e89da-162">Public/ Private</span></span>|<span data-ttu-id="e89da-163">Открытый, один фиксированный закрытый дочерний элемент, определенный в реализации.</span><span class="sxs-lookup"><span data-stu-id="e89da-163">Public, one fixed private child defined in Implementation.</span></span>|<span data-ttu-id="e89da-164">Неприменимо</span><span class="sxs-lookup"><span data-stu-id="e89da-164">not applicable</span></span>|  
|<span data-ttu-id="e89da-165">ActivityDelegates</span><span class="sxs-lookup"><span data-stu-id="e89da-165">ActivityDelegates</span></span>|<span data-ttu-id="e89da-166">Открытый/закрытый</span><span class="sxs-lookup"><span data-stu-id="e89da-166">Public/ Private</span></span>|<span data-ttu-id="e89da-167">Открытый</span><span class="sxs-lookup"><span data-stu-id="e89da-167">Public</span></span>|<span data-ttu-id="e89da-168">Неприменимо</span><span class="sxs-lookup"><span data-stu-id="e89da-168">not applicable</span></span>|  
  
 <span data-ttu-id="e89da-169">В общем, элемент, который не может задаваться объектом-получателем действия, нельзя делать открытым.</span><span class="sxs-lookup"><span data-stu-id="e89da-169">In general, a member that cannot be set by the consumer of an activity should not be made public.</span></span>  
  
### <a name="execution-properties"></a><span data-ttu-id="e89da-170">Свойства выполнения</span><span class="sxs-lookup"><span data-stu-id="e89da-170">Execution Properties</span></span>  

 <span data-ttu-id="e89da-171">В некоторых сценариях полезно ограничить область конкретного свойства выполнения открытыми дочками действия.</span><span class="sxs-lookup"><span data-stu-id="e89da-171">In some scenarios, it is useful to scope a particular execution property to the public children of an activity.</span></span> <span data-ttu-id="e89da-172">Коллекция <xref:System.Activities.ExecutionProperties> предоставляет эту возможность с помощью метода <xref:System.Activities.ExecutionProperties.Add%2A>.</span><span class="sxs-lookup"><span data-stu-id="e89da-172">The <xref:System.Activities.ExecutionProperties> collection provides this capability with the <xref:System.Activities.ExecutionProperties.Add%2A> method.</span></span> <span data-ttu-id="e89da-173">У этого метода есть логический параметр, указывающий, ограничено ли данное свойство всеми дочерними элементами или только открытыми дочерними элементами.</span><span class="sxs-lookup"><span data-stu-id="e89da-173">This method has a Boolean parameter indicating whether a particular property is scoped to all children, or just those that are public.</span></span> <span data-ttu-id="e89da-174">Если этому параметру задано значение `true`, то свойство будет видимо только открытым элементам, а также открытым элементам открытых дочерних элементов этих элементов.</span><span class="sxs-lookup"><span data-stu-id="e89da-174">If this parameter is set to `true`, the property will only be visible to public members and the public members of their public children.</span></span>  
  
### <a name="secondary-roots"></a><span data-ttu-id="e89da-175">Вторичные корни</span><span class="sxs-lookup"><span data-stu-id="e89da-175">Secondary Roots</span></span>  

 <span data-ttu-id="e89da-176">Вторичный корень ― это внутренний механизм среды выполнения для сопоставления состояния для действий компенсации.</span><span class="sxs-lookup"><span data-stu-id="e89da-176">A secondary root is the runtime’s internal mechanism for managing state for compensation activities.</span></span> <span data-ttu-id="e89da-177">Когда действие <xref:System.Activities.Statements.CompensableActivity> завершило работу, его состояние не очищается немедленно.</span><span class="sxs-lookup"><span data-stu-id="e89da-177">When a <xref:System.Activities.Statements.CompensableActivity> has finished running, its state is not cleaned up immediately.</span></span> <span data-ttu-id="e89da-178">Вместо этого среда выполнения сохраняет состояние во вторичном корне до завершения компенсации.</span><span class="sxs-lookup"><span data-stu-id="e89da-178">Instead, the state is maintained by the runtime in a secondary root until the compensation episode has completed.</span></span> <span data-ttu-id="e89da-179">Среды местоположения, записываемые с помощью вторичного корня, соответствуют области определения, в которой используется компенсируемое действие.</span><span class="sxs-lookup"><span data-stu-id="e89da-179">The location environments captured with the secondary root correspond to the scope of definition in which the Compensable activity is used.</span></span>
