---
description: 'Дополнительные сведения: создание команд с помощью Коммандбуилдерс'
title: Создание команд с помощью построителей CommandBuilder
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 6e3fb8b5-373b-4f9e-ab03-a22693df8e91
ms.openlocfilehash: 495312f57d497421182384eff23b621130447940
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/06/2021
ms.locfileid: "99724106"
---
# <a name="generating-commands-with-commandbuilders"></a><span data-ttu-id="e9f9f-103">Создание команд с помощью построителей CommandBuilder</span><span class="sxs-lookup"><span data-stu-id="e9f9f-103">Generating Commands with CommandBuilders</span></span>

<span data-ttu-id="e9f9f-104">Если свойство `SelectCommand` задается динамически во время выполнения, например при помощи средства запроса, принимающего от пользователя текстовые команды, то во время разработки нельзя задавать соответствующие свойства `InsertCommand`, `UpdateCommand` или `DeleteCommand`.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-104">When the `SelectCommand` property is dynamically specified at run time, such as through a query tool that takes a textual command from the user, you may not be able to specify the appropriate `InsertCommand`, `UpdateCommand`, or `DeleteCommand` at design time.</span></span> <span data-ttu-id="e9f9f-105">Если <xref:System.Data.DataTable> сопоставляется с одной таблицей базы данных или создается из нее, то можно воспользоваться преимуществом объекта <xref:System.Data.Common.DbCommandBuilder> для автоматического создания сущностей `DeleteCommand`, `InsertCommand` и `UpdateCommand` объекта <xref:System.Data.Common.DbDataAdapter>.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-105">If your <xref:System.Data.DataTable> maps to or is generated from a single database table, you can take advantage of the <xref:System.Data.Common.DbCommandBuilder> object to automatically generate the `DeleteCommand`, `InsertCommand`, and `UpdateCommand` of the <xref:System.Data.Common.DbDataAdapter>.</span></span>  
  
 <span data-ttu-id="e9f9f-106">Минимальным требованием для работы автоматического создания команд является задание свойства `SelectCommand`.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-106">As a minimum requirement, you must set the `SelectCommand` property in order for automatic command generation to work.</span></span> <span data-ttu-id="e9f9f-107">Схема таблицы, получаемая свойством `SelectCommand`, определяет синтаксис автоматически созданных инструкций INSERT, UPDATE и DELETE.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-107">The table schema retrieved by the `SelectCommand` property determines the syntax of the automatically generated INSERT, UPDATE, and DELETE statements.</span></span>  
  
 <span data-ttu-id="e9f9f-108">Для возврата метаданных, необходимых для создания команд INSERT, UPDATE и DELETE SQL, объект <xref:System.Data.Common.DbCommandBuilder> должен выполнить команду `SelectCommand`.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-108">The <xref:System.Data.Common.DbCommandBuilder> must execute the `SelectCommand` in order to return the metadata necessary to construct the INSERT, UPDATE, and DELETE SQL commands.</span></span> <span data-ttu-id="e9f9f-109">В результате необходим дополнительный цикл приема-передачи с источником данных, что может снизить производительность.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-109">As a result, an extra trip to the data source is necessary, and this can hinder performance.</span></span> <span data-ttu-id="e9f9f-110">Для достижения оптимальной производительности вместо использования <xref:System.Data.Common.DbCommandBuilder> следует задать команды явным образом.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-110">To achieve optimal performance, specify your commands explicitly rather than using the <xref:System.Data.Common.DbCommandBuilder>.</span></span>  
  
 <span data-ttu-id="e9f9f-111">Свойство `SelectCommand` должно также возвратить по крайней мере один столбец первичного ключа или столбец с атрибутом UNIQUE.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-111">The `SelectCommand` must also return at least one primary key or unique column.</span></span> <span data-ttu-id="e9f9f-112">Если отсутствует и то и другое, то возникнет исключение `InvalidOperation` и команда сформирована не будет.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-112">If none are present, an `InvalidOperation` exception is generated, and the commands are not generated.</span></span>  
  
 <span data-ttu-id="e9f9f-113">При наличии связи с `DataAdapter` объект <xref:System.Data.Common.DbCommandBuilder> автоматически создает свойства `InsertCommand`, `UpdateCommand` и `DeleteCommand` объекта `DataAdapter`, если они являются пустыми ссылками.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-113">When associated with a `DataAdapter`, the <xref:System.Data.Common.DbCommandBuilder> automatically generates the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties of the `DataAdapter` if they are null references.</span></span> <span data-ttu-id="e9f9f-114">Если для свойства уже существует `Command`, используется существующая `Command`.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-114">If a `Command` already exists for a property, the existing `Command` is used.</span></span>  
  
 <span data-ttu-id="e9f9f-115">Представления базы данных, созданные соединением двух или более таблиц, не считаются одной таблицей базы данных.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-115">Database views that are created by joining two or more tables together are not considered a single database table.</span></span> <span data-ttu-id="e9f9f-116">В данном экземпляре нельзя использовать <xref:System.Data.Common.DbCommandBuilder> для автоматического создания команд. Необходимо указать команды явным образом.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-116">In this instance you cannot use the <xref:System.Data.Common.DbCommandBuilder> to automatically generate commands; you must specify your commands explicitly.</span></span> <span data-ttu-id="e9f9f-117">Сведения о явной настройке команд для разрешения обновлений `DataSet` обратно в источник данных см. в разделе [Обновление источников данных с помощью DataAdapter](updating-data-sources-with-dataadapters.md).</span><span class="sxs-lookup"><span data-stu-id="e9f9f-117">For information about explicitly setting commands to resolve updates to a `DataSet` back to the data source, see [Updating Data Sources with DataAdapters](updating-data-sources-with-dataadapters.md).</span></span>  
  
 <span data-ttu-id="e9f9f-118">Может потребоваться сопоставить выходные параметры с обновленной строкой `DataSet`.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-118">You might want to map output parameters back to the updated row of a `DataSet`.</span></span> <span data-ttu-id="e9f9f-119">Одной общей задачей будет извлечение значения автоматически созданного поля идентификатора или временной метки из источника данных.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-119">One common task would be retrieving the value of an automatically generated identity field or time stamp from the data source.</span></span> <span data-ttu-id="e9f9f-120"><xref:System.Data.Common.DbCommandBuilder> по умолчанию не будет сопоставлять выходные параметры со столбцами обновленной строки.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-120">The <xref:System.Data.Common.DbCommandBuilder> will not map output parameters to columns in an updated row by default.</span></span> <span data-ttu-id="e9f9f-121">В данном экземпляре необходимо указать команду явным образом.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-121">In this instance you must specify your command explicitly.</span></span> <span data-ttu-id="e9f9f-122">Пример сопоставления автоматически созданного поля идентификации со столбцом вставленной строки см. в разделе [Получение значений Identity или автонумерации](retrieving-identity-or-autonumber-values.md).</span><span class="sxs-lookup"><span data-stu-id="e9f9f-122">For an example of mapping an automatically generated identity field back to a column of an inserted row, see [Retrieving Identity or Autonumber Values](retrieving-identity-or-autonumber-values.md).</span></span>  
  
## <a name="rules-for-automatically-generated-commands"></a><span data-ttu-id="e9f9f-123">Правила для автоматически созданных команд</span><span class="sxs-lookup"><span data-stu-id="e9f9f-123">Rules for Automatically Generated Commands</span></span>  

 <span data-ttu-id="e9f9f-124">В следующей таблице показаны правила создания автоматически созданных команд.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-124">The following table shows the rules for how automatically generated commands are generated.</span></span>  
  
|<span data-ttu-id="e9f9f-125">Команда</span><span class="sxs-lookup"><span data-stu-id="e9f9f-125">Command</span></span>|<span data-ttu-id="e9f9f-126">Правило</span><span class="sxs-lookup"><span data-stu-id="e9f9f-126">Rule</span></span>|  
|-------------|----------|  
|`InsertCommand`|<span data-ttu-id="e9f9f-127">Выполняет операцию вставки строки в источнике данных для всех строк таблицы со свойством <xref:System.Data.DataRow.RowState%2A> равным <xref:System.Data.DataRowState.Added>.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-127">Inserts a row at the data source for all rows in the table with a <xref:System.Data.DataRow.RowState%2A> of <xref:System.Data.DataRowState.Added>.</span></span> <span data-ttu-id="e9f9f-128">Вставляет значения для всех обновляемых столбцов (за исключением идентификаторов, выражений или временных меток).</span><span class="sxs-lookup"><span data-stu-id="e9f9f-128">Inserts values for all columns that are updateable (but not columns such as identities, expressions, or timestamps).</span></span>|  
|`UpdateCommand`|<span data-ttu-id="e9f9f-129">Выполняет обновление строк в источнике данных для всех строк таблицы со свойством `RowState` равным <xref:System.Data.DataRowState.Modified>.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-129">Updates rows at the data source for all rows in the table with a `RowState` of <xref:System.Data.DataRowState.Modified>.</span></span> <span data-ttu-id="e9f9f-130">Обновляет значения всех столбцов, за исключением столбцов, которые не являются обновляемыми, например идентификаторов или выражений.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-130">Updates the values of all columns except for columns that are not updateable, such as identities or expressions.</span></span> <span data-ttu-id="e9f9f-131">Обновляет все строки, в которых значения столбцов в источнике данных совпадают со значениями столбцов первичных ключей строки и в которых оставшиеся в источнике данных столбцы совпадают с исходными значениями строки.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-131">Updates all rows where the column values at the data source match the primary key column values of the row, and where the remaining columns at the data source match the original values of the row.</span></span> <span data-ttu-id="e9f9f-132">Дополнительные сведения см. в подразделе «Модель оптимистичного параллелизма для обновлений и удалений» далее в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-132">For more information, see "Optimistic Concurrency Model for Updates and Deletes," later in this topic.</span></span>|  
|`DeleteCommand`|<span data-ttu-id="e9f9f-133">Выполняет операцию удаления строки в источнике данных для всех строк таблицы, у которых свойство `RowState` равно <xref:System.Data.DataRowState.Deleted>.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-133">Deletes rows at the data source for all rows in the table with a `RowState` of <xref:System.Data.DataRowState.Deleted>.</span></span> <span data-ttu-id="e9f9f-134">Удаляет все строки, в которых значения столбцов совпадают со значениями столбцов первичных ключей строки и в которых оставшиеся в источнике данных столбцы совпадают с исходными значениями строки.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-134">Deletes all rows where the column values match the primary key column values of the row, and where the remaining columns at the data source match the original values of the row.</span></span> <span data-ttu-id="e9f9f-135">Дополнительные сведения см. в подразделе «Модель оптимистичного параллелизма для обновлений и удалений» далее в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-135">For more information, see "Optimistic Concurrency Model for Updates and Deletes," later in this topic.</span></span>|  
  
## <a name="optimistic-concurrency-model-for-updates-and-deletes"></a><span data-ttu-id="e9f9f-136">Модель оптимистичного параллелизма для обновлений и удалений</span><span class="sxs-lookup"><span data-stu-id="e9f9f-136">Optimistic Concurrency Model for Updates and Deletes</span></span>  

 <span data-ttu-id="e9f9f-137">Логика автоматического создания команд для инструкций UPDATE и DELETE основана на *оптимистичном параллелизме*, т. е. записи не заблокированы для редактирования и могут быть изменены другими пользователями или процессами в любое время.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-137">The logic for generating commands automatically for UPDATE and DELETE statements is based on *optimistic concurrency*--that is, records are not locked for editing and can be modified by other users or processes at any time.</span></span> <span data-ttu-id="e9f9f-138">Вследствие того что запись можно изменить после ее возврата из инструкции SELECT, но до вызова инструкции UPDATE или DELETE, автоматически созданная инструкция UPDATE или DELETE содержит предложение WHERE, указывающее на то, что строка обновляется только в случае наличия в ней всех исходных значений и она не была удалена из источника данных.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-138">Because a record could have been modified after it was returned from the SELECT statement, but before the UPDATE or DELETE statement is issued, the automatically generated UPDATE or DELETE statement contains a WHERE clause, specifying that a row is only updated if it contains all original values and has not been deleted from the data source.</span></span> <span data-ttu-id="e9f9f-139">Это делается во избежание перезаписи новых данных.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-139">This is done to avoid overwriting new data.</span></span> <span data-ttu-id="e9f9f-140">Когда автоматически созданное обновление пытается обновить строку, которая была удалена или не содержит исходные значения, найденные в <xref:System.Data.DataSet>, команда не изменяет записи и вызывается исключение <xref:System.Data.DBConcurrencyException>.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-140">Where an automatically generated update attempts to update a row that has been deleted or that does not contain the original values found in the <xref:System.Data.DataSet>, the command does not affect any records, and a <xref:System.Data.DBConcurrencyException> is thrown.</span></span>  
  
 <span data-ttu-id="e9f9f-141">Если требуется выполнить инструкцию UPDATE или DELETE независимо от исходных значений, необходимо явно задать свойство `UpdateCommand` для `DataAdapter` и не полагаться на автоматическое создание команд.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-141">If you want the UPDATE or DELETE to complete regardless of original values, you must explicitly set the `UpdateCommand` for the `DataAdapter` and not rely on automatic command generation.</span></span>  
  
## <a name="limitations-of-automatic-command-generation-logic"></a><span data-ttu-id="e9f9f-142">Ограничения логики автоматического создания команд</span><span class="sxs-lookup"><span data-stu-id="e9f9f-142">Limitations of Automatic Command Generation Logic</span></span>  

 <span data-ttu-id="e9f9f-143">На автоматическое создание команд накладываются следующие ограничения.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-143">The following limitations apply to automatic command generation.</span></span>  
  
### <a name="unrelated-tables-only"></a><span data-ttu-id="e9f9f-144">Только несвязанные таблицы</span><span class="sxs-lookup"><span data-stu-id="e9f9f-144">Unrelated Tables Only</span></span>  

 <span data-ttu-id="e9f9f-145">Логика автоматического создания команд создает инструкции INSERT, UPDATE или DELETE для изолированных таблиц, не принимая во внимание связи с другими таблицами в источнике данных.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-145">The automatic command generation logic generates INSERT, UPDATE, or DELETE statements for stand-alone tables without taking into account any relationships to other tables at the data source.</span></span> <span data-ttu-id="e9f9f-146">В результате при вызове `Update` для отправки изменений столбца, участвующего в ограничении внешнего ключа базы данных, может произойти ошибка.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-146">As a result, you may encounter a failure when calling `Update` to submit changes for a column that participates in a foreign key constraint in the database.</span></span> <span data-ttu-id="e9f9f-147">Чтобы избежать этого исключения, не следует использовать <xref:System.Data.Common.DbCommandBuilder> для обновления столбцов, вовлеченных в ограничение внешнего ключа. Вместо этого нужно явно задать инструкции, используемые для выполнения операции.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-147">To avoid this exception, do not use the <xref:System.Data.Common.DbCommandBuilder> for updating columns involved in a foreign key constraint; instead, explicitly specify the statements used to perform the operation.</span></span>  
  
### <a name="table-and-column-names"></a><span data-ttu-id="e9f9f-148">Имена таблиц и столбцов</span><span class="sxs-lookup"><span data-stu-id="e9f9f-148">Table and Column Names</span></span>  

 <span data-ttu-id="e9f9f-149">Логика автоматического создания команд может дать сбой при наличии в именах столбцов или таблиц любых специальных символов, например пробелов, точек, двойных кавычек или других символов, отличных от буквенно-цифровых, даже отделенных квадратными скобками.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-149">Automatic command generation logic may fail if column names or table names contain any special characters, such as spaces, periods, quotation marks, or other nonalphanumeric characters, even if delimited by brackets.</span></span> <span data-ttu-id="e9f9f-150">В зависимости от поставщика, задавая параметры QuotePrefix и QuoteSuffix, можно дать возможность логике создания обрабатывать пробелы, но для специальных символов это не сработает.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-150">Depending on the provider, setting the QuotePrefix and QuoteSuffix parameters may allow the generation logic to process spaces, but it cannot escape special characters.</span></span> <span data-ttu-id="e9f9f-151">Поддерживаются полностью указанные имена таблиц в виде *catalog.schema.table*.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-151">Fully qualified table names in the form of *catalog.schema.table* are supported.</span></span>  
  
## <a name="using-the-commandbuilder-to-automatically-generate-an-sql-statement"></a><span data-ttu-id="e9f9f-152">Использование построителя команд для автоматического создания инструкции SQL</span><span class="sxs-lookup"><span data-stu-id="e9f9f-152">Using the CommandBuilder to Automatically Generate an SQL Statement</span></span>  

 <span data-ttu-id="e9f9f-153">Чтобы автоматически создать инструкции SQL для `DataAdapter`, сначала следует установить его свойство `SelectCommand`, затем создать объект `DataAdapter` и в качестве аргумента, для которого `CommandBuilder` автоматически создаст инструкции SQL, указать `DataAdapter`.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-153">To automatically generate SQL statements for a `DataAdapter`, first set the `SelectCommand` property of the `DataAdapter`, then create a `CommandBuilder` object, and specify as an argument the `DataAdapter` for which the `CommandBuilder` will automatically generate SQL statements.</span></span>  
  
```vb  
' Assumes that connection is a valid SqlConnection object
' inside of a Using block.  
Dim adapter As SqlDataAdapter = New SqlDataAdapter( _  
  "SELECT * FROM dbo.Customers", connection)  
Dim builder As SqlCommandBuilder = New SqlCommandBuilder(adapter)  
builder.QuotePrefix = "["  
builder.QuoteSuffix = "]"  
```  
  
```csharp  
// Assumes that connection is a valid SqlConnection object  
// inside of a using block.  
SqlDataAdapter adapter = new SqlDataAdapter(  
  "SELECT * FROM dbo.Customers", connection);  
SqlCommandBuilder builder = new SqlCommandBuilder(adapter);  
builder.QuotePrefix = "[";  
builder.QuoteSuffix = "]";  
```  
  
## <a name="modifying-the-selectcommand"></a><span data-ttu-id="e9f9f-154">Изменение SelectCommand</span><span class="sxs-lookup"><span data-stu-id="e9f9f-154">Modifying the SelectCommand</span></span>  

 <span data-ttu-id="e9f9f-155">При изменении свойства `CommandText`, принадлежащего свойству `SelectCommand`, после автоматического создания команд INSERT, UPDATE или DELETE может возникнуть исключение.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-155">If you modify the `CommandText` of the `SelectCommand` after the INSERT, UPDATE, or DELETE commands have been automatically generated, an exception may occur.</span></span> <span data-ttu-id="e9f9f-156">Если измененное свойство `SelectCommand.CommandText` содержит сведения о схеме, которые не согласованы с используемыми `SelectCommand.CommandText` сведениями при автоматическом создании команд INSERT, UPDATE или DELETE, то последующие вызовы к методу `DataAdapter.Update` могут содержать попытки обращения к столбцам, которых больше нет в текущей таблице, на которую ссылается `SelectCommand`, и в этом случае возникнет исключение.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-156">If the modified `SelectCommand.CommandText` contains schema information that is inconsistent with the `SelectCommand.CommandText` used when the insert, update, or delete commands were automatically generated, future calls to the `DataAdapter.Update` method may attempt to access columns that no longer exist in the current table referenced by the `SelectCommand`, and an exception will be thrown.</span></span>  
  
 <span data-ttu-id="e9f9f-157">Для обновления сведений о схеме, используемой `CommandBuilder` для автоматического создания команд, следует вызвать метод `RefreshSchema` объекта `CommandBuilder`.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-157">You can refresh the schema information used by the `CommandBuilder` to automatically generate commands by calling the `RefreshSchema` method of the `CommandBuilder`.</span></span>  
  
 <span data-ttu-id="e9f9f-158">Чтобы узнать, какая команда была автоматически создана, необходимо с помощью методов `GetInsertCommand`, `GetUpdateCommand` и `GetDeleteCommand` объекта `CommandBuilder` получить ссылку на автоматически созданные команды и проверить свойство `CommandText`, соответствующее команде.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-158">If you want to know what command was automatically generated, you can obtain a reference to the automatically generated commands by using the `GetInsertCommand`, `GetUpdateCommand`, and `GetDeleteCommand` methods of the `CommandBuilder` object and checking the `CommandText` property of the associated command.</span></span>  
  
 <span data-ttu-id="e9f9f-159">Следующий пример кода записывает в консоль автоматически созданную команду UPDATE.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-159">The following code example writes to the console the update command that was automatically generated.</span></span>  
  
```vb
Console.WriteLine(builder.GetUpdateCommand().CommandText)  
```

```csharp
Console.WriteLine(builder.GetUpdateCommand().CommandText);
```
  
 <span data-ttu-id="e9f9f-160">В следующем примере повторно создается таблица `Customers` из набора данных `custDS`.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-160">The following example recreates the `Customers` table in the `custDS` dataset.</span></span> <span data-ttu-id="e9f9f-161">Метод **RefreshSchema** вызывается для внесения новых сведений о столбцах в автоматически созданные команды.</span><span class="sxs-lookup"><span data-stu-id="e9f9f-161">The **RefreshSchema** method is called to refresh the automatically generated commands with this new column information.</span></span>  
  
```vb  
' Assumes an open SqlConnection and SqlDataAdapter inside of a Using block.  
adapter.SelectCommand.CommandText = _  
  "SELECT CustomerID, ContactName FROM dbo.Customers"  
builder.RefreshSchema()  
  
custDS.Tables.Remove(custDS.Tables("Customers"))  
adapter.Fill(custDS, "Customers")  
```  
  
```csharp  
// Assumes an open SqlConnection and SqlDataAdapter inside of a using block.  
adapter.SelectCommand.CommandText =
  "SELECT CustomerID, ContactName FROM dbo.Customers";  
builder.RefreshSchema();  
  
custDS.Tables.Remove(custDS.Tables["Customers"]);  
adapter.Fill(custDS, "Customers");  
```  
  
## <a name="see-also"></a><span data-ttu-id="e9f9f-162">См. также</span><span class="sxs-lookup"><span data-stu-id="e9f9f-162">See also</span></span>

- [<span data-ttu-id="e9f9f-163">Команды и параметры</span><span class="sxs-lookup"><span data-stu-id="e9f9f-163">Commands and Parameters</span></span>](commands-and-parameters.md)
- [<span data-ttu-id="e9f9f-164">Выполнение команды</span><span class="sxs-lookup"><span data-stu-id="e9f9f-164">Executing a Command</span></span>](executing-a-command.md)
- [<span data-ttu-id="e9f9f-165">DbConnection, DbCommand и DbException</span><span class="sxs-lookup"><span data-stu-id="e9f9f-165">DbConnection, DbCommand and DbException</span></span>](dbconnection-dbcommand-and-dbexception.md)
- [<span data-ttu-id="e9f9f-166">Общие сведения об ADO.NET</span><span class="sxs-lookup"><span data-stu-id="e9f9f-166">ADO.NET Overview</span></span>](ado-net-overview.md)
