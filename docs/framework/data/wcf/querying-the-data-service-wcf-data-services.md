---
description: Дополнительные сведения см. в статье запросы к службе данных (службы данных WCF).
title: Выполнение запросов к службе данных (службы данных WCF)
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- WCF Data Services, client library
- WCF Data Services, querying
- WCF Data Services, accessing data
ms.assetid: 823e9444-27aa-4f1f-be8e-0486d67f54c0
ms.openlocfilehash: 7eb76b9d90273235d97318a70a4c880f869f249b
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/06/2021
ms.locfileid: "99794940"
---
# <a name="querying-the-data-service-wcf-data-services"></a><span data-ttu-id="467f1-103">Выполнение запросов к службе данных (службы данных WCF)</span><span class="sxs-lookup"><span data-stu-id="467f1-103">Querying the Data Service (WCF Data Services)</span></span>

[!INCLUDE [wcf-deprecated](~/includes/wcf-deprecated.md)]

<span data-ttu-id="467f1-104">Клиентская библиотека службы данных WCF позволяет выполнять запросы к службе данных с помощью привычных платформа .NET Framework шаблонов программирования, включая использование LINQ.</span><span class="sxs-lookup"><span data-stu-id="467f1-104">The WCF Data Services client library enables you to execute queries against a data service by using familiar .NET Framework programming patterns, including using language integrated query (LINQ).</span></span> <span data-ttu-id="467f1-105">Клиентская библиотека преобразует запрос, определенный на клиенте как экземпляр класса <xref:System.Data.Services.Client.DataServiceQuery%601>, в сообщение запроса HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="467f1-105">The client library translates a query, which is defined on the client as an instance of the <xref:System.Data.Services.Client.DataServiceQuery%601> class, into an HTTP GET request message.</span></span> <span data-ttu-id="467f1-106">Библиотека получает ответное сообщение и преобразует его в экземпляры классов клиентской службы данных.</span><span class="sxs-lookup"><span data-stu-id="467f1-106">The library receives the response message and translates it into instances of client data service classes.</span></span> <span data-ttu-id="467f1-107">Эти классы отслеживаются с помощью <xref:System.Data.Services.Client.DataServiceContext>, которому принадлежит объект <xref:System.Data.Services.Client.DataServiceQuery%601>.</span><span class="sxs-lookup"><span data-stu-id="467f1-107">These classes are tracked by the <xref:System.Data.Services.Client.DataServiceContext> to which the <xref:System.Data.Services.Client.DataServiceQuery%601> belongs.</span></span>

## <a name="data-service-queries"></a><span data-ttu-id="467f1-108">Запросы к службе данных</span><span class="sxs-lookup"><span data-stu-id="467f1-108">Data Service Queries</span></span>

<span data-ttu-id="467f1-109">Универсальный класс <xref:System.Data.Services.Client.DataServiceQuery%601> представляет запрос, который возвращает коллекцию, включающую ноль или больше экземпляров типа сущности.</span><span class="sxs-lookup"><span data-stu-id="467f1-109">The <xref:System.Data.Services.Client.DataServiceQuery%601> generic class represents a query that returns a collection of zero or more entity type instances.</span></span> <span data-ttu-id="467f1-110">Запрос к службе данных всегда относится к контексту существующей службы данных.</span><span class="sxs-lookup"><span data-stu-id="467f1-110">A data service query always belongs to an existing data service context.</span></span> <span data-ttu-id="467f1-111">Этот контекст поддерживает URI службы и сведения о метаданных, необходимые для создания и выполнения запроса.</span><span class="sxs-lookup"><span data-stu-id="467f1-111">This context maintains the service URI and metadata information that is required to compose and execute the query.</span></span>

<span data-ttu-id="467f1-112">При использовании диалогового окна **Добавление ссылки на службу** для добавления службы данных в клиентское приложение на основе платформа .NET Framework создается класс контейнера сущностей, наследующий от <xref:System.Data.Services.Client.DataServiceContext> класса.</span><span class="sxs-lookup"><span data-stu-id="467f1-112">When you use the **Add Service Reference** dialog to add a data service to a .NET Framework-based client application, an entity container class is created that inherits from the <xref:System.Data.Services.Client.DataServiceContext> class.</span></span> <span data-ttu-id="467f1-113">Этот класс включает свойства, возвращаемые типизированными экземплярами <xref:System.Data.Services.Client.DataServiceQuery%601>.</span><span class="sxs-lookup"><span data-stu-id="467f1-113">This class includes properties that return typed <xref:System.Data.Services.Client.DataServiceQuery%601> instances.</span></span> <span data-ttu-id="467f1-114">Для каждого набора сущностей, предоставляемого службой данных, имеется одно свойство.</span><span class="sxs-lookup"><span data-stu-id="467f1-114">There is one property for each entity set that the data service exposes.</span></span> <span data-ttu-id="467f1-115">Эти свойства облегчают создание экземпляра типизированного объекта <xref:System.Data.Services.Client.DataServiceQuery%601>.</span><span class="sxs-lookup"><span data-stu-id="467f1-115">These properties make it easier to create an instance of a typed <xref:System.Data.Services.Client.DataServiceQuery%601>.</span></span>

<span data-ttu-id="467f1-116">Запрос выполняется в следующих сценариях.</span><span class="sxs-lookup"><span data-stu-id="467f1-116">A query is executed in the following scenarios:</span></span>

- <span data-ttu-id="467f1-117">Если результаты перечислены неявно, например:</span><span class="sxs-lookup"><span data-stu-id="467f1-117">When results are enumerated implicitly, such as:</span></span>

  - <span data-ttu-id="467f1-118">Если свойство <xref:System.Data.Services.Client.DataServiceContext>, которое представляет набор сущностей, перечисляется, например во время цикла `foreach` (C#) или `For Each` (Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="467f1-118">When a property on the <xref:System.Data.Services.Client.DataServiceContext> that represents and entity set is enumerated, such as during a `foreach` (C#) or `For Each` (Visual Basic) loop.</span></span>

  - <span data-ttu-id="467f1-119">Если запрос назначен коллекции `List`.</span><span class="sxs-lookup"><span data-stu-id="467f1-119">When the query is assigned to a `List` collection.</span></span>

- <span data-ttu-id="467f1-120">Если метод <xref:System.Data.Services.Client.DataServiceQuery%601.Execute%2A> или <xref:System.Data.Services.Client.DataServiceQuery%601.BeginExecute%2A> вызывается явно.</span><span class="sxs-lookup"><span data-stu-id="467f1-120">When the <xref:System.Data.Services.Client.DataServiceQuery%601.Execute%2A> or <xref:System.Data.Services.Client.DataServiceQuery%601.BeginExecute%2A> method is explicitly called.</span></span>

- <span data-ttu-id="467f1-121">При вызове оператора выполнения запроса LINQ, такого как <xref:System.Linq.Enumerable.First%2A> или <xref:System.Linq.Enumerable.Single%2A>.</span><span class="sxs-lookup"><span data-stu-id="467f1-121">When a LINQ query execution operator, such as <xref:System.Linq.Enumerable.First%2A> or <xref:System.Linq.Enumerable.Single%2A> is called.</span></span>

<span data-ttu-id="467f1-122">Следующий запрос, если он выполняется, возвращает все сущности `Customers` в службе данных Northwind:</span><span class="sxs-lookup"><span data-stu-id="467f1-122">The following query, when it is executed, returns all `Customers` entities in the Northwind data service:</span></span>

[!code-csharp[Astoria Northwind Client#GetAllCustomersSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/source.cs#getallcustomersspecific)]
[!code-vb[Astoria Northwind Client#GetAllCustomersSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/source.vb#getallcustomersspecific)]

<span data-ttu-id="467f1-123">Дополнительные сведения см. [в разделе инструкции. выполнение запросов службы данных](how-to-execute-data-service-queries-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="467f1-123">For more information, see [How to: Execute Data Service Queries](how-to-execute-data-service-queries-wcf-data-services.md).</span></span>

<span data-ttu-id="467f1-124">Клиент службы данных WCF поддерживает запросы для объектов с поздним связыванием, например при использовании *динамического* типа в C#.</span><span class="sxs-lookup"><span data-stu-id="467f1-124">The WCF Data Services client supports queries for late-bound objects, such as when you use the *dynamic* type in C#.</span></span> <span data-ttu-id="467f1-125">Однако по соображениям производительности всегда следует создавать строго типизированные запросы к службе данных.</span><span class="sxs-lookup"><span data-stu-id="467f1-125">However, for performance reasons you should always compose strongly typed queries against the data service.</span></span> <span data-ttu-id="467f1-126">Тип <xref:System.Tuple> и динамические объекты не поддерживаются клиентом.</span><span class="sxs-lookup"><span data-stu-id="467f1-126">The <xref:System.Tuple> type and dynamic objects are not supported by the client.</span></span>

## <a name="linq-queries"></a><span data-ttu-id="467f1-127">Запросы LINQ</span><span class="sxs-lookup"><span data-stu-id="467f1-127">LINQ Queries</span></span>

<span data-ttu-id="467f1-128">Поскольку <xref:System.Data.Services.Client.DataServiceQuery%601> класс реализует <xref:System.Linq.IQueryable%601> интерфейс, определенный LINQ, клиентская библиотека службы данных WCF может преобразовать запросы LINQ к данным набора сущностей в URI, представляющий выражение запроса, вычисляемое для ресурса службы данных.</span><span class="sxs-lookup"><span data-stu-id="467f1-128">Because the <xref:System.Data.Services.Client.DataServiceQuery%601> class implements the <xref:System.Linq.IQueryable%601> interface defined by LINQ, the WCF Data Services client library is able to transform LINQ queries against entity set data into a URI that represents a query expression evaluated against a data service resource.</span></span> <span data-ttu-id="467f1-129">В следующем примере показан запрос LINQ, эквивалентный предыдущему объекту <xref:System.Data.Services.Client.DataServiceQuery%601>, который возвращает объект `Orders` со стоимостью транспортировки более 30 долларов и упорядочивает результаты по стоимости транспортировки.</span><span class="sxs-lookup"><span data-stu-id="467f1-129">The following example is a LINQ query that is equivalent to the previous <xref:System.Data.Services.Client.DataServiceQuery%601> that returns `Orders` that have a freight cost of more than $30 and orders the results by the freight cost:</span></span>

[!code-csharp[Astoria Northwind Client#AddQueryOptionsLinqSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/source.cs#addqueryoptionslinqspecific)]
[!code-vb[Astoria Northwind Client#AddQueryOptionsLinqSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/source.vb#addqueryoptionslinqspecific)]

<span data-ttu-id="467f1-130">Этот запрос LINQ преобразуется в следующий универсальный код ресурса (URI) запроса, который выполняется для службы данных [краткого руководства](quickstart-wcf-data-services.md) на основе Northwind:</span><span class="sxs-lookup"><span data-stu-id="467f1-130">This LINQ query is translated into the following query URI that is executed against the Northwind-based [quickstart](quickstart-wcf-data-services.md) data service:</span></span>

```http
http://localhost:12345/Northwind.svc/Orders?Orderby=ShippedDate&?filter=Freight gt 30
```

> [!NOTE]
> <span data-ttu-id="467f1-131">Набор запросов, которые можно выразить в синтаксисе LINQ, шире, чем набор запросов, поддерживаемых в URI-синтаксисе на основе технологии REST, который используется в службах данных.</span><span class="sxs-lookup"><span data-stu-id="467f1-131">The set of queries expressible in the LINQ syntax is broader than those enabled in the representational state transfer (REST)-based URI syntax that is used by data services.</span></span> <span data-ttu-id="467f1-132">Исключение <xref:System.NotSupportedException> возникает, если запрос не может быть сопоставлен с URI в целевой службе данных.</span><span class="sxs-lookup"><span data-stu-id="467f1-132">A <xref:System.NotSupportedException> is raised when the query cannot be mapped to a URI in the target data service.</span></span>

<span data-ttu-id="467f1-133">Дополнительные сведения см. в статье [рекомендации по LINQ](linq-considerations-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="467f1-133">For more information, see [LINQ Considerations](linq-considerations-wcf-data-services.md).</span></span>

## <a name="adding-query-options"></a><span data-ttu-id="467f1-134">Добавление параметров запроса</span><span class="sxs-lookup"><span data-stu-id="467f1-134">Adding Query Options</span></span>

<span data-ttu-id="467f1-135">Запросы службы данных поддерживают все параметры запросов, предоставляемые службы данных WCF.</span><span class="sxs-lookup"><span data-stu-id="467f1-135">Data service queries support all the query options that WCF Data Services provides.</span></span> <span data-ttu-id="467f1-136">Метод <xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A> вызывается для присоединения параметров запроса к экземпляру <xref:System.Data.Services.Client.DataServiceQuery%601>.</span><span class="sxs-lookup"><span data-stu-id="467f1-136">You call the <xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A> method to append query options to a <xref:System.Data.Services.Client.DataServiceQuery%601> instance.</span></span> <span data-ttu-id="467f1-137"><xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A> возвращает новый экземпляр <xref:System.Data.Services.Client.DataServiceQuery%601>, эквивалентный исходному запросу, но с новым набором параметров запроса.</span><span class="sxs-lookup"><span data-stu-id="467f1-137"><xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A> returns a new <xref:System.Data.Services.Client.DataServiceQuery%601> instance that is equivalent to the original query but with the new query option set.</span></span> <span data-ttu-id="467f1-138">Следующий запрос, если он выполняется, возвращает объект `Orders`, отфильтрованный по значению `Freight` и упорядоченный по `OrderID` по убыванию.</span><span class="sxs-lookup"><span data-stu-id="467f1-138">The following query, when executed, returns `Orders` that are filtered by the `Freight` value and ordered by the `OrderID`, descending:</span></span>

[!code-csharp[Astoria Northwind Client#AddQueryOptionsSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/source.cs#addqueryoptionsspecific)]
[!code-vb[Astoria Northwind Client#AddQueryOptionsSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/source.vb#addqueryoptionsspecific)]

<span data-ttu-id="467f1-139">Параметр запроса `$orderby` можно использовать как для упорядочения, так и для фильтрации запроса, основанного на одном свойстве, как в следующем примере, в котором фильтруются и упорядочиваются возвращаемые объекты `Orders`, основанные на значении свойства `Freight`:</span><span class="sxs-lookup"><span data-stu-id="467f1-139">You can use the `$orderby` query option to both order and filter a query based on a single property, as in the following example that filters and orders the returned `Orders` objects based on the value of the `Freight` property:</span></span>

[!code-csharp[Astoria Northwind Client#OrderWithFilter](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/source.cs#orderwithfilter)]
[!code-vb[Astoria Northwind Client#OrderWithFilter](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/source.vb#orderwithfilter)]

<span data-ttu-id="467f1-140">Можно последовательно вызывать метод <xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A>, чтобы сконструировать сложные выражения запроса.</span><span class="sxs-lookup"><span data-stu-id="467f1-140">You can call the <xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A> method consecutively to construct complex query expressions.</span></span> <span data-ttu-id="467f1-141">Дополнительные сведения см. [в разделе инструкции. Добавление параметров запроса в запрос службы данных](how-to-add-query-options-to-a-data-service-query-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="467f1-141">For more information, see [How to: Add Query Options to a Data Service Query](how-to-add-query-options-to-a-data-service-query-wcf-data-services.md).</span></span>

<span data-ttu-id="467f1-142">Параметры запроса предоставляют другой способ выражения синтаксических компонентов запроса LINQ.</span><span class="sxs-lookup"><span data-stu-id="467f1-142">Query options give you another way to express the syntactic components of a LINQ query.</span></span> <span data-ttu-id="467f1-143">Дополнительные сведения см. в статье [рекомендации по LINQ](linq-considerations-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="467f1-143">For more information, see [LINQ Considerations](linq-considerations-wcf-data-services.md).</span></span>

> [!NOTE]
> <span data-ttu-id="467f1-144">Параметр запроса `$select` нельзя добавить в URI-запрос с помощью метода <xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A>.</span><span class="sxs-lookup"><span data-stu-id="467f1-144">The `$select` query option cannot be added to a query URI by using the <xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A> method.</span></span> <span data-ttu-id="467f1-145">Рекомендуется использовать метод <xref:System.Linq.Enumerable.Select%2A> на основе LINQ для создания параметра запроса `$select` в URI-запросе.</span><span class="sxs-lookup"><span data-stu-id="467f1-145">We recommend that you use the LINQ <xref:System.Linq.Enumerable.Select%2A> method to have the client generate the `$select` query option in the request URI.</span></span>

<a name="executingQueries"></a>

## <a name="client-versus-server-execution"></a><span data-ttu-id="467f1-146">Клиент и запуск сервера</span><span class="sxs-lookup"><span data-stu-id="467f1-146">Client versus Server Execution</span></span>

<span data-ttu-id="467f1-147">Клиент выполняет запрос в два этапа.</span><span class="sxs-lookup"><span data-stu-id="467f1-147">The client executes a query in two parts.</span></span> <span data-ttu-id="467f1-148">По возможности сначала вычисляются выражения в запросе на стороне клиента, а затем создается URI-запрос, который будет отправлен службе данных для проведения вычислений по отношению к данным в службе.</span><span class="sxs-lookup"><span data-stu-id="467f1-148">Whenever possible, expressions in a query are first evaluated on the client, and then a URI-based query is generated and sent to the data service for evaluation against data in the service.</span></span> <span data-ttu-id="467f1-149">Рассмотрим следующий запрос LINQ:</span><span class="sxs-lookup"><span data-stu-id="467f1-149">Consider the following LINQ query:</span></span>

[!code-csharp[Astoria Northwind Client#LinqQueryClientEvalSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/source.cs#linqqueryclientevalspecific)]
[!code-vb[Astoria Northwind Client#LinqQueryClientEvalSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/source.vb#linqqueryclientevalspecific)]

<span data-ttu-id="467f1-150">В этом примере выражение `(basePrice – (basePrice * discount))` вычисляется на стороне клиента.</span><span class="sxs-lookup"><span data-stu-id="467f1-150">In this example, the expression `(basePrice – (basePrice * discount))` is evaluated on the client.</span></span> <span data-ttu-id="467f1-151">По этой причине фактический URI-запрос `http://localhost:12345/northwind.svc/Products()?$filter=(UnitPrice gt 90.00M) and substringof('bike',ProductName)`, отправляемый службе данных, содержит уже вычисленное десятичное значение `90` в предложении фильтра.</span><span class="sxs-lookup"><span data-stu-id="467f1-151">Because of this, the actual query URI `http://localhost:12345/northwind.svc/Products()?$filter=(UnitPrice gt 90.00M) and substringof('bike',ProductName)` that is sent to the data service contains the already calculated decimal value of `90` in the filter clause.</span></span> <span data-ttu-id="467f1-152">Другие части выражения фильтрации, включая выражение подстроки, вычисляются службой данных.</span><span class="sxs-lookup"><span data-stu-id="467f1-152">The other parts of the filtering expression, including the substring expression, are evaluated by the data service.</span></span> <span data-ttu-id="467f1-153">Выражения, вычисляемые на клиенте, следуют семантике среды CLR, а выражения, отправляемые в службу данных, полагаются на реализацию службы данных протокола OData.</span><span class="sxs-lookup"><span data-stu-id="467f1-153">Expressions that are evaluated on the client follow common language runtime (CLR) semantics, while expressions sent to the data service rely on the data service implementation of the OData Protocol.</span></span> <span data-ttu-id="467f1-154">Также следует помнить о сценариях, в которых это отдельное вычисление может привести к непредвиденным результатам, например если клиент и служба выполняют временные вычисления в разных часовых поясах.</span><span class="sxs-lookup"><span data-stu-id="467f1-154">You should also be aware of scenarios where this separate evaluation may cause unexpected results, such as when both the client and service perform time-based evaluations in different time zones.</span></span>

## <a name="query-responses"></a><span data-ttu-id="467f1-155">Ответы на запросы</span><span class="sxs-lookup"><span data-stu-id="467f1-155">Query Responses</span></span>

<span data-ttu-id="467f1-156">При выполнении запроса <xref:System.Data.Services.Client.DataServiceQuery%601> он возвращает объект <xref:System.Collections.Generic.IEnumerable%601> запрошенного типа сущности.</span><span class="sxs-lookup"><span data-stu-id="467f1-156">When executed, the <xref:System.Data.Services.Client.DataServiceQuery%601> returns an <xref:System.Collections.Generic.IEnumerable%601> of the requested entity type.</span></span> <span data-ttu-id="467f1-157">Этот результат запроса может быть приведен к объекту <xref:System.Data.Services.Client.QueryOperationResponse%601>, как в следующем примере:</span><span class="sxs-lookup"><span data-stu-id="467f1-157">This query result can be cast to a <xref:System.Data.Services.Client.QueryOperationResponse%601> object, as in the following example:</span></span>

[!code-csharp[Astoria Northwind Client#GetResponseSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/source.cs#getresponsespecific)]
[!code-vb[Astoria Northwind Client#GetResponseSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/source.vb#getresponsespecific)]

<span data-ttu-id="467f1-158">Экземпляры типа сущности, которые представляют сущности в службе данных, создаются на клиенте процессом, называемым материализацией объектов.</span><span class="sxs-lookup"><span data-stu-id="467f1-158">The entity type instances that represent entities in the data service are created on the client by a process called object materialization.</span></span> <span data-ttu-id="467f1-159">Дополнительные сведения см. в разделе [материализация объектов](object-materialization-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="467f1-159">For more information, see [Object Materialization](object-materialization-wcf-data-services.md).</span></span> <span data-ttu-id="467f1-160">Объект <xref:System.Data.Services.Client.QueryOperationResponse%601> реализует объект <xref:System.Collections.Generic.IEnumerable%601> для предоставления доступа к результатам запроса.</span><span class="sxs-lookup"><span data-stu-id="467f1-160">The <xref:System.Data.Services.Client.QueryOperationResponse%601> object implements <xref:System.Collections.Generic.IEnumerable%601> to provide access to the results of the query.</span></span>

<span data-ttu-id="467f1-161">Объект <xref:System.Data.Services.Client.QueryOperationResponse%601> имеет также следующие члены, позволяющие производить доступ к дополнительным сведениям о результате запроса.</span><span class="sxs-lookup"><span data-stu-id="467f1-161">The <xref:System.Data.Services.Client.QueryOperationResponse%601> also has the following members that enable you to access additional information about a query result:</span></span>

- <span data-ttu-id="467f1-162"><xref:System.Data.Services.Client.OperationResponse.Error%2A> — возвращает ошибку, инициируемую операцией, если ошибка возникает.</span><span class="sxs-lookup"><span data-stu-id="467f1-162"><xref:System.Data.Services.Client.OperationResponse.Error%2A> - gets an error thrown by the operation, if any has occurred.</span></span>

- <span data-ttu-id="467f1-163"><xref:System.Data.Services.Client.OperationResponse.Headers%2A> — содержит коллекцию заголовков ответов HTTP, связанных с ответом на запрос.</span><span class="sxs-lookup"><span data-stu-id="467f1-163"><xref:System.Data.Services.Client.OperationResponse.Headers%2A> - contains the collection of HTTP response headers associated with the query response.</span></span>

- <span data-ttu-id="467f1-164"><xref:System.Data.Services.Client.QueryOperationResponse.Query%2A> — возвращает исходный объект <xref:System.Data.Services.Client.DataServiceQuery%601>, создавший ответ <xref:System.Data.Services.Client.QueryOperationResponse%601>.</span><span class="sxs-lookup"><span data-stu-id="467f1-164"><xref:System.Data.Services.Client.QueryOperationResponse.Query%2A> - gets the original <xref:System.Data.Services.Client.DataServiceQuery%601> that generated the <xref:System.Data.Services.Client.QueryOperationResponse%601>.</span></span>

- <span data-ttu-id="467f1-165"><xref:System.Data.Services.Client.OperationResponse.StatusCode%2A> — возвращает код ответа HTTP для ответа на запрос.</span><span class="sxs-lookup"><span data-stu-id="467f1-165"><xref:System.Data.Services.Client.OperationResponse.StatusCode%2A> - gets the HTTP response code for the query response.</span></span>

- <span data-ttu-id="467f1-166"><xref:System.Data.Services.Client.QueryOperationResponse%601.TotalCount%2A> — возвращает общее число сущностей в наборе сущностей, если метод <xref:System.Data.Services.Client.DataServiceQuery%601.IncludeTotalCount%2A> вызван на клиенте <xref:System.Data.Services.Client.DataServiceQuery%601>.</span><span class="sxs-lookup"><span data-stu-id="467f1-166"><xref:System.Data.Services.Client.QueryOperationResponse%601.TotalCount%2A> - gets the total number of entities in the entity set when the <xref:System.Data.Services.Client.DataServiceQuery%601.IncludeTotalCount%2A> method was called on the <xref:System.Data.Services.Client.DataServiceQuery%601>.</span></span>

- <span data-ttu-id="467f1-167"><xref:System.Data.Services.Client.QueryOperationResponse.GetContinuation%2A> — возвращает объект <xref:System.Data.Services.Client.DataServiceQueryContinuation>, который содержит URI следующей страницы результатов.</span><span class="sxs-lookup"><span data-stu-id="467f1-167"><xref:System.Data.Services.Client.QueryOperationResponse.GetContinuation%2A> - returns a <xref:System.Data.Services.Client.DataServiceQueryContinuation> object that contains the URI of the next page of results.</span></span>

<span data-ttu-id="467f1-168">По умолчанию службы данных WCF возвращает только те данные, которые явно выбраны с помощью URI запроса.</span><span class="sxs-lookup"><span data-stu-id="467f1-168">By default, WCF Data Services only returns data that is explicitly selected by the query URI.</span></span> <span data-ttu-id="467f1-169">Это дает возможность явно загрузить дополнительные данные из службы данных, если это необходимо.</span><span class="sxs-lookup"><span data-stu-id="467f1-169">This gives you the option to explicitly load additional data from the data service when it is needed.</span></span> <span data-ttu-id="467f1-170">Запрос отправляется в службу данных при каждой явной загрузке данных из службы данных.</span><span class="sxs-lookup"><span data-stu-id="467f1-170">A request is sent to the data service each time you explicitly load data from the data service.</span></span> <span data-ttu-id="467f1-171">Данные, которые можно явно загрузить, включают связанные сущности, разбитые на страницы данные ответа и потоки двоичных данных.</span><span class="sxs-lookup"><span data-stu-id="467f1-171">Data that can be explicitly loaded includes related entities, paged response data, and binary data streams.</span></span>

> [!NOTE]
> <span data-ttu-id="467f1-172">Поскольку служба данных может возвратить разбитый на страницы ответ, рекомендуется, чтобы приложение использовало шаблон программирования для обработки разбитого на страницы ответа службы данных.</span><span class="sxs-lookup"><span data-stu-id="467f1-172">Because a data service may return a paged response, we recommend that your application use the programming pattern to handle a paged data service response.</span></span> <span data-ttu-id="467f1-173">Дополнительные сведения см. в разделе [Загрузка отложенного содержимого](loading-deferred-content-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="467f1-173">For more information, see [Loading Deferred Content](loading-deferred-content-wcf-data-services.md).</span></span>

<span data-ttu-id="467f1-174">Объем возвращаемых запросом данных может быть также уменьшен указанием, что в ответе возвращаются только определенные свойства сущности.</span><span class="sxs-lookup"><span data-stu-id="467f1-174">The amount of data returned by a query can also be reduced by specifying that only certain properties of an entity are returned in the response.</span></span> <span data-ttu-id="467f1-175">Дополнительные сведения см. в разделе [проекции запросов](query-projections-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="467f1-175">For more information, see [Query Projections](query-projections-wcf-data-services.md).</span></span>

## <a name="getting-a-count-of-the-total-number-of-entities-in-the-set"></a><span data-ttu-id="467f1-176">Получение подсчета общего числа сущностей в наборе</span><span class="sxs-lookup"><span data-stu-id="467f1-176">Getting a Count of the Total Number of Entities in the Set</span></span>

<span data-ttu-id="467f1-177">В некоторых сценариях полезно знать общее число сущностей в наборе сущностей, а не только число, возвращаемое запросом.</span><span class="sxs-lookup"><span data-stu-id="467f1-177">In some scenarios, it is helpful to know the total number of entities in an entity set and not merely the number returned by the query.</span></span> <span data-ttu-id="467f1-178">Вызовите метод <xref:System.Data.Services.Client.DataServiceQuery%601.IncludeTotalCount%2A> по отношению к объекту <xref:System.Data.Services.Client.DataServiceQuery%601> для запроса, чтобы этот общий итог подсчета сущностей в наборе возвращался с результатом запроса.</span><span class="sxs-lookup"><span data-stu-id="467f1-178">Call the <xref:System.Data.Services.Client.DataServiceQuery%601.IncludeTotalCount%2A> method on the <xref:System.Data.Services.Client.DataServiceQuery%601> to request that this total count of entities in the set be included with the query result.</span></span> <span data-ttu-id="467f1-179">В этом случае свойство <xref:System.Data.Services.Client.QueryOperationResponse%601.TotalCount%2A> возвращаемого объекта <xref:System.Data.Services.Client.QueryOperationResponse%601> возвращает общее количество сущностей в наборе.</span><span class="sxs-lookup"><span data-stu-id="467f1-179">In this case, the <xref:System.Data.Services.Client.QueryOperationResponse%601.TotalCount%2A> property of the returned <xref:System.Data.Services.Client.QueryOperationResponse%601> returns the total number of entities in the set.</span></span>

<span data-ttu-id="467f1-180">Можно также получить только общее число сущностей в наборе либо как значение типа <xref:System.Int32>, либо как значение типа <xref:System.Int64>, вызвав метод <xref:System.Linq.Enumerable.Count%2A> или <xref:System.Linq.Enumerable.LongCount%2A> соответственно.</span><span class="sxs-lookup"><span data-stu-id="467f1-180">You can also get only the total count of entities in the set either as an <xref:System.Int32> or as a <xref:System.Int64> value by calling the <xref:System.Linq.Enumerable.Count%2A> or <xref:System.Linq.Enumerable.LongCount%2A> methods respectively.</span></span> <span data-ttu-id="467f1-181">Если вызываются эти методы, объект <xref:System.Data.Services.Client.QueryOperationResponse%601> не возвращается, при этом возвращается только значение подсчета.</span><span class="sxs-lookup"><span data-stu-id="467f1-181">When these methods are called, a <xref:System.Data.Services.Client.QueryOperationResponse%601> is not returned; only the count value is returned.</span></span> <span data-ttu-id="467f1-182">Дополнительные сведения см. в разделе [инструкции. Определение количества сущностей, возвращаемых запросом](number-of-entities-returned-by-a-query-wcf.md).</span><span class="sxs-lookup"><span data-stu-id="467f1-182">For more information, see [How to: Determine the Number of Entities Returned by a Query](number-of-entities-returned-by-a-query-wcf.md).</span></span>

## <a name="in-this-section"></a><span data-ttu-id="467f1-183">В этом разделе</span><span class="sxs-lookup"><span data-stu-id="467f1-183">In This Section</span></span>

- [<span data-ttu-id="467f1-184">Проекции запросов</span><span class="sxs-lookup"><span data-stu-id="467f1-184">Query Projections</span></span>](query-projections-wcf-data-services.md)

- [<span data-ttu-id="467f1-185">Материализация объектов</span><span class="sxs-lookup"><span data-stu-id="467f1-185">Object Materialization</span></span>](object-materialization-wcf-data-services.md)

- [<span data-ttu-id="467f1-186">Рекомендации по LINQ</span><span class="sxs-lookup"><span data-stu-id="467f1-186">LINQ Considerations</span></span>](linq-considerations-wcf-data-services.md)

- [<span data-ttu-id="467f1-187">Практическое руководство. Выполнение запросов к службе данных</span><span class="sxs-lookup"><span data-stu-id="467f1-187">How to: Execute Data Service Queries</span></span>](how-to-execute-data-service-queries-wcf-data-services.md)

- [<span data-ttu-id="467f1-188">Практическое руководство. Добавление параметров запроса к запросу службы данных</span><span class="sxs-lookup"><span data-stu-id="467f1-188">How to: Add Query Options to a Data Service Query</span></span>](how-to-add-query-options-to-a-data-service-query-wcf-data-services.md)

- [<span data-ttu-id="467f1-189">Практическое руководство. Определение количества сущностей, возвращаемых запросом</span><span class="sxs-lookup"><span data-stu-id="467f1-189">How to: Determine the Number of Entities Returned by a Query</span></span>](number-of-entities-returned-by-a-query-wcf.md)

- [<span data-ttu-id="467f1-190">Практическое руководство. Указание учетных данных клиента для запроса службы данных</span><span class="sxs-lookup"><span data-stu-id="467f1-190">How to: Specify Client Credentials for a Data Service Request</span></span>](specify-client-creds-for-a-data-service-request-wcf.md)

- [<span data-ttu-id="467f1-191">Практическое руководство. Установка заголовков в клиентском запросе</span><span class="sxs-lookup"><span data-stu-id="467f1-191">How to: Set Headers in the Client Request</span></span>](how-to-set-headers-in-the-client-request-wcf-data-services.md)

- [<span data-ttu-id="467f1-192">Практическое руководство. Проекция результатов запроса</span><span class="sxs-lookup"><span data-stu-id="467f1-192">How to: Project Query Results</span></span>](how-to-project-query-results-wcf-data-services.md)

## <a name="see-also"></a><span data-ttu-id="467f1-193">См. также</span><span class="sxs-lookup"><span data-stu-id="467f1-193">See also</span></span>

- [<span data-ttu-id="467f1-194">Библиотека клиентов служб данных WCF</span><span class="sxs-lookup"><span data-stu-id="467f1-194">WCF Data Services Client Library</span></span>](wcf-data-services-client-library.md)
